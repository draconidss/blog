<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Javaå¤šçº¿ç¨‹-1 | Draco&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="alternate" type="application/atom+xml" href="https://vuepress-theme-hope-demo.mrhope.site/atom.xml" title="Draco&#39;s Blog Atom Feed">
    <link rel="alternate" type="application/json" href="https://vuepress-theme-hope-demo.mrhope.site/feed.json" title="Draco&#39;s Blog JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://vuepress-theme-hope-demo.mrhope.site/rss.xml" title="Draco&#39;s Blog RSS Feed">
    <link rel="icon" href="/favicon.ico">
    <link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192">
    <link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192">
    <link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials">
    <link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png">
    <meta name="description" content="ç¾ä¸½æ–°ä¸–ç•Œ">
    <meta property="og:url" content="/java/java-MultiThread/Java-MultiThread-1.html">
    <meta property="og:site_name" content="Draco&#39;s Blog">
    <meta property="og:title" content="Javaå¤šçº¿ç¨‹-1">
    <meta property="og:description" content="è¿›ç¨‹ çº¿ç¨‹ å¤šçº¿ç¨‹å¤šè¿›ç¨‹ çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ« è¿›ç¨‹æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼›è€Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œæ²¡æœ‰ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä½†æœ‰ç‹¬ç«‹çš„æ ˆï¼Œå¯„å­˜å™¨ï¼Œå±€éƒ¨å˜é‡ç­‰ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥è¯»å†™æ ˆå†…å­˜ã€‚; åˆ›å»ºè¿›ç¨‹å¼€é”€å¤§ï¼ŒåŒ…æ‹¬åˆ›å»ºè™šæ‹Ÿåœ°å€ç©ºé—´ç­‰éœ€è¦å¤§é‡å†…å­˜èµ„æºï¼›è€Œåˆ›å»ºçº¿ç¨‹å¼€é”€å°ï¼ŒåŸºæœ¬ä¸Šåªéœ€è¦ä¸€ä¸ªå†…æ ¸å¯¹è±¡å’Œä¸€ä¸ªå †æ ˆã€‚; ä¸€">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta property="og:locale:alternate" content="zh-CN">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Draco&#39;s Blog">
    <meta property="article:author" content="Draco">
    <meta property="article:tag" content="å­¦ä¹ ç¬”è®°">
    <meta property="article:published_time" content="2021-05-11T21:18:29.000Z">
    <meta name="theme-color" content="#46bd87">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <link rel="preload" href="/assets/css/0.styles.82fe602c.css" as="style"><link rel="preload" href="/assets/js/app.b2189200.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Layout.3a19796f.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.17f5562a.js" as="script"><link rel="preload" href="/assets/js/page-Javaå¤šçº¿ç¨‹-1.cbdb3d2e.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.30f611ca.js" as="script"><link rel="prefetch" href="/assets/js/124.b8f6e2ce.js"><link rel="prefetch" href="/assets/js/125.9f9edf24.js"><link rel="prefetch" href="/assets/js/126.acdb9890.js"><link rel="prefetch" href="/assets/js/127.eec68cb2.js"><link rel="prefetch" href="/assets/js/128.730ce721.js"><link rel="prefetch" href="/assets/js/129.30313ed2.js"><link rel="prefetch" href="/assets/js/layout-Blog.8470e550.js"><link rel="prefetch" href="/assets/js/layout-Layout.985ed51b.js"><link rel="prefetch" href="/assets/js/layout-NotFound.625f2d8c.js"><link rel="prefetch" href="/assets/js/layout-Slide.62c63992.js"><link rel="prefetch" href="/assets/js/page-About.4371c15b.js"><link rel="prefetch" href="/assets/js/page-BlogHome.58307ebf.js"><link rel="prefetch" href="/assets/js/page-Componentdisabled.0c9f2035.js"><link rel="prefetch" href="/assets/js/page-DockerInstallsoftware.605ce06b.js"><link rel="prefetch" href="/assets/js/page-Dockerdeployment.dc5d1518.js"><link rel="prefetch" href="/assets/js/page-Dockerå­¦ä¹ ç¬”è®°.bc1b1e64.js"><link rel="prefetch" href="/assets/js/page-Dubboç¬”è®°.3a390f99.js"><link rel="prefetch" href="/assets/js/page-EasyExcelå¯¼å…¥å¯¼å‡ºExcel.edfcb1ad.js"><link rel="prefetch" href="/assets/js/page-ElasticSearchç¬”è®°.2c116ff9.js"><link rel="prefetch" href="/assets/js/page-ElasticSearché¢è¯•.6bdd030e.js"><link rel="prefetch" href="/assets/js/page-Encryptionarticle.dbfe6eb5.js"><link rel="prefetch" href="/assets/js/page-Gitç¬”è®°.e9eef5a6.js"><link rel="prefetch" href="/assets/js/page-Golang-ä»‹ç»å’Œä½¿ç”¨.2926b34a.js"><link rel="prefetch" href="/assets/js/page-Golang-è¯­æ³•åŸºç¡€.845f129c.js"><link rel="prefetch" href="/assets/js/page-GoogleCloudSpanner.a8c3559e.js"><link rel="prefetch" href="/assets/js/page-Guides.fb09748d.js"><link rel="prefetch" href="/assets/js/page-Hadoopä¼ªåˆ†å¸ƒå¼é…ç½®.fd53e6bc.js"><link rel="prefetch" href="/assets/js/page-HttpServletrequestä¸HttpServletResponse.c7fcd32c.js"><link rel="prefetch" href="/assets/js/page-IDEAåˆå§‹åŒ–SpringBooté¡¹ç›®+é€†å‘å·¥ç¨‹+é…ç½®.b23d7489.js"><link rel="prefetch" href="/assets/js/page-JVM-ç±»åŠ è½½å­ç³»ç»Ÿ.013f6dab.js"><link rel="prefetch" href="/assets/js/page-JVM-è¿è¡Œæ—¶æ•°æ®åŒº.8f24be74.js"><link rel="prefetch" href="/assets/js/page-JVM.0faf496d.js"><link rel="prefetch" href="/assets/js/page-JWTè®¤è¯åŸç†(æ›´æ–°ä¸­).afef6b3d.js"><link rel="prefetch" href="/assets/js/page-Java-IO.786f9a5c.js"><link rel="prefetch" href="/assets/js/page-Java-String.633df97a.js"><link rel="prefetch" href="/assets/js/page-Java-UMLç±»å›¾.07a8bd3d.js"><link rel="prefetch" href="/assets/js/page-Java-åŸºç¡€çŸ¥è¯†ç¬”è®°.435d8dd6.js"><link rel="prefetch" href="/assets/js/page-Java-åŸºç¡€é¢è¯•é¢˜.7eada66f.js"><link rel="prefetch" href="/assets/js/page-Java-å¤šçº¿ç¨‹å¹¶å‘.b689213c.js"><link rel="prefetch" href="/assets/js/page-Java-å¸¸ç”¨æ–¹æ³•æ±‡æ€».d5098085.js"><link rel="prefetch" href="/assets/js/page-Java-æ–°ç‰¹æ€§.2624cd43.js"><link rel="prefetch" href="/assets/js/page-Java-æ³¨è§£å’Œåå°„.624a0952.js"><link rel="prefetch" href="/assets/js/page-Java-è®¾è®¡æ¨¡å¼.de91006d.js"><link rel="prefetch" href="/assets/js/page-Java-é›†åˆå®¹å™¨.4000d595.js"><link rel="prefetch" href="/assets/js/page-JavaScripté¢è¯•é¢˜.2f460c75.js"><link rel="prefetch" href="/assets/js/page-JavaSwing-è¶…å¸‚ç³»ç»Ÿ.05cc54dc.js"><link rel="prefetch" href="/assets/js/page-Javawebå¤§å­¦æ´»åŠ¨ç®¡ç†ç³»ç»Ÿ.16d669cc.js"><link rel="prefetch" href="/assets/js/page-Javaå¤šçº¿ç¨‹-2.ac8543a4.js"><link rel="prefetch" href="/assets/js/page-Javaå¤šçº¿ç¨‹-JUCä½¿ç”¨.4d2ea292.js"><link rel="prefetch" href="/assets/js/page-Javaå¤šçº¿ç¨‹-å…³é”®å­—é”.025e877f.js"><link rel="prefetch" href="/assets/js/page-Javaå­¦ä¹ ç›®å½•.1b1cc8d8.js"><link rel="prefetch" href="/assets/js/page-Javaé¢è¯•æ•´ç†.9af3b7ec.js"><link rel="prefetch" href="/assets/js/page-Linuxå¸¸ç”¨å‘½ä»¤.a83e1798.js"><link rel="prefetch" href="/assets/js/page-LinuxæŠ€å·§.0a14d210.js"><link rel="prefetch" href="/assets/js/page-MarkdownEnhance.c2230fd8.js"><link rel="prefetch" href="/assets/js/page-Markdownå¢å¼º.aadc5012.js"><link rel="prefetch" href="/assets/js/page-Mavenç¬”è®°.988fe6cb.js"><link rel="prefetch" href="/assets/js/page-MyProject.bfc4b818.js"><link rel="prefetch" href="/assets/js/page-Mybatis-PlusåŸºç¡€ç¬”è®°.95927f9d.js"><link rel="prefetch" href="/assets/js/page-MybatisåŸºç¡€ç¬”è®°.fefbe7d1.js"><link rel="prefetch" href="/assets/js/page-Mybatisè¯­æ³•ç¬”è®°.39523c46.js"><link rel="prefetch" href="/assets/js/page-Mybatisé€†å‘å·¥ç¨‹Exampleç±»ä½¿ç”¨.0901040b.js"><link rel="prefetch" href="/assets/js/page-Mysqlç†è®ºå­¦ä¹ ç¬”è®°.8514f4bc.js"><link rel="prefetch" href="/assets/js/page-Nginx-åŠ¨é™åˆ†ç¦».38302c8e.js"><link rel="prefetch" href="/assets/js/page-Nginx-åå‘ä»£ç†.8e7c770e.js"><link rel="prefetch" href="/assets/js/page-Nginx-è´Ÿè½½å‡è¡¡.b6dd8efa.js"><link rel="prefetch" href="/assets/js/page-NginxåŸºç¡€ç¬”è®°å’Œå®‰è£…é…ç½®.fc6705ff.js"><link rel="prefetch" href="/assets/js/page-Nginxå­¦ä¹ ç›®å½•.671ad30b.js"><link rel="prefetch" href="/assets/js/page-Promiseå¼‚æ­¥è°ƒç”¨.b69b7b64.js"><link rel="prefetch" href="/assets/js/page-RabbitMQ.4bbcbb43.js"><link rel="prefetch" href="/assets/js/page-RabbitMQé¢è¯•é¢˜.efb0206f.js"><link rel="prefetch" href="/assets/js/page-Redisåº”ç”¨åœºæ™¯.0e77ea4d.js"><link rel="prefetch" href="/assets/js/page-Redisç†è®ºå­¦ä¹ ç¬”è®°.8b65265b.js"><link rel="prefetch" href="/assets/js/page-Rediséƒ¨ç½²ä¸åŸºæœ¬ä½¿ç”¨.92e2bd7c.js"><link rel="prefetch" href="/assets/js/page-Redisé›†ç¾¤å’Œå“¨å…µ.89bc86fe.js"><link rel="prefetch" href="/assets/js/page-SQLå­¦ä¹ ç¬”è®°.6e96c84a.js"><link rel="prefetch" href="/assets/js/page-SSH.394d5f12.js"><link rel="prefetch" href="/assets/js/page-Slidepage.6780f6af.js"><link rel="prefetch" href="/assets/js/page-Spring-RestTemplate.294032b4.js"><link rel="prefetch" href="/assets/js/page-SpringBootVueé¡¹ç›®æ­å»º(æŒç»­æ›´æ–°).04012e1a.js"><link rel="prefetch" href="/assets/js/page-SpringSecurity.fe6d2f41.js"><link rel="prefetch" href="/assets/js/page-SpringåŸºç¡€ç¬”è®°.ad2b726e.js"><link rel="prefetch" href="/assets/js/page-Springæ³¨è§£.fbe7b2cd.js"><link rel="prefetch" href="/assets/js/page-Springé”™è¯¯å‘è®°å½•.3c8e7eca.js"><link rel="prefetch" href="/assets/js/page-Springé”™è¯¯ç¬”è®°.ab452e07.js"><link rel="prefetch" href="/assets/js/page-Springé¢è¯•é¢˜.a6027529.js"><link rel="prefetch" href="/assets/js/page-Swaggerä½¿ç”¨.649bc53b.js"><link rel="prefetch" href="/assets/js/page-pageconfig.df01cfad.js"><link rel="prefetch" href="/assets/js/page-ä¸»è¦åŠŸèƒ½ä¸é…ç½®æ¼”ç¤º.cb598a88.js"><link rel="prefetch" href="/assets/js/page-ä¿®æ”¹Hostä»¥è®¿é—®Github.cc0d87cb.js"><link rel="prefetch" href="/assets/js/page-å‰ç«¯å­¦ä¹ ç›®å½•.f9ae2cac.js"><link rel="prefetch" href="/assets/js/page-å­—èŠ‚æµ‹å¼€é¢ç».aa250348.js"><link rel="prefetch" href="/assets/js/page-å­¦ä¹ è·¯çº¿.700dd883.js"><link rel="prefetch" href="/assets/js/page-å®éªŒå®¤å‡ºå…¥ç®¡ç†å°ç¨‹åº.e8b63960.js"><link rel="prefetch" href="/assets/js/page-å¯†ç åŠ å¯†çš„æ–‡ç« .c77eff1e.js"><link rel="prefetch" href="/assets/js/page-å¹»ç¯ç‰‡é¡µ.608b996d.js"><link rel="prefetch" href="/assets/js/page-æ“ä½œç³»ç»Ÿ.99988354.js"><link rel="prefetch" href="/assets/js/page-æ•°æ®åº“å­¦ä¹ ç›®å½•.7723429d.js"><link rel="prefetch" href="/assets/js/page-æ•°æ®ç»“æ„.95181c44.js"><link rel="prefetch" href="/assets/js/page-æ•°æ®ç»“æ„ç®—æ³•å­¦ä¹ ç›®å½•.d6a36698.js"><link rel="prefetch" href="/assets/js/page-æ•°æ®ç»“æ„ç®—æ³•é¢˜ç›®åˆé›†.6b596359.js"><link rel="prefetch" href="/assets/js/page-æœåŠ¡å™¨ä¸Šéƒ¨ç½²SpringBoot.456fb9bb.js"><link rel="prefetch" href="/assets/js/page-æ¦‚è¿°å‚è€ƒ.2e44ebc0.js"><link rel="prefetch" href="/assets/js/page-ç®—æ³•.57bd63e9.js"><link rel="prefetch" href="/assets/js/page-ç»„ä»¶ç¦ç”¨.e3432948.js"><link rel="prefetch" href="/assets/js/page-è…¾è®¯äº‘å­¦ä¹ ç¬”è®°.51fd3498.js"><link rel="prefetch" href="/assets/js/page-è‡ªå®šä¹‰å¸ƒå±€.6f7cfb97.js"><link rel="prefetch" href="/assets/js/page-è®¡ç®—æœºçŸ¥è¯†.636dcdc2.js"><link rel="prefetch" href="/assets/js/page-è®¡ç®—æœºç½‘ç»œ.72cdf05d.js"><link rel="prefetch" href="/assets/js/page-è®¤è¯†SpringCloud.b92a5a70.js"><link rel="prefetch" href="/assets/js/page-è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™.d2acc6e1.js"><link rel="prefetch" href="/assets/js/page-è®¾è®¡æ¨¡å¼ä¹‹J2EEè®¾è®¡æ¨¡å¼.d04004d5.js"><link rel="prefetch" href="/assets/js/page-è®¾è®¡æ¨¡å¼ä¹‹åˆ›å»ºå‹è®¾è®¡æ¨¡å¼.cdfc10d2.js"><link rel="prefetch" href="/assets/js/page-è®¾è®¡æ¨¡å¼ä¹‹ç»“æ„å‹è®¾è®¡æ¨¡å¼.300c0684.js"><link rel="prefetch" href="/assets/js/page-è®¾è®¡æ¨¡å¼ä¹‹è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼.cf888234.js"><link rel="prefetch" href="/assets/js/page-é¢è¯•å¤§çº².fed2a6b2.js"><link rel="prefetch" href="/assets/js/page-éŸ³é¢‘æ‰¹é‡è¯†åˆ«å¹³å°.2bbaf5a9.js"><link rel="prefetch" href="/assets/js/page-é¡µé¢é…ç½®.06e68e6d.js"><link rel="prefetch" href="/assets/js/page-é¡¹ç›®ä¸»é¡µ.cdf652ba.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.f3490175.js"><link rel="prefetch" href="/assets/js/vendors~mermaid.563b7dcd.js"><link rel="prefetch" href="/assets/js/vendors~photo-swipe.35294e26.js"><link rel="prefetch" href="/assets/js/vendors~reveal.fa6e99f3.js"><link rel="prefetch" href="/assets/js/vendors~waline.c009b8ee.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82fe602c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/" class="home-link router-link-active"><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/avatar.png" alt="Draco's Blog" class="logo"> <!----> <span class="site-name can-hide">Draco's Blog</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/category/" class="nav-link"><i class="iconfont icon-note"></i>
  Category
</a></div><div class="nav-item"><a href="/project/" class="nav-link"><i class="iconfont icon-note"></i>
  My Project
</a></div><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont icon-creative"></i>
  Guide
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont icon-info"></i>
  About
</a></div></nav> <div class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" style="width:1rem;height:1rem;vertical-align:middle;margin-left:1rem;"><path d="M639.981 344.075c14.805 44.45 34.542 79.023 69.084 113.596 29.603-29.634 49.34-69.146 64.145-113.596H639.981zM314.33 591.024h128.29l-64.145-172.865-64.145 172.865z" fill="currentColor"></path> <path d="M807.746 116.882H215.643c-54.274 0-98.681 44.45-98.681 98.78v592.677c0 54.329 44.407 98.78 98.68 98.78h592.104c54.273 0 98.681-44.451 98.681-98.78V215.66c0-54.329-39.475-98.78-98.68-98.78zM565.971 754.01c-9.866 9.878-19.738 9.878-29.603 9.878-4.94 0-14.805 0-19.738-4.939-4.939-4.939-9.872 0-9.872-4.939s-4.932-9.878-9.865-19.756c-4.94-9.878-4.94-14.817-9.872-24.695L467.29 655.23H294.592l-19.737 54.33c-9.866 19.755-14.805 34.572-19.738 44.45-4.939 9.878-14.804 9.878-29.603 9.878-9.871 0-19.737-4.939-29.609-9.878-9.865-9.878-14.798-14.817-14.798-24.695 0-4.939 0-9.878 4.933-19.756 4.939-9.878 4.939-14.817 9.865-24.695l108.553-276.583c4.939-9.878 4.939-19.756 9.872-29.633 4.932-9.878 9.865-19.756 14.798-24.695 4.939-4.94 9.872-14.817 19.737-19.756 9.872-4.94 19.738-4.94 29.61-4.94 9.865 0 19.73 0 29.603 4.94 9.865 4.939 14.804 9.878 19.737 19.756 4.933 4.939 9.866 14.817 14.798 24.695 4.94 9.877 9.872 19.755 14.805 34.572l108.553 271.644c9.865 19.756 14.804 34.573 14.804 44.451-4.939 4.94-9.872 14.817-14.804 24.695zm271.378-192.62c-54.273-19.756-93.748-44.451-128.29-74.085-34.536 34.573-78.943 59.268-133.223 74.085l-14.798-24.695c54.273-14.817 98.68-34.573 133.223-69.146-34.542-34.573-64.145-79.024-74.017-128.413h-49.34V319.38h133.228c-9.877-14.817-19.743-34.573-29.609-49.39l14.799-4.94c9.871 14.818 24.676 34.574 34.542 54.33h123.35v24.695h-49.34c-14.798 49.39-39.468 93.84-69.077 123.474 34.541 29.634 74.01 54.329 128.29 69.146l-19.738 24.695z" fill="currentColor"></path></svg> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/java/java-MultiThread/Java-MultiThread-1/" aria-current="page" class="nav-link router-link-exact-active router-link-active active"><!---->
  English
</a></li><li class="dropdown-item"><a href="/zh/" class="nav-link"><!---->
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div></div> <a rel="noopener noreferrer" href="https://github.com/LifeAlsoIsGG" target="_blank" class="repo-link can-hide">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info mobile"><div data-balloon-pos="down" role="navigation" class="blogger hasIntro"><img property="image" alt="Blogger Avatar" src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/avatar.png" class="avatar round"> <div property="name" class="name">Draco</div> <meta property="url" content="/about/"></div> <div class="num-wrapper"><div><div class="num">110</div> <div>Articles</div></div> <div><div class="num">34</div> <div>Category</div></div> <div><div class="num">58</div> <div>Tags</div></div> <div><div class="num">110</div> <div>Timeline</div></div></div> <div class="media-links-wrapper"><a href="https://github.com/LifeAlsoIsGG" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a><a href="https://twitter.com/LifeAlsoIsGG" rel="noopener noreferrer" target="_blank" aria-label="Twitter" data-balloon-pos="up" class="media-link"><span class="sr-only">Twitter</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-twitter"><circle cx="512" cy="512" r="512" fill="#5EAADE"></circle> <path d="M749.737 364.631c-17.594 7.805-36.513 13.088-56.371 15.459 20.269-12.148 35.836-31.387 43.156-54.312A196.233 196.233 0 0 1 674.2 349.6c-17.894-19.083-43.406-30.997-71.636-30.997-54.2 0-98.137 43.944-98.137 98.157 0 7.695.861 15.19 2.544 22.373-81.57-4.092-153.876-43.174-202.284-102.558-8.443 14.498-13.285 31.356-13.285 49.348 0 34.05 17.326 64.096 43.656 81.697a97.69 97.69 0 0 1-44.447-12.277c-.01.41-.01.82-.01 1.24 0 47.558 33.822 87.23 78.72 96.249a98.285 98.285 0 0 1-25.852 3.448 97.491 97.491 0 0 1-18.465-1.768c12.483 39.002 48.725 67.38 91.672 68.17-33.582 26.334-75.897 42.024-121.884 42.024-7.924 0-15.736-.46-23.408-1.37 43.434 27.844 95.014 44.104 150.443 44.104 180.505 0 279.221-149.576 279.221-279.294 0-4.263-.09-8.494-.278-12.708 19.178-13.835 35.813-31.115 48.967-50.807z" fill="#FFF"></path></svg></a><a href="http://localhost:8083/blog-vuepress/tencent:/AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1138312802.html" rel="noopener noreferrer" target="_blank" aria-label="QQ" data-balloon-pos="up" class="media-link"><span class="sr-only">QQ</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-qq"><circle cx="512" cy="512" r="512" fill="#5EAADE"></circle> <path d="M729.46 627.3c-3.157-39.628-24.045-83.747-32.624-105.91l-22.084-57.047c-.702-23.73 6.312-78.322-30.511-146.61s-110.82-74.446-124.497-75.147c-13.677-.701-99.248-1.403-141.331 72.945-42.084 74.347-30.745 148.812-30.745 148.812l-23.523 57.478c-.001.002-10.962 26.223-20.43 58.135-9.469 31.914-18.938 82.064-9.469 92.234 9.47 10.17 43.837-46.643 46.993-51.903 0 0 2.456 27.18 8.943 41.383l.81 1.776.33.723.38.826.3.652.444.96.203.436a281.465 281.465 0 0 0 1.917 4.025l.189.386c.231.473.468.953.711 1.442l.146.292c6.886 13.807 18.61 33.823 37.443 50.42l.018.016-1.184.387c-10.667 3.516-31.694 11.21-40.625 19.82-1.717 1.655-2.987 3.344-3.65 5.045-5.376 13.794 4.208 15.43 20.575 16.366 16.366.934 94.923 3.04 132.564-2.221.407-.056.787-.114 1.17-.171 2.711.094 5.324.142 7.83.16l.151.002c.836.005 1.663.008 2.475.008.496 0 1.015-.002 1.542-.006l.21-.001a222.593 222.593 0 0 0 5.462-.107c.26.038.508.076.778.114 37.642 5.26 116.198 3.156 132.564 2.22 16.366-.934 25.951-2.571 20.574-16.365-4.302-11.037-34.175-21.62-45.956-25.413a141.388 141.388 0 0 0 7.958-7.645l.237-.245a142.494 142.494 0 0 0 2.53-2.702c42.435-46.643 38.928-76.101 40.682-92.935 0 0 35.775 51.553 43.488 53.306 7.713 1.754 10.169-6.31 7.012-45.94z" fill="#FFF"></path></svg></a></div></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/category/" class="nav-link"><i class="iconfont icon-note"></i>
  Category
</a></div><div class="nav-item"><a href="/project/" class="nav-link"><i class="iconfont icon-note"></i>
  My Project
</a></div><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont icon-creative"></i>
  Guide
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont icon-info"></i>
  About
</a></div> <a rel="noopener noreferrer" href="https://github.com/LifeAlsoIsGG" target="_blank" class="repo-link">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><a href="/study-line/" class="sidebar-link"><i class="iconfont icon-info"></i>å­¦ä¹ è·¯çº¿</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">My Project</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Interview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable open"><i class="iconfont icon-code"></i> <span class="title">java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java/" aria-current="page" class="sidebar-link">Javaå­¦ä¹ ç›®å½•</a></li><li><a href="/java/Java-BasicNotes/" class="sidebar-link">Java-åŸºç¡€çŸ¥è¯†ç¬”è®°</a></li><li><a href="/java/Java-Interview/" class="sidebar-link">Java-åŸºç¡€é¢è¯•é¢˜</a></li><li><a href="/java/Java-Methods/" class="sidebar-link">Java-å¸¸ç”¨æ–¹æ³•æ±‡æ€»</a></li><li><a href="/java/Java-Collections/" class="sidebar-link">Java-é›†åˆå®¹å™¨</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable open"><!----> <span class="title">Java-Thread</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java/java-MultiThread/" aria-current="page" class="sidebar-link">æ¦‚è¿°/å‚è€ƒ</a></li><li><a href="/java/java-MultiThread/Java-MultiThread-1/" aria-current="page" class="active sidebar-link">Javaå¤šçº¿ç¨‹-1</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#è¿›ç¨‹-çº¿ç¨‹-å¤šçº¿ç¨‹å¤šè¿›ç¨‹" class="sidebar-link">è¿›ç¨‹ | çº¿ç¨‹ | å¤šçº¿ç¨‹å¤šè¿›ç¨‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«" class="sidebar-link heading3">çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹" class="sidebar-link heading3">å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„åˆ›å»º" class="sidebar-link">çº¿ç¨‹çš„åˆ›å»º</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç¬¬ä¸€ç§-ç»§æ‰¿threadç±»åˆ›å»ºçº¿ç¨‹" class="sidebar-link heading3">ç¬¬ä¸€ç§ï¼šç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç¬¬äºŒç§-å®ç°runnableæ¥å£" class="sidebar-link heading3">ç¬¬äºŒç§ï¼šå®ç°Runnableæ¥å£</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç¬¬ä¸‰ç§-å®ç°callableæ¥å£é€šè¿‡futuretaskåŒ…è£…å™¨æ¥åˆ›å»ºthreadçº¿ç¨‹" class="sidebar-link heading3">ç¬¬ä¸‰ç§ï¼šå®ç°Callableæ¥å£é€šè¿‡FutureTaskåŒ…è£…å™¨æ¥åˆ›å»ºThreadçº¿ç¨‹</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç¬¬å››ç§-é€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹" class="sidebar-link heading3">ç¬¬å››ç§ï¼šé€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#future-futuretask" class="sidebar-link heading3">Future | FutureTask</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç»§æ‰¿å’Œç»„åˆä¸¤ç§åˆ›å»ºæ–¹å¼çš„ä¸åŒ" class="sidebar-link heading3">ç»§æ‰¿å’Œç»„åˆä¸¤ç§åˆ›å»ºæ–¹å¼çš„ä¸åŒ</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„å¯åŠ¨" class="sidebar-link">çº¿ç¨‹çš„å¯åŠ¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸€äº›æ¦‚å¿µ" class="sidebar-link heading3">ä¸€äº›æ¦‚å¿µ</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#è°ƒç”¨startå’Œrunæ–¹æ³•åŒºåˆ«" class="sidebar-link heading3">è°ƒç”¨startå’Œrunæ–¹æ³•åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#thread-start" class="sidebar-link heading3">Thread.start()</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#thread-run" class="sidebar-link heading3">Thread.run()</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„å±æ€§" class="sidebar-link">çº¿ç¨‹çš„å±æ€§</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¼˜å…ˆçº§çš„è®¾å®š" class="sidebar-link heading3">ä¼˜å…ˆçº§çš„è®¾å®š</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹-éå®ˆæŠ¤çº¿ç¨‹" class="sidebar-link heading3">å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹ï¼ˆéå®ˆæŠ¤çº¿ç¨‹ï¼‰</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•" class="sidebar-link">çº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#stop-suspend" class="sidebar-link heading3">stop&amp;suspend</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#interrupt-interrupted" class="sidebar-link heading3">interrupt&amp;interrupted</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„å±‚æ¬¡å…³ç³»" class="sidebar-link">çº¿ç¨‹çš„å±‚æ¬¡å…³ç³»</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çˆ¶çº¿ç¨‹ä¸å­çº¿ç¨‹" class="sidebar-link heading3">çˆ¶çº¿ç¨‹ä¸å­çº¿ç¨‹</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çˆ¶å­çº¿ç¨‹çš„daemonå€¼" class="sidebar-link heading3">çˆ¶å­çº¿ç¨‹çš„Daemonå€¼</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çˆ¶å­çº¿ç¨‹çš„ä¼˜å…ˆçº§" class="sidebar-link heading3">çˆ¶å­çº¿ç¨‹çš„ä¼˜å…ˆçº§</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çˆ¶å­çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" class="sidebar-link heading3">çˆ¶å­çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#å·¥ä½œè€…çº¿ç¨‹" class="sidebar-link heading3">å·¥ä½œè€…çº¿ç¨‹</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€" class="sidebar-link">çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#new" class="sidebar-link heading3">NEW</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#runnable" class="sidebar-link heading3">RUNNABLE</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#blocked" class="sidebar-link heading3">BLOCKED</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#waiting" class="sidebar-link heading3">WAITING</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#timed-waiting" class="sidebar-link heading3">TIMED WAITING</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#terminated" class="sidebar-link heading3">TERMINATED</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„ç›‘è§†" class="sidebar-link">çº¿ç¨‹çš„ç›‘è§†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#è·å–æ–¹æ³•" class="sidebar-link heading3">è·å–æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#jmc" class="sidebar-link heading3">JMC</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¤šçº¿ç¨‹ç¼–ç¨‹" class="sidebar-link">å¤šçº¿ç¨‹ç¼–ç¨‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¥½å¤„åå¤„" class="sidebar-link heading3">å¥½å¤„åå¤„</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸²è¡Œ-å¹¶å‘-å¹¶è¡Œ" class="sidebar-link">ä¸²è¡Œ | å¹¶å‘ | å¹¶è¡Œ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸²è¡Œ-sequential" class="sidebar-link heading3">ä¸²è¡Œ(Sequential)</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¹¶å‘-concurrent" class="sidebar-link heading3">å¹¶å‘(Concurrent)</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¹¶è¡Œ-parallel" class="sidebar-link heading3">å¹¶è¡Œ(Parallel)</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç«æ€" class="sidebar-link">ç«æ€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸¾ä¾‹" class="sidebar-link heading3">ä¸¾ä¾‹</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#åŸå› " class="sidebar-link heading3">åŸå› </a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç«æ€çš„æ¨¡å¼-æ¡ä»¶" class="sidebar-link heading3">ç«æ€çš„æ¨¡å¼/æ¡ä»¶</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹å®‰å…¨æ€§" class="sidebar-link">çº¿ç¨‹å®‰å…¨æ€§</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸‰å¤§ç‰¹æ€§-åŸå­æ€§-automicity" class="sidebar-link heading3">ä¸‰å¤§ç‰¹æ€§ï¼šåŸå­æ€§ï¼ˆAutomicityï¼‰</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸‰å¤§ç‰¹æ€§-å¯è§æ€§-visibility" class="sidebar-link heading3">ä¸‰å¤§ç‰¹æ€§ï¼šå¯è§æ€§ï¼ˆVisibilityï¼‰</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸‰å¤§ç‰¹æ€§-æœ‰åºæ€§-ordering" class="sidebar-link heading3">ä¸‰å¤§ç‰¹æ€§ï¼šæœ‰åºæ€§ï¼ˆOrderingï¼‰</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸Šä¸‹æ–‡åˆ‡æ¢" class="sidebar-link heading3">ä¸Šä¸‹æ–‡åˆ‡æ¢</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„æ´»æ€§æ•…éšœ" class="sidebar-link heading3">çº¿ç¨‹çš„æ´»æ€§æ•…éšœ</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#èµ„æºäº‰ç”¨" class="sidebar-link heading3">èµ„æºäº‰ç”¨</a></li><li class="sidebar-sub-header"><a href="/java/java-MultiThread/Java-MultiThread-1/#èµ„æºè°ƒåº¦ç­–ç•¥" class="sidebar-link heading3">èµ„æºè°ƒåº¦ç­–ç•¥</a></li></ul></li></ul></li><li><a href="/java/java-MultiThread/Java-MultiThread-2/" class="sidebar-link">Javaå¤šçº¿ç¨‹-2</a></li><li><a href="/java/java-MultiThread/Java-MultiThread-keyword/" class="sidebar-link">Javaå¤šçº¿ç¨‹-å…³é”®å­—&amp;é”</a></li><li><a href="/java/java-MultiThread/Java-MultiThread/" class="sidebar-link">Java-å¤šçº¿ç¨‹å¹¶å‘</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable"><!----> <span class="title">Java-JVM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable"><!----> <span class="title">Java-DesignPattern</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/java/Java-String/" class="sidebar-link">Java-String</a></li><li><a href="/java/Java-annotation&amp;reflection/" class="sidebar-link">Java-æ³¨è§£å’Œåå°„</a></li><li><a href="/java/Java-IO/" class="sidebar-link">Java-IO</a></li><li><!----></li><li><a href="/java/Java-UML-ClassDiagram/" class="sidebar-link">Java-UMLç±»å›¾</a></li><li><a href="/java/Java-NewFeature/" class="sidebar-link">Java-æ–°ç‰¹æ€§</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Golang</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Database</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Mybatis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">DataStructure</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">ElasticSearch</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">MessageQueue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Computer Knowledge</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">ErrorNote</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Frontend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/about/" class="sidebar-link"><i class="iconfont icon-info"></i>About</a></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/java/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">Javaå­¦ä¹ ç›®å½•</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a href="/java/java-MultiThread/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">æ¦‚è¿°/å‚è€ƒ</span></a> <meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/java/java-MultiThread/Java-MultiThread-1/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">Javaå¤šçº¿ç¨‹-1</span></a> <meta property="position" content="3"></li></ol></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">Javaå¤šçº¿ç¨‹-1</span></h1> <div class="page-info"><!----> <span aria-label="AuthorğŸ–Š" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon author-icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z" fill="currentColor"></path></svg> <span property="author">Draco</span></span><span aria-label="Page viewsğŸ”¢" data-balloon-pos="down" class="visitor-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon eye-icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 0 0-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z" fill="currentColor"></path></svg> <span id="/java/java-MultiThread/Java-MultiThread-1/" data-flag-title="Javaå¤šçº¿ç¨‹-1" class="leancloud_visitors"><span class="leancloud-visitors-count">...</span></span></span><span aria-label="Writing DateğŸ“…" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-05-11 21:18:29</span></span><!----><span aria-label="TagsğŸ·" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon tag-icon"><path d="M939.902 458.563 910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 0 0 0 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z" fill="currentColor"></path></svg> <ul class="tags-wrapper"><li class="tag clickable tag0"><span role="navigation">å­¦ä¹ ç¬”è®°</span></li><li class="tag clickable tag1"><span role="navigation">Java</span></li><li class="tag clickable tag2"><span role="navigation">å¤šçº¿ç¨‹</span></li></ul> <meta property="keywords" content="å­¦ä¹ ç¬”è®°,Java,å¤šçº¿ç¨‹"></span><span aria-label="Reading TimeâŒ›" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 62 min</span> <meta property="timeRequired" content="PT62M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#è¿›ç¨‹-çº¿ç¨‹-å¤šçº¿ç¨‹å¤šè¿›ç¨‹" class="anchor-link heading2"><div>è¿›ç¨‹ | çº¿ç¨‹ | å¤šçº¿ç¨‹å¤šè¿›ç¨‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«" class="anchor-link heading3"><div>çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹" class="anchor-link heading3"><div>å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„åˆ›å»º" class="anchor-link heading2"><div>çº¿ç¨‹çš„åˆ›å»º</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç¬¬ä¸€ç§-ç»§æ‰¿threadç±»åˆ›å»ºçº¿ç¨‹" class="anchor-link heading3"><div>ç¬¬ä¸€ç§ï¼šç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç¬¬äºŒç§-å®ç°runnableæ¥å£" class="anchor-link heading3"><div>ç¬¬äºŒç§ï¼šå®ç°Runnableæ¥å£</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç¬¬ä¸‰ç§-å®ç°callableæ¥å£é€šè¿‡futuretaskåŒ…è£…å™¨æ¥åˆ›å»ºthreadçº¿ç¨‹" class="anchor-link heading3"><div>ç¬¬ä¸‰ç§ï¼šå®ç°Callableæ¥å£é€šè¿‡FutureTaskåŒ…è£…å™¨æ¥åˆ›å»ºThreadçº¿ç¨‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç¬¬å››ç§-é€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹" class="anchor-link heading3"><div>ç¬¬å››ç§ï¼šé€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#future-futuretask" class="anchor-link heading3"><div>Future | FutureTask</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç»§æ‰¿å’Œç»„åˆä¸¤ç§åˆ›å»ºæ–¹å¼çš„ä¸åŒ" class="anchor-link heading3"><div>ç»§æ‰¿å’Œç»„åˆä¸¤ç§åˆ›å»ºæ–¹å¼çš„ä¸åŒ</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„å¯åŠ¨" class="anchor-link heading2"><div>çº¿ç¨‹çš„å¯åŠ¨</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸€äº›æ¦‚å¿µ" class="anchor-link heading3"><div>ä¸€äº›æ¦‚å¿µ</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#è°ƒç”¨startå’Œrunæ–¹æ³•åŒºåˆ«" class="anchor-link heading3"><div>è°ƒç”¨startå’Œrunæ–¹æ³•åŒºåˆ«</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#thread-start" class="anchor-link heading3"><div>Thread.start()</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#thread-run" class="anchor-link heading3"><div>Thread.run()</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„å±æ€§" class="anchor-link heading2"><div>çº¿ç¨‹çš„å±æ€§</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¼˜å…ˆçº§çš„è®¾å®š" class="anchor-link heading3"><div>ä¼˜å…ˆçº§çš„è®¾å®š</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹-éå®ˆæŠ¤çº¿ç¨‹" class="anchor-link heading3"><div>å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹ï¼ˆéå®ˆæŠ¤çº¿ç¨‹ï¼‰</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•" class="anchor-link heading2"><div>çº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#stop-suspend" class="anchor-link heading3"><div>stop&amp;suspend</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#interrupt-interrupted" class="anchor-link heading3"><div>interrupt&amp;interrupted</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„å±‚æ¬¡å…³ç³»" class="anchor-link heading2"><div>çº¿ç¨‹çš„å±‚æ¬¡å…³ç³»</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çˆ¶çº¿ç¨‹ä¸å­çº¿ç¨‹" class="anchor-link heading3"><div>çˆ¶çº¿ç¨‹ä¸å­çº¿ç¨‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çˆ¶å­çº¿ç¨‹çš„daemonå€¼" class="anchor-link heading3"><div>çˆ¶å­çº¿ç¨‹çš„Daemonå€¼</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çˆ¶å­çº¿ç¨‹çš„ä¼˜å…ˆçº§" class="anchor-link heading3"><div>çˆ¶å­çº¿ç¨‹çš„ä¼˜å…ˆçº§</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çˆ¶å­çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" class="anchor-link heading3"><div>çˆ¶å­çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#å·¥ä½œè€…çº¿ç¨‹" class="anchor-link heading3"><div>å·¥ä½œè€…çº¿ç¨‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€" class="anchor-link heading2"><div>çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#new" class="anchor-link heading3"><div>NEW</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#runnable" class="anchor-link heading3"><div>RUNNABLE</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#blocked" class="anchor-link heading3"><div>BLOCKED</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#waiting" class="anchor-link heading3"><div>WAITING</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#timed-waiting" class="anchor-link heading3"><div>TIMED WAITING</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#terminated" class="anchor-link heading3"><div>TERMINATED</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„ç›‘è§†" class="anchor-link heading2"><div>çº¿ç¨‹çš„ç›‘è§†</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#è·å–æ–¹æ³•" class="anchor-link heading3"><div>è·å–æ–¹æ³•</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#jmc" class="anchor-link heading3"><div>JMC</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¤šçº¿ç¨‹ç¼–ç¨‹" class="anchor-link heading2"><div>å¤šçº¿ç¨‹ç¼–ç¨‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¥½å¤„åå¤„" class="anchor-link heading3"><div>å¥½å¤„åå¤„</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸²è¡Œ-å¹¶å‘-å¹¶è¡Œ" class="anchor-link heading2"><div>ä¸²è¡Œ | å¹¶å‘ | å¹¶è¡Œ</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸²è¡Œ-sequential" class="anchor-link heading3"><div>ä¸²è¡Œ(Sequential)</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¹¶å‘-concurrent" class="anchor-link heading3"><div>å¹¶å‘(Concurrent)</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#å¹¶è¡Œ-parallel" class="anchor-link heading3"><div>å¹¶è¡Œ(Parallel)</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç«æ€" class="anchor-link heading2"><div>ç«æ€</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸¾ä¾‹" class="anchor-link heading3"><div>ä¸¾ä¾‹</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#åŸå› " class="anchor-link heading3"><div>åŸå› </div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ç«æ€çš„æ¨¡å¼-æ¡ä»¶" class="anchor-link heading3"><div>ç«æ€çš„æ¨¡å¼/æ¡ä»¶</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹å®‰å…¨æ€§" class="anchor-link heading2"><div>çº¿ç¨‹å®‰å…¨æ€§</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸‰å¤§ç‰¹æ€§-åŸå­æ€§-automicity" class="anchor-link heading3"><div>ä¸‰å¤§ç‰¹æ€§ï¼šåŸå­æ€§ï¼ˆAutomicityï¼‰</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸‰å¤§ç‰¹æ€§-å¯è§æ€§-visibility" class="anchor-link heading3"><div>ä¸‰å¤§ç‰¹æ€§ï¼šå¯è§æ€§ï¼ˆVisibilityï¼‰</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸‰å¤§ç‰¹æ€§-æœ‰åºæ€§-ordering" class="anchor-link heading3"><div>ä¸‰å¤§ç‰¹æ€§ï¼šæœ‰åºæ€§ï¼ˆOrderingï¼‰</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#ä¸Šä¸‹æ–‡åˆ‡æ¢" class="anchor-link heading3"><div>ä¸Šä¸‹æ–‡åˆ‡æ¢</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#çº¿ç¨‹çš„æ´»æ€§æ•…éšœ" class="anchor-link heading3"><div>çº¿ç¨‹çš„æ´»æ€§æ•…éšœ</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#èµ„æºäº‰ç”¨" class="anchor-link heading3"><div>èµ„æºäº‰ç”¨</div></a></li><li class="anchor"><a href="/java/java-MultiThread/Java-MultiThread-1/#èµ„æºè°ƒåº¦ç­–ç•¥" class="anchor-link heading3"><div>èµ„æºè°ƒåº¦ç­–ç•¥</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h2 id="è¿›ç¨‹-çº¿ç¨‹-å¤šçº¿ç¨‹å¤šè¿›ç¨‹"><a href="#è¿›ç¨‹-çº¿ç¨‹-å¤šçº¿ç¨‹å¤šè¿›ç¨‹" class="header-anchor">#</a> è¿›ç¨‹ | çº¿ç¨‹ | å¤šçº¿ç¨‹å¤šè¿›ç¨‹</h2> <h3 id="çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«"><a href="#çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«" class="header-anchor">#</a> çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«</h3> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/Java-MultiThread-1/çº¿ç¨‹å’Œè¿›ç¨‹åŒºåˆ«.png" alt="çº¿ç¨‹ã€ç¨‹åºã€è¿›ç¨‹"></p> <ul><li>è¿›ç¨‹æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼›è€Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œæ²¡æœ‰ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä½†æœ‰ç‹¬ç«‹çš„æ ˆï¼Œå¯„å­˜å™¨ï¼Œå±€éƒ¨å˜é‡ç­‰ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥è¯»å†™æ ˆå†…å­˜ã€‚</li> <li>åˆ›å»ºè¿›ç¨‹å¼€é”€å¤§ï¼ŒåŒ…æ‹¬åˆ›å»ºè™šæ‹Ÿåœ°å€ç©ºé—´ç­‰éœ€è¦å¤§é‡å†…å­˜èµ„æºï¼›è€Œåˆ›å»ºçº¿ç¨‹å¼€é”€å°ï¼ŒåŸºæœ¬ä¸Šåªéœ€è¦ä¸€ä¸ªå†…æ ¸å¯¹è±¡å’Œä¸€ä¸ªå †æ ˆã€‚</li> <li>ä¸€ä¸ªè¿›ç¨‹æ— æ³•ç›´æ¥è®¿é—®å…¶ä»–è¿›ç¨‹çš„èµ„æºï¼›ä½†æ˜¯åŒä¸€è¿›ç¨‹å†…å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«è¿›ç¨‹çš„èµ„æºã€‚</li> <li>è¿›ç¨‹åˆ‡æ¢å¼€é”€å¤§ï¼Œçº¿ç¨‹åˆ‡æ¢å¼€é”€å°ã€‚</li> <li>è¿›ç¨‹é€šä¿¡å¼€é”€å¤§ï¼Œçº¿ç¨‹é€šä¿¡å¼€é”€å°ã€‚</li> <li>çº¿ç¨‹å±äºè¿›ç¨‹ï¼Œä¸èƒ½ç‹¬ç«‹æ‰§è¡Œã€‚æ¯ä¸ªè¿›ç¨‹åº”è¯¥è‡³å°‘è¦æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œç§°ä¸ºå…¶ä¸»çº¿ç¨‹ã€‚</li> <li>è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´æœ€ä¸»è¦çš„åŒºåˆ«å°±æ˜¯ï¼šåŒä¸€è¿›ç¨‹å†…çš„å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«éƒ¨åˆ†çŠ¶æ€ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥è¯»å†™åŒä¸€å—å†…å­˜ï¼ˆè€Œè¿›ç¨‹æ— æ³•ç›´æ¥è®¿é—®å…¶ä»–è¿›ç¨‹çš„å†…å­˜ï¼‰ï¼ŒåŒæ—¶æ¯ä¸ªçº¿ç¨‹è¿˜ç”¨è‡ªå·±çš„ç‹¬ç«‹çš„æ ˆå’Œå¯„å­˜å™¨ï¼Œå…¶ä»–çº¿ç¨‹è¿˜å¯ä»¥è¯»å†™è¿™äº›æ ˆå†…å­˜ã€‚</li></ul> <h3 id="å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹"><a href="#å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹" class="header-anchor">#</a> å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹</h3> <p>å¤šçº¿ç¨‹æ˜¯æŒ‡ä»è½¯ä»¶æˆ–ç¡¬ä»¶ä¸Šå®ç°å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æŠ€æœ¯ã€‚å¤šçº¿ç¨‹æ˜¯ä¸ºäº†åŒæ­¥å®Œæˆå¤šé¡¹ä»»åŠ¡ï¼Œä¸æ˜¯ä¸ºäº†æé«˜è¿è¡Œæ•ˆç‡ï¼Œè€Œæ˜¯ä¸ºäº†æé«˜èµ„æºä½¿ç”¨æ•ˆç‡æ¥æé«˜ç³»ç»Ÿçš„æ•ˆç‡ã€‚çº¿ç¨‹æ˜¯åœ¨åŒä¸€æ—¶é—´éœ€è¦å®Œæˆå¤šé¡¹ä»»åŠ¡çš„æ—¶å€™å®ç°çš„ã€‚</p> <p>å¤šè¿›ç¨‹æ˜¯æŒ‡ï¼šå¤šä¸ªä»»åŠ¡åŒæ—¶è¿è¡Œã€‚</p> <p>åŒºåˆ«</p> <ul><li><p>å¤šè¿›ç¨‹ä¹‹é—´ä¸å…±äº«æ•°æ®ï¼Œç¨‹åºä¸Šä¸‹æ–‡åŒºåˆ†å¼€ã€‚å¤šçº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®ï¼Œåœ¨æ•°æ®å¤„ç†ä¸Šè¦è°¨æ…ã€‚</p></li> <li><p>ä¸€ä¸ªè¿›ç¨‹æ­»æ‰ä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹ï¼›ä½†åŒä¸€ä¸ªè¿›ç¨‹é‡Œçš„ä¸€ä¸ªçº¿ç¨‹æ­»æ‰ï¼Œç­‰äºæ•´ä¸ªè¿›ç¨‹æ­»æ‰ï¼Œæ‰€ä»¥å¤šè¿›ç¨‹çš„å¥å£®æ€§é«˜äºå¤šçº¿ç¨‹çš„ã€‚</p></li> <li><p>çº¿ç¨‹çš„å°ºåº¦åˆ’åˆ†å°äºè¿›ç¨‹ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜ã€‚</p></li> <li><p>å¤šçº¿ç¨‹æ˜¯ä¸ºäº†åŒæ­¥å®Œæˆå¤šé¡¹ä»»åŠ¡ï¼Œä¸æ˜¯ä¸ºäº†æé«˜è¿è¡Œæ•ˆç‡ï¼Œè€Œæ˜¯ä¸ºäº†æé«˜èµ„æºä½¿ç”¨æ•ˆç‡æ¥æé«˜ç³»ç»Ÿçš„æ•ˆç‡ã€‚</p></li></ul> <h2 id="çº¿ç¨‹çš„åˆ›å»º"><a href="#çº¿ç¨‹çš„åˆ›å»º" class="header-anchor">#</a> çº¿ç¨‹çš„åˆ›å»º</h2> <p>Javaå¤šçº¿ç¨‹ï¼Œçš†å§‹äºThreadã€‚Threadæ˜¯å¤šçº¿ç¨‹çš„æ ¹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹çš„å¼€å¯éƒ½å§‹äºThreadçš„<code>start()</code>æ–¹æ³•</p> <p>å‚è€ƒ</p> <blockquote><ul><li>https://www.cnblogs.com/felixzh/p/6036074.html</li> <li>https://www.jianshu.com/p/7950ea349dbb</li></ul></blockquote> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/Java-MultiThread-1/çº¿ç¨‹ç±»å›¾.jpg" alt="çº¿ç¨‹ç±»å›¾"></p> <p>ä¸€å…±æœ‰å››ç§</p> <div class="custom-block info"><p class="custom-block-title">Info</p> <p><strong>æ— è¿”å›å€¼</strong>ï¼Œrun()è¿”å›ä¸ºvoid</p> <ul><li>ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹ï¼ˆThreadæœ¬èº«å°±å®ç°Runnableï¼‰</li> <li>å®ç°Runnableæ¥å£ï¼Œå¹¶å®ä¾‹ä½œä¸º<code>Thread(Runnable r)</code>æ„é€ å™¨çš„å‚æ•°</li></ul> <p><strong>æœ‰è¿”å›å€¼</strong>ï¼Œé€šè¿‡Callableæ¥å£ï¼Œå°±è¦å®ç°callæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼æ˜¯Object</p> <ul><li>å®ç°Callableæ¥å£é€šè¿‡FutureTaskåŒ…è£…å™¨æ¥åˆ›å»ºThreadçº¿ç¨‹</li> <li>çº¿ç¨‹æ± ï¼Œä½¿ç”¨<strong>ExecutorService</strong>ã€Callableã€Futureå®ç°æœ‰è¿”å›ç»“æœçš„å¤šçº¿ç¨‹</li></ul></div> <h3 id="ç¬¬ä¸€ç§-ç»§æ‰¿threadç±»åˆ›å»ºçº¿ç¨‹"><a href="#ç¬¬ä¸€ç§-ç»§æ‰¿threadç±»åˆ›å»ºçº¿ç¨‹" class="header-anchor">#</a> ç¬¬ä¸€ç§ï¼šç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹</h3> <p>Threadç±»æœ¬è´¨ä¸Šæ˜¯å®ç°äº†Runnableæ¥å£çš„ä¸€ä¸ªå®ä¾‹ï¼Œä»£è¡¨ä¸€ä¸ªçº¿ç¨‹çš„å®ä¾‹ã€‚å¯åŠ¨çº¿ç¨‹çš„å”¯ä¸€æ–¹æ³•å°±æ˜¯é€šè¿‡Threadç±»çš„start()å®ä¾‹æ–¹æ³•ã€‚start()æ–¹æ³•æ˜¯ä¸€ä¸ªnativeæ–¹æ³•ï¼Œå®ƒå°†å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œå¹¶æ‰§è¡Œrun()æ–¹æ³•ã€‚è¿™ç§æ–¹å¼å®ç°å¤šçº¿ç¨‹å¾ˆç®€å•ï¼Œé€šè¿‡è‡ªå·±çš„ç±»ç›´æ¥extend Threadï¼Œå¹¶å¤å†™run()æ–¹æ³•ï¼Œå°±å¯ä»¥å¯åŠ¨æ–°çº¿ç¨‹å¹¶æ‰§è¡Œè‡ªå·±å®šä¹‰çš„run()æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>  
   <span class="token annotation punctuation">@Override</span>
ã€€ã€€<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
ã€€ã€€ <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MyThread.run()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
ã€€ã€€<span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
 
<span class="token class-name">MyThread</span> myThread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token class-name">MyThread</span> myThread2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
myThread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
myThread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>è¿™ç§å®ç°æ–¹å¼æ˜¯æ˜¾ç¤ºçš„ç»§æ‰¿äº†Threadï¼Œä½†ä»ç±»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒThreadç±»æœ¬èº«å°±ç»§æ‰¿è‡ªRunnableï¼Œæ‰€ä»¥ç»§æ‰¿Threadçš„æœ¬è´¨ä¾ç„¶æ˜¯å®ç°Runnableæ¥å£å®šä¹‰çš„runæ–¹æ³•ã€‚</p> <p>éœ€è¦æ³¨æ„çš„æ˜¯ç»§æ‰¿Threadæ–¹å¼ï¼Œtargetå¯¹è±¡ä¸ºnullï¼Œé‡å†™äº†runæ–¹æ³•ï¼Œå¯¼è‡´æ–¹å¼1ä¸­çš„ThreadåŸç”Ÿçš„runæ–¹æ³•å¤±æ•ˆï¼Œå› æ­¤å¹¶ä¸ä¼šè°ƒç”¨åˆ°target.run()çš„é€»è¾‘ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨å­ç±»é‡å†™çš„runæ–¹æ³•ã€‚</p> <p><code>Thread</code>é‡Œé¢çš„<code>run()</code>æ–¹æ³•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>æ€»ä½“æ¥è¯´åˆ†ä¸¤ç§æƒ…å†µ</p> <ul><li><strong>ç›´æ¥ä½¿ç”¨Thread</strong>ï¼šåœ¨newæ—¶å¯ä»¥æŒ‡å®š<code>Runnable</code>æ¥å£ç±»å‹çš„æ„é€ å‚æ•°<code>target</code>ï¼Œå¦‚æœæœ‰åˆ™è°ƒç”¨<code>target</code>çš„runæ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰åˆ™è°ƒç”¨é»˜è®¤çš„ï¼ˆå³ä»€ä¹ˆéƒ½ä¸å¹²ï¼‰æˆ–è‡ªå·±é‡å†™çš„runæ–¹æ³•</li> <li><strong>é€šè¿‡ç»§æ‰¿Thread</strong>ï¼šæ²¡æœ‰å¯¹åº”æ„é€ å™¨ï¼Œæ‰€ä»¥<code>target</code>ä¸º<code>null</code>ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨é»˜è®¤çš„<code>run()</code>æ–¹æ³•æˆ–è°ƒç”¨é‡å†™çš„<code>run()</code>æ–¹æ³•</li></ul> <blockquote><p>å› ä¸ºjavaæ˜¯å•æ ¹ç»§æ‰¿ï¼Œæ­¤æ–¹å¼ä¸€èˆ¬ä¸å¸¸ç”¨ã€‚</p></blockquote> <h3 id="ç¬¬äºŒç§-å®ç°runnableæ¥å£"><a href="#ç¬¬äºŒç§-å®ç°runnableæ¥å£" class="header-anchor">#</a> ç¬¬äºŒç§ï¼šå®ç°Runnableæ¥å£</h3> <p>Runnableæ¥å£åªæœ‰ä¸€ä¸ªæ— è¿”å›å€¼çš„runæ–¹æ³•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å®ç°runæ–¹æ³•ï¼Œæ¥å£çš„å®ç°ç±»çš„å®ä¾‹ä½œä¸º<code>Thread</code>çš„<code>target</code>ä½œä¸ºå‚æ•°ä¼ å…¥å¸¦å‚çš„<code>Thread</code>æ„é€ å‡½æ•°ï¼Œé€šè¿‡è°ƒç”¨<code>start()</code>æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚é€‚ç”¨äºå·²ç»æœ‰ç»§æ‰¿çš„çˆ¶ç±»æ— æ³•ç»§æ‰¿Threadç±»çš„æ—¶å€™</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadDemo02</span> <span class="token punctuation">{</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span> 
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO Auto-generated method stub</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;--&gt;æˆ‘æ˜¯é€šè¿‡å®ç°æ¥å£çš„çº¿ç¨‹å®ç°æ–¹å¼ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>   
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>æ˜¯è¾ƒå¸¸ç”¨ä¸”æœ€æœ¬è´¨å®ç°ã€‚æ­¤æ„é€ æ–¹æ³•ç›¸å½“äºå¯¹<code>Runnable</code>å®ä¾‹è¿›è¡Œä¸€å±‚åŒ…è£…ï¼Œåœ¨<code>çº¿ç¨‹t</code>å¯åŠ¨æ—¶ï¼Œè°ƒç”¨<code>Thread</code>çš„<code>run</code>æ–¹æ³•ä»è€Œé—´æ¥è°ƒç”¨<code>target.run()</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Thread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token comment">/* What will be run. */</span>
    <span class="token keyword">private</span> <span class="token class-name">Runnable</span> target<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            target<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="ç¬¬ä¸‰ç§-å®ç°callableæ¥å£é€šè¿‡futuretaskåŒ…è£…å™¨æ¥åˆ›å»ºthreadçº¿ç¨‹"><a href="#ç¬¬ä¸‰ç§-å®ç°callableæ¥å£é€šè¿‡futuretaskåŒ…è£…å™¨æ¥åˆ›å»ºthreadçº¿ç¨‹" class="header-anchor">#</a> ç¬¬ä¸‰ç§ï¼šå®ç°Callableæ¥å£é€šè¿‡FutureTaskåŒ…è£…å™¨æ¥åˆ›å»ºThreadçº¿ç¨‹</h3> <div class="custom-block tip"><p class="custom-block-title">å‚è€ƒ</p> <ul><li>https://blog.csdn.net/yucaixiang/article/details/89241435</li> <li>https://blog.csdn.net/ghsau/article/details/7451464</li> <li>https://blog.csdn.net/javazejian/article/details/50896505</li></ul></div> <p>Callableæ¥å£ç›¸å¯¹äºRunnableæ¥å£æ— è¿”å›å€¼çš„runæ–¹æ³•ï¼Œæ˜¯æœ‰è¿”å›å€¼çš„runæ–¹æ³•ï¼Œé€šè¿‡æ³›å‹æŒ‡å®šè¿”å›çš„ç±»å‹</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * Computes a result, or throws an exception if unable to do so.
     *
     * @return computed result
     * @throws Exception if unable to compute a result
     */</span>
    <span class="token class-name">V</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>FutureTaskå¯ç”¨äº<code>å¼‚æ­¥è·å–æ‰§è¡Œç»“æœ</code>æˆ–<code>å–æ¶ˆæ‰§è¡Œä»»åŠ¡</code>çš„åœºæ™¯</p> <ul><li>åˆ›å»º<code>Callable</code>æ¥å£çš„å®ç°ç±» ï¼Œå¹¶å®ç°<code>Call</code>æ–¹æ³•</li> <li>åˆ›å»º<code>Callable</code>å®ç°ç±»çš„å®ç°ï¼Œä½¿ç”¨<code>FutureTask</code>ç±»åŒ…è£…<code>Callable</code>å¯¹è±¡ï¼Œè¯¥<code>FutureTask</code>å¯¹è±¡å°è£…äº†Callableå¯¹è±¡çš„Callæ–¹æ³•çš„è¿”å›å€¼</li> <li>ä½¿ç”¨FutureTaskå¯¹è±¡ä½œä¸ºThreadå¯¹è±¡çš„targetåˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹</li> <li>è°ƒç”¨FutureTaskå¯¹è±¡çš„get()æ¥è·å–å­çº¿ç¨‹æ‰§è¡Œç»“æŸçš„è¿”å›å€¼ï¼ˆgetæ–¹æ³•æ˜¯é˜»å¡çš„ï¼Œå¯ä»¥è®¾å®šé˜»å¡æ—¶é—´ï¼Œæ²¡è·å–åˆ°åˆ™è¿”å›nullï¼‰</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoCallable</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO Auto-generated method stub</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">DemoCallable</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoCallable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>future<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åŒæ­¥è·å–è¿”å›ç»“æœ</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>å¦å¤–ï¼ŒFutrueTaskçš„æ„é€ å™¨é™¤äº†æ¥æ”¶Callableå¤–ï¼Œè¿˜æœ‰æ¥æ”¶<code>Runnable</code>å’Œ<code>è¿”å›ç±»å‹result</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">FutureTask</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> runnable<span class="token punctuation">,</span> <span class="token class-name">V</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>callable <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">callable</span><span class="token punctuation">(</span>runnable<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> NEW<span class="token punctuation">;</span>       <span class="token comment">// ensure visibility of callable</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Futureæ¥å£æ–¹æ³•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">boolean</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> mayInterruptIfRunning<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> <span class="token function">isCancelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> <span class="token function">isDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">;</span>
    <span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">,</span> <span class="token class-name">TimeoutException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><strong>V get()</strong> ï¼šè·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœï¼Œå¦‚æœæ²¡æœ‰ç»“æœå¯ç”¨ï¼Œæ­¤æ–¹æ³•ä¼šé˜»å¡ç›´åˆ°å¼‚æ­¥è®¡ç®—å®Œæˆã€‚</li> <li><strong>V get(Long timeout , TimeUnit unit)</strong> ï¼šè·å–å¼‚æ­¥æ‰§è¡Œç»“æœï¼Œå¦‚æœæ²¡æœ‰ç»“æœå¯ç”¨ï¼Œæ­¤æ–¹æ³•ä¼šé˜»å¡ï¼Œä½†æ˜¯ä¼šæœ‰æ—¶é—´é™åˆ¶ï¼Œå¦‚æœé˜»å¡æ—¶é—´è¶…è¿‡è®¾å®šçš„timeoutæ—¶é—´ï¼Œè¯¥æ–¹æ³•å°†æŠ›å‡ºå¼‚å¸¸ã€‚</li> <li><strong>boolean isDone()</strong> ï¼šå¦‚æœä»»åŠ¡æ‰§è¡Œç»“æŸï¼Œæ— è®ºæ˜¯æ­£å¸¸ç»“æŸæˆ–æ˜¯ä¸­é€”å–æ¶ˆè¿˜æ˜¯å‘ç”Ÿå¼‚å¸¸ï¼Œéƒ½è¿”å›trueã€‚</li> <li><strong>boolean isCanceller()</strong> ï¼šå¦‚æœä»»åŠ¡å®Œæˆå‰è¢«å–æ¶ˆï¼Œåˆ™è¿”å›trueã€‚</li> <li><strong>boolean cancel(boolean mayInterruptRunning)</strong> ï¼šå¦‚æœä»»åŠ¡è¿˜æ²¡å¼€å§‹ï¼Œæ‰§è¡Œcancel(...)æ–¹æ³•å°†è¿”å›falseï¼›å¦‚æœä»»åŠ¡å·²ç»å¯åŠ¨ï¼Œæ‰§è¡Œcancel(true)æ–¹æ³•å°†ä»¥ä¸­æ–­æ‰§è¡Œæ­¤ä»»åŠ¡çº¿ç¨‹çš„æ–¹å¼æ¥è¯•å›¾åœæ­¢ä»»åŠ¡ï¼Œå¦‚æœåœæ­¢æˆåŠŸï¼Œè¿”å›trueï¼›å½“ä»»åŠ¡å·²ç»å¯åŠ¨ï¼Œæ‰§è¡Œcancel(false)æ–¹æ³•å°†ä¸ä¼šå¯¹æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡çº¿ç¨‹äº§ç”Ÿå½±å“(è®©çº¿ç¨‹æ­£å¸¸æ‰§è¡Œåˆ°å®Œæˆ)ï¼Œæ­¤æ—¶è¿”å›falseï¼›å½“ä»»åŠ¡å·²ç»å®Œæˆï¼Œæ‰§è¡Œcancel(...)æ–¹æ³•å°†è¿”å›falseã€‚mayInterruptRunningå‚æ•°è¡¨ç¤ºæ˜¯å¦ä¸­æ–­æ‰§è¡Œä¸­çš„çº¿ç¨‹ã€‚
é€šè¿‡æ–¹æ³•åˆ†ææˆ‘ä»¬ä¹ŸçŸ¥é“å®é™…ä¸ŠFutureæä¾›äº†4ç§åŠŸèƒ½ï¼š
<ol><li>èƒ½å¤Ÿä¸­æ–­æ‰§è¡Œä¸­çš„ä»»åŠ¡</li> <li>åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæˆ</li> <li>åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆ</li> <li>è·å–ä»»åŠ¡æ‰§è¡Œå®Œæˆåçš„ç»“æœã€‚</li></ol></li></ul> <h3 id="ç¬¬å››ç§-é€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹"><a href="#ç¬¬å››ç§-é€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹" class="header-anchor">#</a> ç¬¬å››ç§ï¼šé€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹</h3> <p>ExecutorServiceã€Callableéƒ½æ˜¯å±äºExecutoræ¡†æ¶ã€‚è¿”å›ç»“æœçš„çº¿ç¨‹æ˜¯åœ¨JDK1.5ä¸­å¼•å…¥çš„æ–°ç‰¹å¾ï¼Œè¿˜æœ‰Futureæ¥å£ä¹Ÿæ˜¯å±äºè¿™ä¸ªæ¡†æ¶ï¼Œæœ‰äº†è¿™ç§ç‰¹å¾å¾—åˆ°è¿”å›å€¼å°±å¾ˆæ–¹ä¾¿äº†ã€‚
é€šè¿‡åˆ†æå¯ä»¥çŸ¥é“ï¼Œä»–åŒæ ·ä¹Ÿæ˜¯å®ç°äº†Callableæ¥å£ï¼Œå®ç°äº†Callæ–¹æ³•ï¼Œæ‰€ä»¥æœ‰è¿”å›å€¼ã€‚è¿™ä¹Ÿå°±æ˜¯æ­£å¥½ç¬¦åˆäº†å‰é¢æ‰€è¯´çš„ä¸¤ç§åˆ†ç±»</p> <p>é€šè¿‡<code>submit()</code>ï¼ˆexecute()æ–¹æ³•æ— è¿”å›å€¼ï¼‰æ–¹æ³•æ‰§è¡ŒCallableä»»åŠ¡åï¼Œå¯ä»¥è·å–ä¸€ä¸ªFutureçš„è¿”å›å¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡ä¸Šè°ƒç”¨getå°±å¯ä»¥è·å–åˆ°Callableä»»åŠ¡è¿”å›çš„Objectäº†ã€‚getæ–¹æ³•æ˜¯é˜»å¡çš„ï¼Œå³ï¼šçº¿ç¨‹æ— è¿”å›ç»“æœï¼Œgetæ–¹æ³•ä¼šä¸€ç›´ç­‰å¾…ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadDemo05</span><span class="token punctuation">{</span>
 
    <span class="token comment">//çº¿ç¨‹æ± æ•°é‡</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> POOL_NUM <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>     
 
    <span class="token comment">/**
     * @param args
     * @throws InterruptedException 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO Auto-generated method stub</span>
        <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>POOL_NUM<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>  
        <span class="token punctuation">{</span>  
            <span class="token class-name">RunnableThread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RunnableThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
            <span class="token comment">//Thread.sleep(1000);</span>
            <span class="token comment">//æ— è¿”å›å€¼</span>
            <span class="token operator">/</span>executorService<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>thread<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">//æœ‰è¿”å›å€¼</span>
            <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>thread<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>
        <span class="token comment">//å…³é—­çº¿ç¨‹æ± </span>
        executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>   
 
<span class="token punctuation">}</span>
 
<span class="token keyword">class</span> <span class="token class-name">RunnableThread</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span>  
<span class="token punctuation">{</span>     
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token punctuation">{</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é€šè¿‡çº¿ç¨‹æ± æ–¹å¼åˆ›å»ºçš„çº¿ç¨‹ï¼š&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;çº¿ç¨‹ç»“æŸåçš„è¿”å›å€¼ï¼š&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">;</span>
 
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="future-futuretask"><a href="#future-futuretask" class="header-anchor">#</a> Future | FutureTask</h3> <h3 id="ç»§æ‰¿å’Œç»„åˆä¸¤ç§åˆ›å»ºæ–¹å¼çš„ä¸åŒ"><a href="#ç»§æ‰¿å’Œç»„åˆä¸¤ç§åˆ›å»ºæ–¹å¼çš„ä¸åŒ" class="header-anchor">#</a> ç»§æ‰¿å’Œç»„åˆä¸¤ç§åˆ›å»ºæ–¹å¼çš„ä¸åŒ</h3> <ol><li>ç»§æ‰¿æ–¹å¼å’Œæ¥å£æ–¹å¼ï¼Œåè€…å±äºç»„åˆçš„æŠ€æœ¯ï¼Œè€¦åˆæ€§æ›´ä½</li> <li>åè€…çš„ä¸€ä¸ªRunnableå®ä¾‹å¯ä»¥è¢«<code>å¤šä¸ªçº¿ç¨‹å®ä¾‹å…±äº«</code></li> <li>ç»§æ‰¿çš„æ–¹å¼åˆ›å»ºçº¿ç¨‹ï¼ŒJavaè™šæ‹Ÿæœºä¼šä¸ºå…¶åˆ†é…è°ƒç”¨æ ˆç©ºé—´ã€å†…æ ¸çº¿ç¨‹ç­‰èµ„æºï¼Œæˆæœ¬æ›´åŠ æ˜‚è´µ</li></ol> <h2 id="çº¿ç¨‹çš„å¯åŠ¨"><a href="#çº¿ç¨‹çš„å¯åŠ¨" class="header-anchor">#</a> çº¿ç¨‹çš„å¯åŠ¨</h2> <div class="custom-block tip"><p class="custom-block-title">å‚è€ƒ</p> <ul><li><a href="https://www.jianshu.com/p/8c16aeea7e1a" target="_blank" rel="noopener noreferrer">çº¿ç¨‹å¯åŠ¨åŸç†<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <h3 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="header-anchor">#</a> ä¸€äº›æ¦‚å¿µ</h3> <ul><li>Javaå¤šçº¿ç¨‹ï¼Œçš†å§‹äºThreadã€‚Threadæ˜¯å¤šçº¿ç¨‹çš„æ ¹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹çš„å¼€å¯éƒ½å§‹äºThreadçš„start()æ–¹æ³•ã€‚</li> <li>startæ–¹æ³•è°ƒç”¨ç»“æŸå¹¶ä¸æ„å‘³ç€ç›¸åº”çš„çº¿ç¨‹å·²ç»å¼€å§‹è¿è¡Œï¼Œè¿è¡Œæ—¶é—´æœ‰<code>çº¿ç¨‹è°ƒåº¦å™¨</code>å†³å®š</li> <li>çº¿ç¨‹å±äºâ€œä¸€æ¬¡æ€§ç”¨å“â€,æˆ‘ä»¬ä¸èƒ½é€šè¿‡é‡æ–°è°ƒç”¨ä¸€ä¸ªå·²ç»è¿è¡Œç»“æŸçš„çº¿ç¨‹çš„<code>start</code>æ–¹æ³•æ¥ä½¿å…¶é‡æ–°è¿è¡Œã€‚äº‹å®ä¸Š, startæ–¹æ³•ä¹Ÿåªèƒ½å¤Ÿè¢«è°ƒç”¨ä¸€æ¬¡,å¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ª Threadå®ä¾‹çš„startæ–¹æ³•ä¼šå¯¼è‡´å…¶æŠ›å‡º<code>IllegalThreadState Exception</code>å¼‚å¸¸ã€‚</li></ul> <h3 id="è°ƒç”¨startå’Œrunæ–¹æ³•åŒºåˆ«"><a href="#è°ƒç”¨startå’Œrunæ–¹æ³•åŒºåˆ«" class="header-anchor">#</a> è°ƒç”¨startå’Œrunæ–¹æ³•åŒºåˆ«</h3> <p>new â¼€ä¸ª Threadï¼Œçº¿ç¨‹è¿›â¼Šäº†æ–°å»ºçŠ¶æ€;è°ƒâ½¤ start() â½…æ³•ï¼Œä¼šå¯åŠ¨â¼€ä¸ªçº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›â¼Šäº†å°±ç»ªçŠ¶ æ€ï¼Œå½“åˆ†é…åˆ°æ—¶é—´â½šåå°±å¯ä»¥å¼€å§‹è¿â¾äº†ã€‚ start() ä¼šæ‰§â¾çº¿ç¨‹çš„ç›¸åº”å‡†å¤‡â¼¯ä½œï¼Œç„¶åâ¾ƒåŠ¨æ‰§â¾ run() â½…æ³•çš„å†…å®¹ï¼Œè¿™æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹â¼¯ä½œã€‚ â½½ç›´æ¥æ‰§â¾ run() â½…æ³•ï¼Œä¼šæŠŠ run â½…æ³•å½“æˆâ¼€ä¸ª main ä¸»çº¿ç¨‹ä¸‹çš„æ™®é€šâ½…æ³•å»æ‰§â¾ï¼Œå¹¶ä¸ä¼šåœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§â¾å®ƒï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯å¤šçº¿ç¨‹â¼¯ä½œã€‚ æ€»ç»“ï¼š è°ƒâ½¤ start â½…æ³•â½…å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›â¼Šå°±ç»ªçŠ¶æ€ï¼Œâ½½ run â½…æ³•åªæ˜¯ thread çš„â¼€ä¸ªæ™®é€š â½…æ³•è°ƒâ½¤ï¼Œè¿˜æ˜¯åœ¨ä¸»çº¿ç¨‹â¾¥æ‰§â¾ã€‚</p> <h3 id="thread-start"><a href="#thread-start" class="header-anchor">#</a> Thread.start()</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">/**
     * Causes this thread to begin execution; the Java Virtual Machine
     * calls the &lt;code&gt;run&lt;/code&gt; method of this thread.
     * 
     * 1ã€startæ–¹æ³•å°†å¯¼è‡´this threadå¼€å§‹æ‰§è¡Œã€‚ç”±JVMè°ƒç”¨this threadçš„runæ–¹æ³•ã€‚
     * 
     * The result is that two threads are running concurrently: the
     * current thread (which returns from the call to the
     * &lt;code&gt;start&lt;/code&gt; method) and the other thread (which executes its
     * &lt;code&gt;run&lt;/code&gt; method).
     * 
     * 2ã€ç»“æœæ˜¯ è°ƒç”¨startæ–¹æ³•çš„å½“å‰çº¿ç¨‹ å’Œ æ‰§è¡Œrunæ–¹æ³•çš„å¦ä¸€ä¸ªçº¿ç¨‹ åŒæ—¶è¿è¡Œã€‚
     * 
     * It is never legal to start a thread more than once.
     * In particular, a thread may not be restarted once it has completed
     * execution.
     *
     * 3ã€å¤šæ¬¡å¯åŠ¨çº¿ç¨‹æ°¸è¿œä¸åˆæ³•ã€‚ ç‰¹åˆ«æ˜¯ï¼Œçº¿ç¨‹ä¸€æ—¦å®Œæˆæ‰§è¡Œå°±ä¸ä¼šé‡æ–°å¯åŠ¨ã€‚
     * 
     * @exception  IllegalThreadStateException  if the thread was already started.
     * å¦‚æœçº¿ç¨‹å·²å¯åŠ¨ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚
     * @see        #run()
     * @see        #stop()
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/**
         * This method is not invoked for the main method thread or &quot;system&quot;
         * group threads created/set up by the VM. Any new functionality added
         * to this method in the future may have to also be added to the VM.
         * 
         * 4ã€å¯¹äºç”±VMåˆ›å»º/è®¾ç½®çš„mainæ–¹æ³•çº¿ç¨‹æˆ–â€œsystemâ€ç»„çº¿ç¨‹ï¼Œä¸ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚ 
         *    æœªæ¥æ·»åŠ åˆ°æ­¤æ–¹æ³•çš„ä»»ä½•æ–°åŠŸèƒ½å¯èƒ½ä¹Ÿå¿…é¡»æ·»åŠ åˆ°VMä¸­ã€‚
         * 
         * A zero status value corresponds to state &quot;NEW&quot;.
         * 5ã€status=0 ä»£è¡¨æ˜¯ status æ˜¯ &quot;NEW&quot;ã€‚
         */</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>threadStatus <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalThreadStateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/* Notify the group that this thread is about to be started
         * so that it can be added to the group's list of threads
         * and the group's unstarted count can be decremented. 
         * 
         * 6ã€é€šçŸ¥ç»„è¯¥çº¿ç¨‹å³å°†å¯åŠ¨ï¼Œä»¥ä¾¿å°†å…¶æ·»åŠ åˆ°çº¿ç¨‹ç»„çš„åˆ—è¡¨ä¸­ï¼Œ
         *    å¹¶ä¸”å‡å°‘çº¿ç¨‹ç»„çš„æœªå¯åŠ¨çº¿ç¨‹æ•°é€’å‡ã€‚
         * 
         * */</span>
        group<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">boolean</span> started <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//7ã€è°ƒç”¨nativeæ–¹æ³•ï¼Œåº•å±‚å¼€å¯å¼‚æ­¥çº¿ç¨‹ï¼Œå¹¶è°ƒç”¨runæ–¹æ³•ã€‚</span>
            <span class="token function">start0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            started <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>started<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    group<span class="token punctuation">.</span><span class="token function">threadStartFailed</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">/* do nothing. If start0 threw a Throwable then it will be passed up the call stack 
                 * 8ã€å¿½ç•¥å¼‚å¸¸ã€‚ å¦‚æœstart0æŠ›å‡ºä¸€ä¸ªThrowableï¼Œå®ƒå°†è¢«ä¼ é€’ç»™è°ƒç”¨å †æ ˆã€‚
                 */</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

 <span class="token comment">//nativeæ–¹æ³•ï¼ŒJVMåˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ï¼Œå¹¶è°ƒç”¨runæ–¹æ³•</span>
 <span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">start0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h3 id="thread-run"><a href="#thread-run" class="header-anchor">#</a> Thread.run()</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å¯è§, Threadç±»çš„runæ–¹æ³•ä¸­å®ç°çš„é€»è¾‘æ˜¯å¦‚æœ targetä¸ä¸ºnull,é‚£ä¹ˆå°±è°ƒç”¨ target. run0,å¦åˆ™å®ƒä»€ä¹ˆä¹Ÿä¸åšã€‚å…¶ä¸­,å®ä¾‹å˜é‡ targetçš„ç±»å‹ä¸º Runnableã€‚å¦‚æœç›¸åº”çš„çº¿ç¨‹å®ä¾‹æ˜¯é€šè¿‡æ„é€ å™¨ Thread(Runnable target)åˆ›å»ºçš„,é‚£ä¹ˆ targetçš„å€¼ä¸ºæ„é€ å™¨ä¸­çš„å‚æ•°å€¼,å¦åˆ™ targetçš„å€¼ä¸ºnullã€‚å› æ­¤, Threadç±»æ‰€å®ç°çš„ä»»åŠ¡å¤„ç†é€»è¾‘æ˜¯è¦ä¹ˆä»€ä¹ˆä¹Ÿä¸åš( targetä¸ºnul),
è¦ä¹ˆç›´æ¥æ‰§è¡Œ targetæ‰€å¼•ç”¨çš„ Runnableå®ä¾‹æ‰€å®ç°çš„ä»»åŠ¡å¤„ç†é€»è¾‘ã€‚</p> <p>Threadç±»çš„runæ–¹æ³•çš„è¿™ç§å¤„ç†é€»è¾‘å†³å®šäº†åˆ›å»ºçº¿ç¨‹çš„ä¸¤ç§æ–¹å¼:</p> <ul><li>ä¸€ç§æ˜¯åœ¨ Threadå­ç±»çš„runæ–¹æ³•ä¸­ç›´æ¥å®ç°ä»»åŠ¡å¤„ç†é€»è¾‘</li> <li>å¦ä¸€ç§æ˜¯åœ¨ä¸€ä¸ª Runnableå®ä¾‹ä¸­å®ç°ä»»åŠ¡å¤„ç†é€»è¾‘,è¯¥é€»è¾‘ç”± Threadç±»çš„runæ–¹æ³•è´Ÿè´£è°ƒç”¨ã€‚</li></ul> <h2 id="çº¿ç¨‹çš„å±æ€§"><a href="#çº¿ç¨‹çš„å±æ€§" class="header-anchor">#</a> çº¿ç¨‹çš„å±æ€§</h2> <p>çº¿ç¨‹çš„å±æ€§åŒ…æ‹¬çº¿ç¨‹çš„</p> <ul><li>ç¼–å·(Id)ï¼šä¸å¯è¯»å†™</li> <li>åç§°(Name)ï¼šå¯è¯»å†™</li> <li>çº¿ç¨‹ç±»åˆ«(Daemon)ï¼šå¯è¯»å†™</li> <li>ä¼˜å…ˆçº§(Priority)ï¼šå¯è¯»å†™</li></ul> <table><thead><tr><th>å±æ€§</th> <th>ç±»å‹</th> <th>ç”¨é€”</th> <th>åªè¯»</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>ç¼–å·(ID)</td> <td>long</td> <td>ç”¨äºæ ‡è¯†ä¸åŒçš„çº¿ç¨‹ï¼Œä¸åŒçš„çº¿ç¨‹æ‹¥æœ‰ ä¸åŒçš„ç¼–å·</td> <td>æ˜¯</td> <td>æŸä¸ªç¼–å·çš„çº¿ç¨‹è¿è¡Œç»“æŸåï¼Œè¯¥ç¼–å·å¯èƒ½è¢«åç»­åˆ›å»ºçš„çº¿ç¨‹ä½¿ç”¨ã€‚ä¸åŒçº¿ç¨‹  æ‹¥æœ‰çš„ç¼–å·è™½ç„¶ä¸åŒï¼Œä½†æ˜¯è¿™ç§ç¼–å·çš„å”¯ä¸€æ€§åªåœ¨Javaè™šæ‹Ÿæœºçš„ä¸€æ¬¡è¿è¡Œæœ‰  æ•ˆã€‚ä¹Ÿå°±æ˜¯è¯´é‡å¯ä¸ªJavaè™šæ‹Ÿæœº(å¦‚é‡å¯WebæœåŠ¡å™¨)åï¼ŒæŸäº›çº¿ç¨‹çš„ç¼–å·å¯èƒ½ ä¸ä¸Šæ¬¡Javaè™šæ‹Ÿæœºè¿è¡Œçš„æŸä¸ªçº¿ç¨‹çš„ç¼–å·ä¸€æ ·ï¼Œå› æ­¤è¯¥å±æ€§çš„å€¼ä¸é€‚åˆç”¨ä½œ  æŸç§å”¯ä¸€æ ‡è¯†ï¼Œç‰¹åˆ«æ˜¯ä½œä¸ºæ•°æ®åº“ä¸­çš„å”¯ä¸€æ ‡è¯†(å¦‚ä¸»é”®)</td></tr> <tr><td>åç§°    (Name)</td> <td>String</td> <td>ç”¨äºåŒºåˆ†ä¸åŒçš„çº¿ç¨‹ï¼Œé»˜è®¤å€¼ä¸çº¿ç¨‹çš„ ç¼–å·æœ‰å…³ï¼Œé»˜è®¤å€¼çš„æ ¼å¼ä¸º:â€œThread-  çº¿ç¨‹ç¼–å·â€ï¼Œå¦‚â€œThread-0â€</td> <td>å¦</td> <td>Javaå¹¶ä¸ç¦æ­¢æˆ‘ä»¬å°†ä¸åŒçš„çº¿ç¨‹çš„åç§°å±æ€§è®¾ç½®ä¸ºç›¸åŒçš„å€¼ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œè®¾ ç½®çº¿ç¨‹çš„åç§°å±æ€§æœ‰åŠ©äºä»£ç è°ƒè¯•å’Œé—®é¢˜å®šä½</td></tr> <tr><td>çº¿ç¨‹ç±»åˆ«  (Daemon)</td> <td>boolean</td> <td>å€¼ä¸ºtnueè¡¨ç¤ºç›¸åº”çš„çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œ å¦åˆ™è¡¨ç¤ºç›¸åº”çš„çº¿ç¨‹ä¸ºç”¨æˆ·çº¿ç¨‹ã€‚è¯¥å±æ€§çš„é»˜è®¤å€¼ä¸ç›¸åº”çº¿ç¨‹çš„çˆ¶çº¿ç¨‹çš„è¯¥å±æ€§çš„å€¼ç›¸åŒã€‚é»˜è®¤ä¸ºfalseã€‚</td> <td>å¦</td> <td>è¯¥å±æ€§å¿…é¡»åœ¨ç›¸åº”çº¿ç¨‹å¯åŠ¨ä¹‹å‰è®¾ç½®ï¼Œå³å¯¹setDaemonæ–¹æ³•çš„è°ƒç”¨å¿…é¡»åœ¨å¯¹startæ–¹æ³•çš„è°ƒç”¨ä¹‹å‰ï¼Œå¦åˆ™setDaemonæ–¹æ³•ä¼šæŠ›å‡º             IllegalThreadStateExceptionå¼‚å¸¸ã€‚è´Ÿè´£ä¸€äº›å…³é”®ä»»åŠ¡å¤„ç†çš„çº¿ç¨‹ä¸é€‚å®œè®¾ ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹</td></tr> <tr><td>ä¼˜å…ˆçº§   (Priority)</td> <td>int</td> <td>è¯¥å±æ€§æœ¬è´¨ä¸Šæ˜¯ç»™çº¿ç¨‹è°ƒåº¦å™¨çš„æç¤ºï¼Œ ç”¨äºè¡¨ç¤ºåº”ç”¨ç¨‹åºå¸Œæœ›å“ªä¸ªçº¿ç¨‹èƒ½å¤Ÿä¼˜ å…ˆå¾—ä»¥è¿è¡Œã€‚Javaå®šä¹‰äº†1~10çš„10ä¸ªä¼˜ å…ˆçº§ï¼Œé»˜è®¤å€¼ä¸€èˆ¬ä¸º5(è¡¨ç¤ºæ™®é€šä¼˜å…ˆçº§ )ã€‚å¯¹äºå…·ä½“çš„ä¸€ä¸ªçº¿ç¨‹è€Œè¨€ï¼Œå…¶ä¼˜å…ˆ  çº§çš„é»˜è®¤å€¼ä¸å…¶çˆ¶çº¿ç¨‹(åˆ›å»ºè¯¥çº¿ç¨‹çš„  çº¿ç¨‹)çš„ä¼˜å…ˆçº§å€¼ç›¸ç­‰ã€‚</td> <td>å¦</td> <td>ä¸€èˆ¬ä½¿ç”¨é»˜è®¤ä¼˜å…ˆçº§å³å¯ï¼Œä¸æ°å½“åœ°è®¾ç½®è¯¥å±æ€§å€¼å¯èƒ½å¯¼è‡´ä¸¥é‡çš„é—®é¢˜(çº¿ç¨‹é¥¥é¥¿)</td></tr></tbody></table> <h3 id="ä¼˜å…ˆçº§çš„è®¾å®š"><a href="#ä¼˜å…ˆçº§çš„è®¾å®š" class="header-anchor">#</a> ä¼˜å…ˆçº§çš„è®¾å®š</h3> <p>Javaçº¿ç¨‹çš„ä¼˜å…ˆçº§å±æ€§æœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ªç»™<code>çº¿ç¨‹è°ƒåº¦å™¨</code>çš„æç¤ºä¿¡æ¯ï¼Œä»¥ä¾¿äºçº¿ç¨‹è°ƒåº¦å™¨å†³å®šä¼˜å…ˆè°ƒåº¦å“ªäº›çº¿ç¨‹è¿è¡Œã€‚ å®ƒå¹¶ä¸èƒ½ä¿è¯çº¿ç¨‹æŒ‰ç…§å…¶ä¼˜å…ˆçº§é«˜ä½çš„é¡ºåºè¿è¡Œã€‚å¦å¤–ï¼ŒJavaçº¿ç¨‹çš„ä¼˜å…ˆçº§ä½¿ç”¨ä¸å½“æˆ–è€…æ»¥ç”¨åˆ™å¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹æ°¸è¿œæ— æ³•å¾—åˆ°è¿è¡Œï¼Œ å³äº§ç”Ÿäº†<code>çº¿ç¨‹é¥¥é¥¿(Thread Starvation)</code>ã€‚</p> <blockquote><p>å› æ­¤ï¼Œçº¿ç¨‹çš„ä¼˜å…ˆçº§å¹¶ä¸æ˜¯è®¾ç½®å¾—è¶Šé«˜è¶Šå¥½ï¼› ä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨æ™®é€šä¼˜å…ˆçº§å³å¯ï¼Œå³ä¸å¿…è®¾ç½®çº¿ç¨‹çš„ä¼˜å…ˆçº§å±æ€§ã€‚</p></blockquote> <h3 id="å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹-éå®ˆæŠ¤çº¿ç¨‹"><a href="#å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹-éå®ˆæŠ¤çº¿ç¨‹" class="header-anchor">#</a> å®ˆæŠ¤çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹ï¼ˆéå®ˆæŠ¤çº¿ç¨‹ï¼‰</h3> <p>æŒ‰ç…§çº¿ç¨‹æ˜¯å¦ä¼šé˜»æ­¢Javaè™šæ‹Ÿæœºæ­£å¸¸åœæ­¢,æˆ‘ä»¬å¯ä»¥å°†Javaä¸­çš„çº¿ç¨‹åˆ†ä¸ºå®ˆæŠ¤çº¿ç¨‹( Daemon Thread)å’Œç”¨æˆ·çº¿ç¨‹( User Thread,ä¹Ÿç§°éå®ˆæŠ¤çº¿ç¨‹)ã€‚</p> <p>çº¿ç¨‹çš„ daemonå±æ€§ç”¨äºè¡¨ç¤ºç›¸åº”çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</p> <ul><li>ç”¨æˆ·çº¿ç¨‹ä¼šé˜»æ­¢Javaè™šæ‹Ÿæœºçš„æ­£å¸¸åœæ­¢,å³ä¸€ä¸ªJavaè™šæ‹Ÿæœºåªæœ‰åœ¨å…¶æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½è¿è¡Œç»“æŸ(å³ Thread runoè°ƒç”¨æœªç»“æŸ)çš„æƒ…å†µä¸‹æ‰èƒ½æ­£å¸¸åœæ­¢ã€‚</li> <li>è€Œå®ˆæŠ¤çº¿ç¨‹åˆ™ä¸ä¼šå½±å“Javaè™šæ‹Ÿæœºçš„æ­£å¸¸åœæ­¢,å³åº”ç”¨ç¨‹åºä¸­æœ‰å®ˆæŠ¤çº¿ç¨‹åœ¨è¿è¡Œä¹Ÿä¸å½±å“Javaè™šæ‹Ÿæœºçš„æ­£å¸¸åœæ­¢ã€‚</li></ul> <p>å› æ­¤,å®ˆæŠ¤çº¿ç¨‹é€šå¸¸ç”¨äºæ‰§è¡Œä¸€äº›é‡è¦æ€§ä¸æ˜¯å¾ˆé«˜çš„ä»»åŠ¡,ä¾‹å¦‚ç”¨äºç›‘è§†å…¶ä»–çº¿ç¨‹çš„è¿è¡Œæƒ…å†µã€‚</p> <p>å¦‚æœJavaè™šæ‹Ÿæœºæ˜¯è¢«å¼ºåˆ¶åœæ­¢çš„,æ¯”å¦‚åœ¨ Linuxç³»ç»Ÿä¸‹ä½¿ç”¨killå‘½ä»¤å¼ºåˆ¶ç»ˆæ­¢ä¸€ä¸ªJavaè™šæ‹Ÿæœºè¿›ç¨‹,é‚£ä¹ˆå³ä½¿æ˜¯ç”¨æˆ·çº¿ç¨‹ä¹Ÿæ— æ³•é˜»æ­¢Javaè™šæ‹Ÿæœºçš„åœæ­¢ã€‚</p> <h2 id="çº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•"><a href="#çº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•" class="header-anchor">#</a> çº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•</h2> <table><thead><tr><th>æ–¹æ³•</th> <th>åŠŸèƒ½</th> <th>å¤‡æ³¨</th></tr></thead> <tbody><tr><td>static Thread    currentThread()</td> <td>è¿”å›å½“å‰çº¿ç¨‹ï¼Œå³å½“å‰ä»£ç çš„æ‰§è¡Œçº¿ç¨‹(å¯¹è±¡)</td> <td>åŒä¸€æ®µä»£ç åœ¨ä¸åŒæ—¶åˆ»å¯¹Thread.currentThreadçš„è°ƒç”¨,å…¶è¿”å›å€¼å¯èƒ½ä¸åŒ</td></tr> <tr><td>void run()</td> <td>çº¿ç¨‹çš„ä»»åŠ¡å¤„ç†é€»è¾‘</td> <td>è¯¥æ–¹æ³•æ˜¯ç”±Javaè™šæ‹Ÿæœºç›´æ¥è°ƒç”¨çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åº”ç”¨ç¨‹åºä¸åº”è¯¥è°ƒç”¨è¯¥æ–¹æ³•</td></tr> <tr><td>void start()</td> <td>å¯åŠ¨çº¿ç¨‹</td> <td>è¯¥æ–¹æ³•çš„è¿”å›å¹¶ä¸ä»£è¡¨ç›¸åº”çš„çº¿ç¨‹å·²ç»è¢«å¯åŠ¨ï¼›ä¸€ä¸ªThreadå®ä¾‹çš„startæ–¹æ³•  åªèƒ½å¤Ÿè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå¤šæ¬¡è°ƒç”¨ä¼šæŠ›å‡ºå¼‚å¸¸</td></tr> <tr><td>void join()</td> <td>ç­‰å¾…çº¿ç¨‹è¿è¡Œç»“æŸ</td> <td>çº¿ç¨‹Aè°ƒç”¨çº¿ç¨‹Bçš„joinæ–¹æ³•ï¼Œé‚£ä¹ˆçº¿ç¨‹Açš„è¿è¡Œä¼šè¢«æš‚åœï¼Œç›´åˆ°çº¿ç¨‹Bè¿è¡Œç»“æŸ</td></tr> <tr><td>static void yield()</td> <td>ä½¿å½“å‰çº¿ç¨‹ä¸»åŠ¨æ”¾å¼ƒå…¶å¯¹å¤„ç†å™¨çš„å ç”¨ï¼Œè¿™å¯èƒ½å¯¼è‡´å½“å‰çº¿ç¨‹è¢«æš‚åœ</td> <td>è¿™ä¸ªæ–¹æ³•æ˜¯ä¸å¯é çš„ï¼Œè¯¥æ–¹æ³•è¢«è°ƒç”¨æ—¶å½“å‰çº¿ç¨‹å¯èƒ½ä»ç„¶ç»§ç»­è¿è¡Œ(è§†ç³»ç»Ÿå½“å‰çš„è¿è¡ŒçŠ¶å†µè€Œå®š)  ã€‚ä¼šä½¿çº¿ç¨‹ä¸ºREADYçŠ¶æ€</td></tr> <tr><td>static void     sleep(long millis)</td> <td>ä½¿å½“å‰çº¿ç¨‹ä¼‘çœ (æš‚åœè¿è¡Œ)æŒ‡å®šçš„æ—¶é—´</td> <td></td></tr> <tr><td>isAlive()</td> <td>åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€</td> <td>çº¿ç¨‹è°ƒç”¨startåï¼Œå³å¤„äºæ´»åŠ¨çŠ¶æ€</td></tr> <tr><td>interrupt()</td> <td>ä¸­æ–­çº¿ç¨‹</td> <td>è¯¥æ–¹æ³•åªæ˜¯æŠŠè®¾ç½®å½“å‰çº¿ç¨‹ä¸€ä¸ªå±æ€§æ ‡è®°ä¸ºtrueï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±è·å–ç„¶ååˆ¤æ–­å†³å®šæ¥ä¸‹æ¥çš„æ“ä½œ</td></tr> <tr><td>static interrupted</td> <td>è‡ªå·±ä¸­æ–­è‡ªå·±</td> <td>é™æ€æ–¹æ³•ï¼Œåªèƒ½è‡ªå·±ä¸­æ–­è‡ªå·±</td></tr> <tr><td>wait()</td> <td>å¯¼è‡´çº¿ç¨‹ç­‰å¾…ï¼Œè¿›å…¥å µå¡çŠ¶æ€ã€‚é‡Šæ”¾é”ã€‚</td> <td>è¯¥æ–¹æ³•è¦åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥ä»£ç å—ä¸­æ‰ä½¿ç”¨çš„</td></tr> <tr><td>notify()</td> <td>å”¤é†’å½“å‰çº¿ç¨‹ï¼Œè¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚ä¸é‡Šæ”¾é”ã€‚</td> <td>è¯¥æ–¹æ³•è¦åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥ä»£ç å—ä¸­æ‰ä½¿ç”¨çš„</td></tr> <tr><td>notifyAll()</td> <td>å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ã€‚</td> <td>è¯¥æ–¹æ³•è¦åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥ä»£ç å—ä¸­æ‰ä½¿ç”¨çš„</td></tr></tbody></table> <h3 id="stop-suspend"><a href="#stop-suspend" class="header-anchor">#</a> stop&amp;suspend</h3> <p>ç¦ç”¨åŸå› </p> <ul><li>stopï¼š,æ˜¯å› ä¸ºå®ƒä¸å®‰å…¨ã€‚å®ƒä¼šè§£é™¤ç”±çº¿ç¨‹è·å–çš„æ‰€æœ‰é”å®š,è€Œä¸”å¦‚æœå¯¹è±¡å¤„äºä¸€ ç§ä¸è¿è´¯çŠ¶æ€,é‚£ä¹ˆå…¶ä»–çº¿ç¨‹èƒ½åœ¨é‚£ç§çŠ¶æ€ä¸‹æ£€æŸ¥å’Œä¿®æ”¹å®ƒä»¬ã€‚ç»“æœå¾ˆéš¾æ£€æŸ¥å‡ºçœŸæ­£çš„é—®é¢˜ æ‰€åœ¨</li> <li>suspendï¼šsuspend()æ–¹æ³•å®¹æ˜“å‘ç”Ÿæ­»é”ã€‚è°ƒç”¨ suspend()çš„æ—¶å€™,ç›®æ ‡çº¿ç¨‹ä¼šåœä¸‹æ¥,ä½†å´ä» ç„¶æŒæœ‰åœ¨è¿™ä¹‹å‰è·å¾—çš„é”å®š</li></ul> <h3 id="interrupt-interrupted"><a href="#interrupt-interrupted" class="header-anchor">#</a> interrupt&amp;interrupted</h3> <ul><li>åªæ˜¯æŠŠè®¾ç½®å½“å‰çº¿ç¨‹ä¸€ä¸ªå±æ€§æ ‡è®°ä¸ºtrueï¼Œå¹¶ä¸ä¼šç›´æ¥ä¸­æ–­ï¼Œå³ä½¿æŠ›å‡ºå¼‚å¸¸ä¹Ÿä¼šæ‰§è¡Œå®Œå‰©ä¸‹çš„æ“ä½œï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±è·å–ç„¶ååˆ¤æ–­å†³å®šæ¥ä¸‹æ¥çš„æ“ä½œã€‚</li> <li>å½“çº¿ç¨‹å‘é€ä¸­æ–­è¯·æ±‚åï¼Œsleep()æ–¹æ³•æŠ›å‡ºäº†<code>InterruptedException</code>å¼‚å¸¸ï¼Œå¹¶ä¸”å°†çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€é‡ç½®ä¸º``false`</li> <li>æŠ›å‡ºå¼‚å¸¸æ˜¯ä¸ºäº†çº¿ç¨‹ä»é˜»å¡çŠ¶æ€é†’è¿‡æ¥ï¼Œå¹¶åœ¨ç»“æŸçº¿ç¨‹å‰è®©ç¨‹åºå‘˜æœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥å¤„ç†ä¸­æ–­è¯·æ±‚ã€‚</li> <li>å¤„äºç­‰å¾…çš„çº¿ç¨‹ï¼Œå³åœ¨æ‰§è¡ŒObjectå¯¹è±¡çš„wait()ã€wait(long)ã€wait(long, int)ï¼Œæˆ–è€…çº¿ç¨‹ç±»çš„join()ã€join(long)ã€join(long, int)ã€sleep(long)ã€sleep(long,int)æ–¹æ³•åçº¿ç¨‹çš„çŠ¶æ€ï¼Œå½“çº¿ç¨‹è°ƒç”¨interrupt()æ–¹æ³•åï¼Œä¼šç«‹å³é€€å‡ºè¢«é˜»å¡çŠ¶æ€ï¼Œè¿™äº›æ–¹æ³•å°†æŠ›å‡º<code>InterruptedException</code>å¼‚å¸¸ï¼Œå¹¶æ¸…ç©ºçº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œå³<code>isInterrupted()</code>è¿”å›false</li> <li>åœ¨é˜»å¡çŠ¶æ€ï¼Œsynchronizedåœ¨è·é”çš„è¿‡ç¨‹ä¸­æ˜¯ä¸èƒ½è¢«ä¸­æ–­çš„ï¼Œæ„æ€æ˜¯è¯´å¦‚æœäº§ç”Ÿäº†æ­»é”ï¼Œåˆ™ä¸å¯èƒ½è¢«ä¸­æ–­ï¼ˆè¯·å‚è€ƒåé¢çš„æµ‹è¯•ä¾‹å­ï¼‰ã€‚ä¸synchronizedåŠŸèƒ½ç›¸ä¼¼çš„reentrantLock.lock()æ–¹æ³•ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå®ƒä¹Ÿä¸å¯ä¸­æ–­çš„ï¼Œå³å¦‚æœå‘ç”Ÿæ­»é”ï¼Œé‚£ä¹ˆreentrantLock.lock()æ–¹æ³•æ— æ³•ç»ˆæ­¢ï¼Œå¦‚æœè°ƒç”¨æ—¶è¢«é˜»å¡ï¼Œåˆ™å®ƒä¸€ç›´é˜»å¡åˆ°å®ƒè·å–åˆ°é”ä¸ºæ­¢</li></ul> <p>ä½†æ˜¯å¦‚æœè°ƒç”¨å¸¦<code>è¶…æ—¶</code>çš„tryLockæ–¹æ³•reentrantLock.tryLock(long timeout, TimeUnit unit)ï¼Œé‚£ä¹ˆå¦‚æœçº¿ç¨‹åœ¨ç­‰å¾…æ—¶è¢«ä¸­æ–­ï¼Œå°†æŠ›å‡ºä¸€ä¸ª<code>InterruptedException</code>å¼‚å¸¸ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼Œå› ä¸ºå®ƒå…è®¸ç¨‹åºæ‰“ç ´æ­»é”ã€‚ä½ ä¹Ÿå¯ä»¥è°ƒç”¨<code>reentrantLock.lockInterruptibly()</code>æ–¹æ³•ï¼Œåœ¨é˜»å¡æ—¶å¯ä»¥ç«‹å³å“åº”<code>interrupt</code>ã€‚</p> <p><strong>é£Ÿç”¨æ–¹æ³•</strong></p> <p>å¯ä»¥é€šè¿‡æ•è·å¼‚å¸¸çš„æ–¹å¼æ¥å¤„ç†è¢«ä¸­æ–­çš„çº¿ç¨‹</p> <h2 id="çº¿ç¨‹çš„å±‚æ¬¡å…³ç³»"><a href="#çº¿ç¨‹çš„å±‚æ¬¡å…³ç³»" class="header-anchor">#</a> çº¿ç¨‹çš„å±‚æ¬¡å…³ç³»</h2> <h3 id="çˆ¶çº¿ç¨‹ä¸å­çº¿ç¨‹"><a href="#çˆ¶çº¿ç¨‹ä¸å­çº¿ç¨‹" class="header-anchor">#</a> çˆ¶çº¿ç¨‹ä¸å­çº¿ç¨‹</h3> <p>Javaå¹³å°ä¸­çš„çº¿ç¨‹ä¸æ˜¯å­¤ç«‹çš„ï¼Œçº¿ç¨‹ä¸çº¿ç¨‹ä¹‹é—´æ€»æ˜¯å­˜åœ¨ä¸€äº›è”ç³»ã€‚å‡è®¾çº¿ç¨‹Aæ‰€æ‰§è¡Œçš„ä»£ç åˆ›å»ºäº†çº¿ç¨‹Bï¼Œ é‚£ä¹ˆï¼Œä¹ æƒ¯ä¸Šæˆ‘ä»¬ç§°çº¿ç¨‹Bä¸ºçº¿ç¨‹Açš„å­çº¿ç¨‹ï¼Œç›¸åº”åœ°çº¿ç¨‹Aå°±è¢«ç§°ä¸ºçº¿ç¨‹Bçš„çˆ¶çº¿ç¨‹ã€‚ä¸è¿‡Javaå¹³å°ä¸­å¹¶æ²¡æœ‰APIç”¨äºè·å–ä¸€ä¸ªçº¿ç¨‹çš„çˆ¶çº¿ç¨‹ï¼Œ æˆ–è€…è·å–ä¸€ä¸ªçº¿ç¨‹çš„æ‰€æœ‰å­çº¿ç¨‹ã€‚</p> <h3 id="çˆ¶å­çº¿ç¨‹çš„daemonå€¼"><a href="#çˆ¶å­çº¿ç¨‹çš„daemonå€¼" class="header-anchor">#</a> çˆ¶å­çº¿ç¨‹çš„Daemonå€¼</h3> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œçˆ¶çº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œåˆ™å­çº¿ç¨‹ä¹Ÿæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œçˆ¶çº¿ç¨‹æ˜¯ç”¨æˆ·çº¿ç¨‹ï¼Œåˆ™å­çº¿ç¨‹ä¹Ÿæ˜¯ç”¨æˆ·çº¿ç¨‹ã€‚ å¦å¤–ï¼Œçˆ¶çº¿ç¨‹åœ¨åˆ›å»ºå­çº¿ç¨‹åå¯åŠ¨å­çº¿ç¨‹ä¹‹å‰å¯ä»¥è°ƒç”¨è¯¥çº¿ç¨‹çš„<code>setDaemon</code>æ–¹æ³•ï¼Œå°†ç›¸åº”çš„çº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹(æˆ–è€…ç”¨æˆ·çº¿ç¨‹)ã€‚</p> <h3 id="çˆ¶å­çº¿ç¨‹çš„ä¼˜å…ˆçº§"><a href="#çˆ¶å­çº¿ç¨‹çš„ä¼˜å…ˆçº§" class="header-anchor">#</a> çˆ¶å­çº¿ç¨‹çš„ä¼˜å…ˆçº§</h3> <p>ä¸€ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§é»˜è®¤å€¼ä¸ºè¯¥çº¿ç¨‹çš„çˆ¶çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå³å¦‚æœæˆ‘ä»¬æ²¡æœ‰è®¾ç½®æˆ–è€…æ›´æ”¹ä¸€ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œ é‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§çš„å€¼ä¸çˆ¶çº¿ç¨‹çš„ä¼˜å…ˆçº§çš„å€¼ç›¸ç­‰ã€‚</p> <h3 id="çˆ¶å­çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#çˆ¶å­çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" class="header-anchor">#</a> çˆ¶å­çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</h3> <p>çˆ¶çº¿ç¨‹å’Œå­çº¿ç¨‹ä¹‹é—´çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿæ²¡æœ‰å¿…ç„¶çš„è”ç³»ã€‚æ¯”å¦‚çˆ¶çº¿ç¨‹è¿è¡Œç»“æŸåï¼Œå­çº¿ç¨‹å¯ä»¥ç»§ç»­è¿è¡Œï¼Œ å­çº¿ç¨‹è¿è¡Œç»“æŸä¹Ÿä¸å¦¨ç¢å…¶çˆ¶çº¿ç¨‹ç»§ç»­è¿è¡Œã€‚</p> <h3 id="å·¥ä½œè€…çº¿ç¨‹"><a href="#å·¥ä½œè€…çº¿ç¨‹" class="header-anchor">#</a> å·¥ä½œè€…çº¿ç¨‹</h3> <p>ä¹ æƒ¯ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿç§°æŸäº›å­çº¿ç¨‹ä¸ºå·¥ä½œè€…çº¿ç¨‹(Worker Thread)æˆ–è€…åå°çº¿ç¨‹(Background Thread)ã€‚ å·¥ä½œè€…çº¿ç¨‹é€šå¸¸æ˜¯å…¶çˆ¶çº¿ç¨‹åˆ›å»ºæ¥ç”¨äºä¸“é—¨è´Ÿè´£æŸé¡¹ç‰¹å®šä»»åŠ¡çš„æ‰§è¡Œçš„ã€‚ ä¾‹å¦‚ï¼ŒJavaè™šæ‹Ÿæœºä¸­å¯¹å†…å­˜è¿›è¡Œå›æ”¶çš„çº¿ç¨‹é€šå¸¸è¢«ç§°ä¸ºGCå·¥ä½œè€…çº¿ç¨‹ã€‚</p> <h2 id="çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€"><a href="#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€" class="header-anchor">#</a> çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€</h2> <p>Java çº¿ç¨‹åœ¨è¿â¾çš„â½£å‘½å‘¨æœŸä¸­çš„æŒ‡å®šæ—¶åˆ»åªå¯èƒ½å¤„äºä¸‹â¾¯ 6 ç§ä¸åŒçŠ¶æ€çš„å…¶ä¸­â¼€ä¸ªçŠ¶æ€ï¼ˆå›¾æºã€ŠJava å¹¶å‘ç¼–ç¨‹è‰ºæœ¯ã€‹4.1.4 èŠ‚ï¼‰ã€‚</p> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/Java-MultiThread-1/çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçŠ¶æ€.jpg" alt="çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçŠ¶æ€"></p> <p>çº¿ç¨‹åœ¨â½£å‘½å‘¨æœŸä¸­å¹¶ä¸æ˜¯å›ºå®šå¤„äºæŸâ¼€ä¸ªçŠ¶æ€â½½æ˜¯éšç€ä»£ç çš„æ‰§â¾åœ¨ä¸åŒçŠ¶æ€ä¹‹é—´åˆ‡æ¢ã€‚Java çº¿ç¨‹çŠ¶ æ€å˜è¿å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå›¾æºã€ŠJava å¹¶å‘ç¼–ç¨‹è‰ºæœ¯ã€‹4.1.4 èŠ‚ï¼‰ï¼š</p> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/Java-MultiThread-1/çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçŠ¶æ€2.jpg" alt="çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçŠ¶æ€2"></p> <p>ç”±ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼šçº¿ç¨‹åˆ›å»ºä¹‹åå®ƒå°†å¤„äº <strong>NEWï¼ˆæ–°å»ºï¼‰ çŠ¶æ€</strong>ï¼Œ<strong>è°ƒâ½¤ start() â½…æ³•åå¼€å§‹è¿â¾</strong>ï¼Œçº¿ç¨‹ è¿™æ—¶å€™å¤„äº <strong>READYï¼ˆå¯è¿â¾ï¼‰ çŠ¶æ€</strong>ã€‚å¯è¿â¾çŠ¶æ€çš„çº¿ç¨‹è·å¾—äº† **CPU æ—¶é—´â½šï¼ˆtimesliceï¼‰**åå°±å¤„äº <strong>RUNNINGï¼ˆè¿â¾ï¼‰</strong> çŠ¶æ€ã€‚</p> <h3 id="new"><a href="#new" class="header-anchor">#</a> NEW</h3> <p>ä¸€ä¸ªå·²åˆ›å»ºè€Œæœªå¯åŠ¨çš„çº¿ç¨‹å¤„äºè¯¥çŠ¶æ€ã€‚ç”±äºä¸€ä¸ªçº¿ç¨‹å®ä¾‹åªèƒ½å¤Ÿè¢«å¯åŠ¨æ¬¡ï¼Œå› æ­¤ä¸€ä¸ªçº¿ç¨‹åªå¯èƒ½æœ‰ä¸€æ¬¡å¤„äºè¯¥çŠ¶æ€ã€‚</p> <h3 id="runnable"><a href="#runnable" class="header-anchor">#</a> RUNNABLE</h3> <p>è¯¥çŠ¶æ€å¯ä»¥è¢«çœ‹æˆä¸€ä¸ªå¤åˆçŠ¶æ€ï¼Œå®ƒåŒ…æ‹¬ä¸¤ä¸ªå­çŠ¶æ€ï¼š<code>READY</code>å’Œ<code>RUNNING</code>ã€‚ å‰è€…è¡¨ç¤ºå¤„äºè¯¥çŠ¶æ€çš„çº¿ç¨‹å¯ä»¥è¢«<code>çº¿ç¨‹è°ƒåº¦å™¨(Scheduler)</code>è¿›è¡Œè°ƒåº¦è€Œä½¿ä¹‹å¤„äº<code>RUNNING</code>çŠ¶æ€ï¼› åè€…è¡¨ç¤ºå¤„äºè¯¥çŠ¶æ€çš„çº¿ç¨‹æ­£åœ¨è¿è¡Œï¼Œå³ç›¸åº”çº¿ç¨‹å¯¹è±¡çš„runæ–¹æ³•æ‰€å¯¹åº”çš„æŒ‡ä»¤æ­£åœ¨ç”±å¤„ç†å™¨æ‰§è¡Œã€‚ æ‰§è¡Œ<code>Thread.yield()</code>çš„çº¿ç¨‹ï¼Œå…¶çŠ¶æ€å¯èƒ½ä¼šç”±<code>RUNNING</code>è½¬æ¢ä¸º<code>READY</code>ã€‚å¤„äº<code>READY</code>å­çŠ¶æ€çš„çº¿ç¨‹ä¹Ÿè¢«ç§°ä¸ºæ´»è·ƒçº¿ç¨‹ã€‚</p> <h3 id="blocked"><a href="#blocked" class="header-anchor">#</a> BLOCKED</h3> <p>ä¸€ä¸ªçº¿ç¨‹å‘èµ·ä¸€ä¸ªé˜»å¡å¼I/O(Blocking I/O)æ“ä½œåï¼Œæˆ–è€…ç”³è¯·ä¸€ä¸ªç”±å…¶ä»–çº¿ç¨‹æŒæœ‰çš„ç‹¬å èµ„æº(æ¯”å¦‚é”)æ—¶ï¼Œç›¸åº”çš„çº¿ç¨‹ä¼šå¤„äºè¯¥çŠ¶æ€ï¼Œ å¤„äºBlockedçŠ¶æ€çš„çº¿ç¨‹å¹¶ä¸ä¼šå ç”¨å¤„ç†å™¨èµ„æºã€‚å½“é˜»å¡å¼1Oæ“ä½œå®Œæˆåï¼Œæˆ–è€…çº¿ç¨‹è·å¾—äº†å…¶ç”³è¯·çš„èµ„æºï¼Œ è¯¥çº¿ç¨‹çš„çŠ¶æ€åˆå¯ä»¥è½¬æ¢ä¸ºRUNNABLEã€‚</p> <h3 id="waiting"><a href="#waiting" class="header-anchor">#</a> WAITING</h3> <p>ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†æŸäº›ç‰¹å®šæ–¹æ³•ä¹‹åï¼Œå°±ä¼šå¤„äºè¿™ç§ç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡Œå¦å¤–ä¸€äº›ç‰¹å®šæ“ä½œçš„çŠ¶æ€ã€‚ èƒ½å¤Ÿä½¿å…¶<code>æ‰§è¡Œçº¿ç¨‹</code>å˜æ›´ä¸ºWAITINGçŠ¶æ€çš„æ–¹æ³•åŒ…æ‹¬ï¼šObject.wait()ã€Thread.join()å’ŒLockSupport.park(Object)ã€‚ èƒ½å¤Ÿä½¿ç›¸åº”çº¿ç¨‹ä»WAITINGå˜æ›´ä¸ºRUNNABLEçš„å¯¹åº”æ–¹æ³•åŒ…æ‹¬ï¼šObject.notify()ã€notifyAll()å’ŒLockSupport.unpark(Objec)</p> <h3 id="timed-waiting"><a href="#timed-waiting" class="header-anchor">#</a> TIMED WAITING</h3> <p>è¯¥çŠ¶æ€å’ŒWAITINGç±»ä¼¼ï¼Œå·®åˆ«åœ¨äºå¤„äºè¯¥çŠ¶æ€çš„çº¿ç¨‹å¹¶éæ— é™åˆ¶åœ°ç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡Œç‰¹å®šæ“ä½œï¼Œè€Œæ˜¯å¤„äºå¸¦æœ‰æ—¶é—´é™åˆ¶çš„ç­‰å¾…çŠ¶æ€ã€‚ å½“å…¶ä»–çº¿ç¨‹æ²¡æœ‰åœ¨æŒ‡å®šæ—¶é—´å†…æ‰§è¡Œè¯¥çº¿ç¨‹æ‰€æœŸæœ›çš„ç‰¹å®šæ“ä½œæ—¶ï¼Œè¯¥çº¿ç¨‹çš„çŠ¶æ€è‡ªåŠ¨è½¬æ¢ä¸ºRUNNABLEã€‚</p> <h3 id="terminated"><a href="#terminated" class="header-anchor">#</a> TERMINATED</h3> <p>å·²ç»æ‰§è¡Œç»“æŸçš„çº¿ç¨‹å¤„äºè¯¥çŠ¶æ€ã€‚ç”±äºä¸€ä¸ªçº¿ç¨‹å®ä¾‹åªèƒ½å¤Ÿè¢«å¯åŠ¨ä¸€æ¬¡ï¼Œå› æ­¤ä¸€ä¸ªçº¿ç¨‹ä¹Ÿåªå¯èƒ½æœ‰ä¸€æ¬¡å¤„äºè¯¥çŠ¶æ€ã€‚ Thread.run()æ­£å¸¸è¿”å›æˆ–è€…ç”±äºæŠ›å‡ºå¼‚å¸¸è€Œæå‰ç»ˆæ­¢éƒ½ä¼šå¯¼è‡´ç›¸åº”çº¿ç¨‹å¤„äºè¯¥çŠ¶æ€ã€‚</p> <p>å½“çº¿ç¨‹æ‰§â¾ wait() â½…æ³•ä¹‹åï¼Œçº¿ç¨‹è¿›â¼Š WAITINGï¼ˆç­‰å¾…ï¼‰ çŠ¶æ€ã€‚è¿›â¼Šç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹éœ€è¦ä¾é å…¶ä»– çº¿ç¨‹çš„é€šçŸ¥æ‰èƒ½å¤Ÿè¿”å›åˆ°è¿â¾çŠ¶æ€ï¼Œâ½½ TIME_WAITING(è¶…æ—¶ç­‰å¾…) çŠ¶æ€ç›¸å½“äºåœ¨ç­‰å¾…çŠ¶æ€çš„åŸºç¡€ä¸Šå¢åŠ  äº†è¶…æ—¶é™åˆ¶ï¼Œâ½å¦‚é€šè¿‡ sleepï¼ˆlong millisï¼‰ â½…æ³•æˆ– waitï¼ˆlong millisï¼‰ â½…æ³•å¯ä»¥å°† Java çº¿ç¨‹ç½®äº TIMED WAITING çŠ¶æ€ã€‚å½“è¶…æ—¶æ—¶é—´åˆ°è¾¾å Java çº¿ç¨‹å°†ä¼šè¿”å›åˆ° RUNNABLE çŠ¶æ€ã€‚å½“çº¿ç¨‹è°ƒ â½¤åŒæ­¥â½…æ³•æ—¶ï¼Œåœ¨æ²¡æœ‰è·å–åˆ°é”çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹å°†ä¼šè¿›â¼Šåˆ° BLOCKEDï¼ˆé˜»å¡ï¼‰ çŠ¶æ€ã€‚çº¿ç¨‹åœ¨æ‰§â¾ Runnable çš„ run() â½…æ³•ä¹‹åå°†ä¼šè¿›â¼Šåˆ° TERMINATEDï¼ˆç»ˆâ½Œï¼‰ çŠ¶æ€ã€‚</p> <h2 id="çº¿ç¨‹çš„ç›‘è§†"><a href="#çº¿ç¨‹çš„ç›‘è§†" class="header-anchor">#</a> çº¿ç¨‹çš„ç›‘è§†</h2> <p>çœŸå®çš„Javaç³»ç»Ÿè¿è¡Œæ—¶å¾€å¾€æœ‰ä¸Šç™¾ä¸ªçº¿ç¨‹åœ¨è¿è¡Œ,å¦‚æœæ²¡æœ‰ç›¸åº”çš„å·¥å…·èƒ½å¤Ÿå¯¹è¿™ äº›çº¿ç¨‹è¿›è¡Œç›‘è§†,é‚£ä¹ˆè¿™äº›çº¿ç¨‹å¯¹äºæˆ‘ä»¬æ¥è¯´å°±æˆäº†é»‘ç›’ã€‚è€Œæˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿›è¡Œä»£ç  è°ƒè¯•ã€å®šä½é—®é¢˜ç”šè‡³æ˜¯å®šä½çº¿ä¸Šç¯å¢ƒ(ç”Ÿäº§ç¯å¢ƒ)ä¸­çš„é—®é¢˜æ—¶å¾€å¾€éƒ½éœ€è¦å°†çº¿ç¨‹å˜ä¸ºç™½ç›’, å³æˆ‘ä»¬è¦èƒ½å¤ŸçŸ¥é“ç³»ç»Ÿä¸­ç‰¹å®šæ—¶åˆ»å­˜åœ¨å“ªäº›çº¿ç¨‹ã€è¿™äº›çº¿ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ä»¥åŠè¿™äº›çº¿ç¨‹å…· ä½“æ˜¯åœ¨åšä»€ä¹ˆäº‹æƒ…è¿™äº›ä¿¡æ¯ã€‚</p> <p>å¯¹çº¿ç¨‹è¿›è¡Œç›‘è§†çš„ä¸»è¦é€”å¾„æ˜¯è·å–å¹¶æŸ¥çœ‹ç¨‹åºçš„<code>çº¿ç¨‹è½¬å‚¨( Thread Dump)</code>ä¸€ä¸ªç¨‹åº çš„çº¿ç¨‹è½¬å‚¨åŒ…å«äº†è·å–è¿™ä¸ªçº¿ç¨‹è½¬å‚¨çš„é‚£ä¸€åˆ»è¯¥ç¨‹åºçš„çº¿ç¨‹ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯åŒ…æ‹¬ç¨‹åºä¸­æœ‰ å“ªäº›çº¿ç¨‹ä»¥åŠè¿™äº›çº¿ç¨‹çš„å…·ä½“ä¿¡æ¯ã€‚Javaç¨‹åºçš„çº¿ç¨‹è½¬å‚¨(å¦‚å›¾14æ‰€ç¤º)åŒ…å«çš„çº¿ç¨‹å…· ä½“ä¿¡æ¯åŒ…æ‹¬çº¿ç¨‹çš„å±æ€§(IDã€åç§°ã€ä¼˜å…ˆçº§ç­‰)ã€ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ã€çº¿ç¨‹çš„è°ƒç”¨æ ˆ( Call stack) ä»¥åŠé”(ç¬¬3ç« ä¼šä»‹ç»è¿™ä¸ªæ¦‚å¿µ)çš„ç›¸å…³ä¿¡æ¯ç­‰ã€‚é€šè¿‡æŸ¥çœ‹è°ƒç”¨æ ˆæˆ‘ä»¬å°±èƒ½å¤Ÿäº†è§£çº¿ç¨‹çš„ æ‰§è¡Œæƒ…å†µ(å…·ä½“åœ¨å¹²äº›ä»€ä¹ˆ)ã€‚</p> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/Java-MultiThread-1/çº¿ç¨‹è½¬å‚¨ç¤ºä¾‹.png" alt="çº¿ç¨‹è½¬å‚¨ç¤ºä¾‹"></p> <h3 id="è·å–æ–¹æ³•"><a href="#è·å–æ–¹æ³•" class="header-anchor">#</a> è·å–æ–¹æ³•</h3> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/Java-MultiThread-1/è·å–çº¿ç¨‹è½¬å‚¨æ–¹æ³•.png" alt="è·å–çº¿ç¨‹è½¬å‚¨æ–¹æ³•"></p> <h3 id="jmc"><a href="#jmc" class="header-anchor">#</a> JMC</h3> <p>JMCæ‰“å¼€æ€§èƒ½æ—¥å¿—åï¼Œä¸»è¦åŒ…æ‹¬7éƒ¨åˆ†æ€§èƒ½æŠ¥å‘Šï¼Œåˆ†åˆ«æ˜¯ä¸€èˆ¬ä¿¡æ¯ã€å†…å­˜ã€ä»£ç ã€çº¿ç¨‹ã€I/Oã€ç³»ç»Ÿã€äº‹ä»¶ã€‚å…¶ä¸­ï¼Œå†…å­˜ã€ä»£ç ã€çº¿ç¨‹åŠI/Oæ˜¯ç³»ç»Ÿåˆ†æçš„ä¸»è¦éƒ¨åˆ†</p> <p>å‚è€ƒ</p> <blockquote><p><a href="https://www.cnblogs.com/duanxz/p/8533174.html" target="_blank" rel="noopener noreferrer">Javaæ€§èƒ½è°ƒä¼˜ï¼šåˆ©ç”¨JMCåˆ†ææ€§èƒ½<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="å¤šçº¿ç¨‹ç¼–ç¨‹"><a href="#å¤šçº¿ç¨‹ç¼–ç¨‹" class="header-anchor">#</a> å¤šçº¿ç¨‹ç¼–ç¨‹</h2> <h3 id="å¥½å¤„åå¤„"><a href="#å¥½å¤„åå¤„" class="header-anchor">#</a> å¥½å¤„åå¤„</h3> <p>å¥½å¤„</p> <ol><li>æé«˜ç³»ç»Ÿçš„ååç‡</li> <li>æé«˜å“åº”æ€§</li> <li>å……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨èµ„æº</li> <li>æœ€å°åŒ–å¯¹ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨</li> <li>ç®€åŒ–ç¨‹åºçš„ç»“æ„</li></ol> <p>åå¤„</p> <ol><li>çº¿ç¨‹å®‰å…¨</li> <li>çº¿ç¨‹æ´»æ€§
<ol><li>æ­»é”</li> <li>æ´»é”ï¼šä¸€ä¸ªçº¿ç¨‹ä¸€ç›´åœ¨å°è¯•æŸä¸ªæ“ä½œä½†å°±æ˜¯æ²¡æœ‰è¿›å±•</li></ol></li> <li>ä¸Šä¸‹æ–‡åˆ‡æ¢
<ol><li>è¿™æ˜¯å±äºé¢å¤–çš„èµ„æºæ¶ˆè€—</li></ol></li> <li>å¯é æ€§</li></ol> <h2 id="ä¸²è¡Œ-å¹¶å‘-å¹¶è¡Œ"><a href="#ä¸²è¡Œ-å¹¶å‘-å¹¶è¡Œ" class="header-anchor">#</a> ä¸²è¡Œ | å¹¶å‘ | å¹¶è¡Œ</h2> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/Java-MultiThread-1/ä¸²è¡Œ|å¹¶å‘|å¹¶è¡Œ.jpg" alt="ä¸²è¡Œ,å¹¶å‘å’Œå¹¶è¡Œ"></p> <h3 id="ä¸²è¡Œ-sequential"><a href="#ä¸²è¡Œ-sequential" class="header-anchor">#</a> ä¸²è¡Œ(Sequential)</h3> <p>å…ˆå¼€å§‹åšäº‹æƒ…Aï¼Œå¾…å…¶å®Œæˆä¹‹åå†å¼€å§‹åšäº‹æƒ…Bï¼Œä¾æ¬¡ç±»æ¨ï¼Œç›´åˆ°äº‹æƒ…Cå®Œæˆã€‚è¿™å®é™…ä¸Šé¡ºåºé€ä¸€å®Œæˆå‡ ä»¶äº‹æƒ…ï¼Œåªéœ€è¦æŠ•å…¥ä¸€ä¸ªäººã€‚ åœ¨è¿™ç§æ–¹å¼ä¸‹3ä»¶äº‹æƒ…æ€»å…±è€—æ—¶35(15+10+10)åˆ†é’Ÿã€‚</p> <h3 id="å¹¶å‘-concurrent"><a href="#å¹¶å‘-concurrent" class="header-anchor">#</a> å¹¶å‘(Concurrent)</h3> <p>è¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥åªæŠ•å…¥ä¸€ä¸ªäººï¼Œè¿™ä¸ªäººå…ˆå¼€å§‹åšäº‹æƒ…Aï¼Œäº‹æƒ…Açš„å‡†å¤‡æ´»åŠ¨åšå¥½å(æ­¤æ—¶æ¶ˆè€—äº†5åˆ†é’Ÿ)ï¼Œ åœ¨ç­‰å¾…äº‹æƒ…Aå®Œæˆçš„è¿™æ®µæ—¶é—´å†…ä»–å¼€å§‹åšäº‹æƒ…Bï¼Œä¸ºäº‹æƒ…Bçš„å‡†å¤‡æ´»åŠ¨èŠ±äº†2åˆ†é’Ÿä¹‹åï¼Œåœ¨ç­‰å¾…äº‹æƒ…Bå®Œæˆçš„è¿™æ®µæ—¶é—´å†…ä»–å¼€å§‹åšäº‹æƒ…Cï¼Œ ç›´åˆ°10åˆ†é’Ÿä¹‹åäº‹æƒ…Cå®Œæˆã€‚è¿™æ•´ä¸ªè¿‡ç¨‹å®é™…ä¸Šæ˜¯ä»¥äº¤æ›¿çš„æ–¹å¼åˆ©ç”¨ç­‰å¾…æŸä»¶äº‹æƒ…å®Œæˆçš„æ—¶é—´æ¥åšå…¶ä»–äº‹æƒ…ï¼Œ åœ¨è¿™ç§æ–¹å¼ä¸‹3ä»¶äº‹æƒ…æ€»å…±è€—æ—¶17(5+2+10)åˆ†é’Ÿï¼Œè¿™æ¯”ä¸²è¡Œæ–¹å¼èŠ‚çº¦äº†ä¸€åŠå¤šçš„æ—¶é—´ã€‚</p> <h3 id="å¹¶è¡Œ-parallel"><a href="#å¹¶è¡Œ-parallel" class="header-anchor">#</a> å¹¶è¡Œ(Parallel)</h3> <p>è¿™ç§æ–¹å¼éœ€è¦æŠ•å…¥3ä¸ªäººï¼Œæ¯ä¸ªäººè´Ÿè´£å®Œæˆå…¶ä¸­ä¸€ä»¶äº‹æƒ…ï¼Œè¿™3ä¸ªäººåœ¨åŒä¸€æ—¶åˆ»å¼€å§‹é½å¤´å¹¶è¿›åœ°å®Œæˆè¿™äº›äº‹æƒ…ã€‚ åœ¨è¿™ç§æ–¹å¼ä¸‹3ä»¶äº‹æƒ…æ€»å…±è€—æ—¶15åˆ†é’Ÿ(å–å†³äºè€—æ—¶æœ€é•¿çš„é‚£ä»¶äº‹æƒ…æ‰€éœ€çš„æ—¶é—´)ï¼Œæ¯”å¹¶å‘çš„æ–¹å¼èŠ‚çº¦äº†2åˆ†é’Ÿçš„æ—¶é—´ã€‚</p> <h2 id="ç«æ€"><a href="#ç«æ€" class="header-anchor">#</a> ç«æ€</h2> <p>ç«æ€æ˜¯æŒ‡<code>è®¡ç®—çš„æ­£ç¡®æ€§</code>ä¾èµ–äº<code>ç›¸å¯¹æ—¶é—´é¡ºåº</code>æˆ–è€…<code>çº¿ç¨‹çš„äº¤é”™</code>ã€‚ç«æ€å¾€å¾€ä¼´éšç€è¯»å–è„æ•°æ®é—®é¢˜(å³è¯»å–åˆ°ä¸€ä¸ªè¿‡æ—¶çš„æ•°æ®)ï¼Œ ä»¥åŠä¸¢å¤±æ›´æ–°é—®é¢˜(å³ä¸€ä¸ªçº¿ç¨‹å¯¹æ•°æ®æ‰€åšçš„æ›´æ–°æ²¡æœ‰ä½“ç°åœ¨åç»­å…¶ä»–çº¿ç¨‹å¯¹è¯¥æ•°æ®çš„è¯»å–ä¸Š)ã€‚</p> <blockquote><p>ç«æ€ä¸ä¸€å®šå°±å¯¼è‡´è®¡ç®—ç»“æœçš„ä¸æ­£ç¡®,å®ƒåªæ˜¯ä¸æ’é™¤è®¡ç®—ç»“æœæ—¶è€Œæ­£ç¡®æ—¶è€Œé”™è¯¯çš„å¯èƒ½ã€‚</p></blockquote> <h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="header-anchor">#</a> ä¸¾ä¾‹</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">IndexGen</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> index<span class="token punctuation">;</span>
 
        <span class="token keyword">int</span> <span class="token function">nextIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> index<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">IndexGen</span> indexGen <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexGen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> visited <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Thread</span><span class="token punctuation">&gt;</span></span> threads <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            threads<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> visited<span class="token punctuation">[</span>indexGen<span class="token punctuation">.</span><span class="token function">nextIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        threads<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token operator">::</span><span class="token function">start</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Thread</span> thread <span class="token operator">:</span> threads<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            thread<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\t&quot;</span><span class="token punctuation">,</span> visited<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>å‚è€ƒä¸Šè¿°ç¨‹åºï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ç™¾ä¸ªçº¿ç¨‹ï¼Œæ¯æ¬¡é€šè¿‡IndexGenè·å–ä¸‹ä¸€ä¸ªindexï¼Œå¹¶å°†å…¶è®¿é—®æ¬¡æ•°åŠ ä¸€ã€‚æˆ‘ä»¬æœŸæœ›çš„ç»“æœæ˜¯æ¯ä¸ªindexéƒ½åªè¢«è®¿é—®ä¸€æ¬¡ï¼Œ ä½†å¤šæ¬¡è¿è¡Œåï¼Œå´å‘ç°å¯èƒ½å‡ºç°ä¸‹é¢çš„ç»“æœï¼Œå…¶ä¸­ï¼Œ0,62,85è¢«è®¿é—®äº†ä¸¤æ¬¡ï¼Œå¯¼è‡´97,98,99æœªè¢«è®¿é—®ï¼š</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>2	1	1	1	1	1	1	1	1	1	
1	1	1	1	1	1	1	1	1	1	
1	1	1	1	1	1	1	1	1	1	
1	1	1	1	1	1	1	1	1	1	
1	1	1	1	1	1	1	1	1	1	
1	1	2	1	1	1	1	1	1	1	
1	1	1	1	1	1	1	1	1	1	
1	1	1	1	1	2	1	1	1	1	
1	1	1	1	1	1	1	1	1	1	
1	1	1	1	1	1	1	0	0	0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ä¸Šè¿°ä¾‹å­ä¸­ï¼Œä¾ç…§nextIndex()æ–¹æ³•å®ç°çš„é€»è¾‘ï¼Œä¸‹æ ‡æ€»æ˜¯é€’å¢çš„ï¼Œå› æ­¤ä¸åŒçš„çº¿ç¨‹å®ƒä»¬æ‰€â€œæ‹¿åˆ°â€çš„indexä¹Ÿä¸åº”è¯¥ç›¸åŒæ‰å¯¹ã€‚ ä½†ä»ç»“æœæ¥çœ‹ï¼Œä¸åŒçº¿ç¨‹å´â€œæ‹¿åˆ°â€äº†é‡å¤çš„indexï¼Œå³nextIndex()æ‰€è¿”å›çš„ä¸‹æ ‡å€¼é‡å¤äº†ã€‚ä¸”å¦‚æœæˆ‘ä»¬å¤šæ¬¡é‡å¤è¿è¡Œä»£ç ï¼Œæ‰€å¾—åˆ°çš„ç»“æœä¹Ÿä¸å®Œå…¨ç›¸åŒã€‚</p> <p><strong>è¿™ä¸ªç°è±¡è¯´æ˜ï¼Œå½“å¤šä¸ªçº¿ç¨‹åœ¨æ²¡æœ‰é‡‡å–ä»»ä½•æ§åˆ¶æªæ–½çš„æƒ…å†µä¸‹å¹¶å‘åœ°æ›´æ–°ã€è¯»å–åŒä¸€ä¸ªå…±äº«å˜é‡æ—¶ï¼Œæ˜¯ä¸å®‰å…¨çš„ï¼Œå¯èƒ½å‡ºç°æ„æ–™ä¹‹å¤–çš„ç»“æœã€‚</strong></p> <h3 id="åŸå› "><a href="#åŸå› " class="header-anchor">#</a> åŸå› </h3> <p>ä¸Šè¿°ä¾‹å­ä¸­çš„ <code>index++</code> çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªæ“ä½œï¼Œå®é™…ä¸Šç›¸å½“äºå¦‚ä¸‹3ä¸ªæŒ‡ä»¤ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//æŒ‡ä»¤â‘ :å°†å˜é‡indexçš„å€¼ä»å†…å­˜è¯»åˆ°å¯„å­˜å™¨r1</span>
<span class="token function">load</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//æŒ‡ä»¤â‘¡:å°†å¯„å­˜å™¨r1çš„å€¼å¢åŠ 1</span>
<span class="token function">increment</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//æŒ‡ä»¤â‘¢:å°†å¥‡å­˜å™¨r1çš„å†…å®¹å†™å…¥å˜é‡indexæ‰€å¯¹åº”çš„å†…å­˜ç©ºé—´</span>
<span class="token function">store</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><table><thead><tr><th style="text-align:left;"></th> <th style="text-align:left;">thread-0</th> <th style="text-align:left;">thread-1</th> <th style="text-align:left;">thread-2</th></tr></thead> <tbody><tr><td style="text-align:left;">t1</td> <td style="text-align:left;">æœªè¿è¡Œ</td> <td style="text-align:left;">æ‰§è¡Œå…¶ä»–æ“ä½œ</td> <td style="text-align:left;">æ‰§è¡Œå…¶ä»–æ“ä½œ</td></tr> <tr><td style="text-align:left;">t2</td> <td style="text-align:left;">æ‰§è¡Œå…¶ä»–æ“ä½œ</td> <td style="text-align:left;">[index=0]æ‰§è¡ŒæŒ‡ä»¤â‘ </td> <td style="text-align:left;">[index=0]æ‰§è¡ŒæŒ‡ä»¤â‘ </td></tr> <tr><td style="text-align:left;">t3</td> <td style="text-align:left;">æ‰§è¡Œå…¶ä»–æ“ä½œ</td> <td style="text-align:left;">[r1=0]æ‰§è¡ŒæŒ‡ä»¤â‘¡</td> <td style="text-align:left;">[r1=0]æ‰§è¡ŒæŒ‡ä»¤â‘¡</td></tr> <tr><td style="text-align:left;">t4</td> <td style="text-align:left;">[index=0]æ‰§è¡ŒæŒ‡ä»¤â‘ </td> <td style="text-align:left;">[r1=1][index=0]æ‰§è¡ŒæŒ‡ä»¤â‘¢</td> <td style="text-align:left;">[r1=1][index=0]æ‰§è¡ŒæŒ‡ä»¤â‘¢</td></tr> <tr><td style="text-align:left;">t5</td> <td style="text-align:left;">[r1=0]æ‰§è¡ŒæŒ‡ä»¤â‘¡</td> <td style="text-align:left;">[index=1]æ‰§è¡Œå…¶ä»–æ“ä½œ</td> <td style="text-align:left;">[index=1]æ‰§è¡Œå…¶ä»–æ“ä½œ</td></tr> <tr><td style="text-align:left;">t6</td> <td style="text-align:left;">[r1=1][index=0]æ‰§è¡ŒæŒ‡ä»¤â‘¢</td> <td style="text-align:left;">è¿è¡Œç»“æŸ</td> <td style="text-align:left;">è¿è¡Œç»“æŸ</td></tr> <tr><td style="text-align:left;">t7</td> <td style="text-align:left;">[index=1]æ‰§è¡Œå…¶ä»–æ“ä½œ</td> <td style="text-align:left;">è¿è¡Œç»“æŸ</td> <td style="text-align:left;">è¿è¡Œç»“æŸ</td></tr></tbody></table> <h3 id="ç«æ€çš„æ¨¡å¼-æ¡ä»¶"><a href="#ç«æ€çš„æ¨¡å¼-æ¡ä»¶" class="header-anchor">#</a> ç«æ€çš„æ¨¡å¼/æ¡ä»¶</h3> <p>ä»ä¸Šè¿°ç«æ€å…¸å‹å®ä¾‹ä¸­æˆ‘ä»¬å¯ä»¥æç‚¼å‡ºç«æ€çš„ä¸¤ç§æ¨¡å¼</p> <div class="custom-block info"><p class="custom-block-title">Info</p> <ul><li><strong>read-modify-write(è¯»-æ”¹-å†™)</strong>ï¼šè¯»å–ä¸ªå…±äº«å˜é‡çš„å€¼(read)ï¼Œç„¶åæ ¹æ®è¯¥å€¼åšä¸€äº›è®¡ç®—(modify)ï¼Œæ¥ç€æ›´æ–°è¯¥å…±äº«å˜é‡çš„å€¼(write)</li> <li><strong>check-then-act(æ£€æµ‹-æ‰§è¡Œ)</strong>ï¼šè¯»å–(read)æŸä¸ªå…±äº«å˜é‡çš„å€¼ï¼Œæ ¹æ®è¯¥å˜é‡çš„å€¼(å¦‚ifè¯­å¥)å†³å®šä¸‹ä¸€æ­¥çš„åŠ¨ä½œ(act)æ˜¯ä»€ä¹ˆã€‚</li></ul></div> <p>ä»ä¸Šè¿°åˆ†æä¸­æˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºç«æ€äº§ç”Ÿçš„ä¸€èˆ¬æ¡ä»¶ã€‚è®¾O1å’ŒO2æ˜¯å¹¶å‘è®¿é—®å…±äº«å˜é‡Vçš„ä¸¤ä¸ªæ“ä½œ,è¿™ä¸¤ä¸ªæ“ä½œå¹¶ééƒ½æ˜¯è¯»æ“ä½œã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡ŒO1æœŸé—´(å¼€å§‹æ‰§è¡Œè€Œæœªæ‰§è¡Œç»“æŸ)å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡ŒO2,<strong>é‚£ä¹ˆæ— è®ºO2æ˜¯åœ¨è¯»å–è¿˜æ˜¯æ›´æ–°Véƒ½ä¼šå¯¼è‡´ç«æ€</strong>ã€‚</p> <p>ä»è¿™ä¸ªè§’åº¦æ¥çœ‹,ç«æ€å¯ä»¥è¢«çœ‹ä½œè®¿é—®(è¯»å–ã€æ›´æ–°)åŒä¸€ç»„å…±äº«å˜é‡çš„å¤šä¸ªçº¿ç¨‹æ‰€æ‰§è¡Œçš„æ“ä½œç›¸äº’äº¤é”™( Interleave),æ­¤å¦‚ä¸€ä¸ªçº¿ç¨‹è¯»å–å…±äº«å˜é‡å¹¶ä»¥è¯¥å…±äº«å˜é‡ä¸ºåŸºç¡€è¿›è¡Œè®¡ç®—</p> <blockquote><p>å¯¹äºæ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ï¼Œç”±äºæ–¹æ³•æ ˆæ˜¯çº¿ç¨‹ç§æœ‰ï¼Œä¸ä¼šäº§ç”Ÿç«æ€</p></blockquote> <h2 id="çº¿ç¨‹å®‰å…¨æ€§"><a href="#çº¿ç¨‹å®‰å…¨æ€§" class="header-anchor">#</a> çº¿ç¨‹å®‰å…¨æ€§</h2> <p>ä¸€èˆ¬è€Œè¨€ï¼Œå¦‚æœä¸€ä¸ªç±»åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹èƒ½å¤Ÿè¿ä½œæ­£å¸¸ï¼Œå¹¶ä¸”åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚æœä½¿ç”¨æ–¹ä¸å¿…åšä»»ä½•æ”¹å˜çš„æƒ…å†µä¸‹ä¹Ÿèƒ½è¿ä½œæ­£å¸¸ï¼Œ é‚£ä¹ˆæˆ‘ä»¬å°±ç§°å…¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œç›¸åº”åœ°æˆ‘ä»¬ç§°è¿™ä¸ªç±»å…·æœ‰çº¿ç¨‹å®‰å…¨æ€§ã€‚</p> <p>çº¿ç¨‹å®‰å…¨é—®é¢˜åŒ…æ‹¬ä¸‰ä¸ªæ–¹é¢</p> <div class="custom-block info"><p class="custom-block-title">Info</p> <ul><li><strong>åŸâ¼¦æ€§</strong> : â¼€ä¸ªçš„æ“ä½œæˆ–è€…å¤šæ¬¡æ“ä½œï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œå…¨éƒ¨éƒ½å¾—åˆ°æ‰§â¾å¹¶ä¸”ä¸ä¼šæ”¶åˆ°ä»»ä½•å› ç´ çš„ â¼²æ‰°â½½ä¸­æ–­ï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½æ‰§â¾ï¼Œè¦ä¹ˆéƒ½ä¸æ‰§â¾ã€‚ <strong>synchronized å¯ä»¥ä¿è¯ä»£ç â½šæ®µçš„åŸâ¼¦æ€§ã€‚</strong></li> <li><strong>å¯â»…æ€§</strong> ï¼šå½“â¼€ä¸ªå˜é‡å¯¹å…±äº«å˜é‡è¿›â¾äº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå¦å¤–çš„çº¿ç¨‹éƒ½æ˜¯â½´å³å¯ä»¥çœ‹åˆ°ä¿®æ”¹åçš„æœ€æ–°å€¼ã€‚ <strong>volatile å…³é”®å­—å¯ä»¥ä¿è¯å…±äº«å˜é‡çš„å¯â»…æ€§ã€‚</strong></li> <li><strong>æœ‰åºæ€§</strong> ï¼šä»£ç åœ¨æ‰§â¾çš„è¿‡ç¨‹ä¸­çš„å…ˆåé¡ºåºï¼ŒJava åœ¨ç¼–è¯‘å™¨ä»¥åŠè¿â¾æœŸé—´çš„ä¼˜åŒ–ï¼Œä»£ç çš„æ‰§â¾é¡ºåºæœªå¿…å°±æ˜¯ç¼–å†™ä»£ç æ—¶å€™çš„é¡ºåºã€‚ <strong>volatile å…³é”®å­—å¯ä»¥ç¦â½ŒæŒ‡ä»¤è¿›â¾é‡æ’åºä¼˜åŒ–ã€‚</strong></li></ul></div> <h3 id="ä¸‰å¤§ç‰¹æ€§-åŸå­æ€§-automicity"><a href="#ä¸‰å¤§ç‰¹æ€§-åŸå­æ€§-automicity" class="header-anchor">#</a> ä¸‰å¤§ç‰¹æ€§ï¼šåŸå­æ€§ï¼ˆAutomicityï¼‰</h3> <p>åŸå­çš„å­—é¢æ„æ€æ˜¯ä¸å¯åˆ†å‰²çš„ã€‚å¯¹äºæ¶‰åŠå…±äº«å˜é‡è®¿é—®çš„æ“ä½œï¼Œè‹¥è¯¥æ“ä½œä»å…¶æ‰§è¡Œçº¿ç¨‹ä»¥å¤–çš„ä»»æ„çº¿ç¨‹æ¥çœ‹æ˜¯ä¸å¯åˆ†å‰²çš„ï¼Œ é‚£ä¹ˆè¯¥æ“ä½œå°±æ˜¯åŸå­æ“ä½œï¼Œç›¸åº”åœ°æˆ‘ä»¬ç§°è¯¥æ“ä½œå…·æœ‰åŸå­æ€§ã€‚</p> <p>è®¸å¤šèµ„æ–™éƒ½ä¼šæåŠåŸå­æ“ä½œçš„å®šä¹‰ä¸­çš„â€œä¸å¯åˆ†å‰²â€,ä½†æ˜¯å¾ˆå°‘æœ‰èµ„æ–™ä¼šå¯¹å…¶å«ä¹‰åš è¿›ä¸€æ­¥çš„è§£é‡Šã€‚è€Œå¼„æ¸…æ¥šâ€œä¸å¯åˆ†å‰²â€çš„å…·ä½“å«ä¹‰æ˜¯ç†è§£åŸå­æ€§çš„å…³é”®æ‰€åœ¨ã€‚æ‰€è°“â€œä¸å¯ åˆ†å‰²â€,å…¶ä¸­ä¸€ä¸ªå«ä¹‰æ˜¯æŒ‡è®¿é—®(è¯»ã€å†™)æŸä¸ªå…±äº«å˜é‡çš„æ“ä½œä»å…¶æ‰§è¡Œçº¿ç¨‹ä»¥å¤–çš„ä»»ä½• çº¿ç¨‹æ¥çœ‹,è¯¥æ“ä½œè¦ä¹ˆ<code>å·²ç»æ‰§è¡Œç»“æŸ</code>è¦ä¹ˆ<code>å°šæœªå‘ç”Ÿ</code>,å³å…¶ä»–çº¿ç¨‹ä¸ä¼šâ€œçœ‹åˆ°â€è¯¥æ“ä½œæ‰§è¡Œ äº†éƒ¨åˆ†çš„ä¸­é—´æ•ˆæœã€‚</p> <blockquote><p>åŸå­æ€§åªæœ‰åœ¨æ“ä½œ<code>å…±äº«å˜é‡</code>æˆ–<code>å¤šçº¿ç¨‹</code>çš„æƒ…å†µä¸‹æ‰æœ‰æ„ä¹‰</p></blockquote> <h4 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="header-anchor">#</a> å®ç°æ–¹å¼</h4> <p>æ€»çš„æ¥è¯´ï¼ŒJavaä¸­æœ‰ä¸¤ç§æ–¹å¼æ¥å®ç°åŸå­æ€§ï¼š<code>é”(Lock)</code>å’Œ<code>CAS(Compare-And-Swap)</code>æŒ‡ä»¤ã€‚</p> <p><strong>é”ï¼ˆLockï¼‰</strong></p> <div class="custom-block info"><p class="custom-block-title">Info</p> <p>é”å…·æœ‰<code>æ’ä»–æ€§</code>ï¼Œå³å®ƒèƒ½å¤Ÿä¿éšœä¸€ä¸ªå…±äº«å˜é‡åœ¨ä»»æ„ä¸€ä¸ªæ—¶åˆ»åªèƒ½å¤Ÿè¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œ è¿™å°±æ’é™¤äº†å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è®¿é—®åŒä¸€ä¸ªå…±äº«å˜é‡è€Œå¯¼è‡´å¹²æ‰°ä¸å†²çªçš„å¯èƒ½ï¼Œå³æ¶ˆé™¤äº†ç«æ€ã€‚</p></div> <p><strong>CAS</strong></p> <div class="custom-block info"><p class="custom-block-title">Info</p> <p>CASæŒ‡ä»¤å®ç°åŸå­æ€§çš„æ–¹å¼ä¸é”å®ç°åŸå­æ€§çš„æ–¹å¼å®è´¨ä¸Šæ˜¯ç›¸åŒçš„ï¼Œå·®åˆ«åœ¨äº<code>é”</code>é€šå¸¸æ˜¯åœ¨<code>è½¯ä»¶</code>è¿™ä¸€å±‚æ¬¡å®ç°çš„ï¼Œ è€Œ<code>CAS</code>æ˜¯ç›´æ¥åœ¨<code>ç¡¬ä»¶ï¼ˆå¤„ç†å™¨å’Œå†…å­˜ï¼‰</code>è¿™ä¸€å±‚æ¬¡å®ç°çš„ï¼Œå®ƒå¯ä»¥è¢«çœ‹ä½œ<code>â€œç¡¬ä»¶é”â€</code>ã€‚</p></div> <h4 id="åŸºæœ¬æ•°æ®ç±»å‹åŸå­æ€§"><a href="#åŸºæœ¬æ•°æ®ç±»å‹åŸå­æ€§" class="header-anchor">#</a> åŸºæœ¬æ•°æ®ç±»å‹åŸå­æ€§</h4> <p>åœ¨Javaè¯­è¨€ä¸­ï¼Œ<code>long</code>å‹å’Œ<code>double</code>å‹ä»¥å¤–çš„ä»»ä½•ç±»å‹çš„å˜é‡çš„å†™æ“ä½œéƒ½æ˜¯åŸå­æ“ä½œï¼ŒåŒ…æ‹¬ï¼šbyteã€booleanã€shortã€charã€foatã€intå’Œå¼•ç”¨å‹å˜é‡ï¼Œlongå’Œdoubleçš„è¯»å†™æ˜¯<code>åˆ†å¼€ä¸¤ä¸ª32ä½æ“ä½œ</code>çš„ï¼Œä¸ä¿è¯åŸå­æ€§ï¼Œ</p> <p>å¯¹long/doubleå‹å˜é‡çš„å†™æ“ä½œç”±äºJavaè¯­è¨€è§„èŒƒå¹¶ä¸ä¿éšœå…¶å…·æœ‰åŸå­æ€§ï¼Œå› æ­¤åœ¨å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®åŒä¸€long/doubleå‹å˜é‡çš„æƒ…å†µä¸‹ï¼Œ ä¸€ä¸ªçº¿ç¨‹å¯èƒ½ä¼šè¯»å–åˆ°å…¶ä»–çº¿ç¨‹æ›´æ–°è¯¥å˜é‡çš„â€œä¸­é—´ç»“æœâ€ã€‚è¿™æ˜¯å› ä¸ºJavaä¸­çš„long/doubleå‹å˜é‡ä¼šå ç”¨64ä½çš„å­˜å‚¨ç©ºé—´ï¼Œ è€Œ32ä½çš„Javaè™šæ‹Ÿæœºå¯¹è¿™ç§å˜é‡çš„å†™æ“ä½œå¯èƒ½ä¼šè¢«åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤æ¥å®æ–½ï¼Œæ¯”å¦‚å…ˆå†™ä½32ä½ï¼Œå†å†™é«˜32ä½ã€‚ é‚£ä¹ˆï¼Œåœ¨å¤šä¸ªçº¿ç¨‹è¯•å›¾å…±äº«åŒä¸€ä¸ªè¿™æ ·çš„å˜é‡æ—¶å°±å¯èƒ½å‡ºç°ä¸€ä¸ªçº¿ç¨‹åœ¨å†™é«˜32ä½çš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨å†™ä½32ä½çš„æƒ…å½¢ã€‚</p> <p>Javaè¯­è¨€ä¸­é’ˆå¯¹ä»»ä½•å˜è¶¾çš„è¯»æ“ä½œéƒ½æ˜¯åŸå­æ“ä½œã€‚</p> <h3 id="ä¸‰å¤§ç‰¹æ€§-å¯è§æ€§-visibility"><a href="#ä¸‰å¤§ç‰¹æ€§-å¯è§æ€§-visibility" class="header-anchor">#</a> ä¸‰å¤§ç‰¹æ€§ï¼šå¯è§æ€§ï¼ˆVisibilityï¼‰</h3> <p>åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹æŸä¸ªå…±äº«å˜é‡è¿›è¡Œæ›´æ–°ä¹‹åï¼Œåç»­è®¿é—®è¯¥å˜é‡çš„çº¿ç¨‹å¯èƒ½æ— æ³•ç«‹åˆ»è¯»å–åˆ°è¿™ä¸ªæ›´æ–°çš„ç»“æœï¼Œ ç”šè‡³æ°¸è¿œä¹Ÿæ— æ³•è¯»å–åˆ°è¿™ä¸ªæ›´æ–°çš„ç»“æœã€‚</p> <p>å¦‚æœä¸€ä¸ªçº¿ç¨‹å¯¹æŸä¸ªå…±äº«å˜é‡è¿›è¡Œæ›´æ–°ä¹‹åï¼Œåç»­è®¿é—®è¯¥å˜é‡çš„çº¿ç¨‹å¯ä»¥è¯»å–åˆ°è¯¥æ›´æ–°çš„ç»“æœï¼Œ é‚£ä¹ˆæˆ‘ä»¬å°±ç§°è¿™ä¸ªçº¿ç¨‹å¯¹è¯¥å…±äº«å˜é‡çš„æ›´æ–°å¯¹å…¶ä»–çº¿ç¨‹å¯è§ï¼Œå¦åˆ™æˆ‘ä»¬å°±ç§°è¿™ä¸ªçº¿ç¨‹å¯¹è¯¥å…±äº«å˜é‡çš„æ›´æ–°å¯¹å…¶ä»–çº¿ç¨‹ä¸å¯è§ã€‚</p> <p>å¤šçº¿ç¨‹ç¨‹åºåœ¨å¯è§æ€§æ–¹é¢å­˜åœ¨é—®é¢˜æ„å‘³ç€æŸäº›çº¿ç¨‹è¯»å–åˆ°äº†æ—§æ•°æ®(Stale Data)ï¼Œè€Œè¿™å¯èƒ½å¯¼è‡´ç¨‹åºå‡ºç°æˆ‘ä»¬æ‰€ä¸æœŸæœ›çš„ç»“æœã€‚</p> <h4 id="å¯„å­˜å™¨å’Œé«˜é€Ÿç¼“å­˜å¸¦å¯¼è‡´çš„ä¸å¯è§"><a href="#å¯„å­˜å™¨å’Œé«˜é€Ÿç¼“å­˜å¸¦å¯¼è‡´çš„ä¸å¯è§" class="header-anchor">#</a> å¯„å­˜å™¨å’Œé«˜é€Ÿç¼“å­˜å¸¦å¯¼è‡´çš„ä¸å¯è§</h4> <p>ç¨‹åºä¸­çš„å˜é‡å¯èƒ½ä¼šè¢«åˆ†é…åˆ°<code>å¯„å­˜å™¨(Register)</code>è€Œä¸æ˜¯<code>ä¸»å†…å­˜</code>ä¸­è¿›è¡Œå­˜å‚¨ï¼Œæ¯ä¸ª<code>å¤„ç†å™¨</code>éƒ½æœ‰å…¶è‡ªå·±çš„<code>å¯„å­˜å™¨</code>ï¼Œ è€Œä¸€ä¸ª<code>å¤„ç†å™¨</code>æ— æ³•è¯»å–å¦å¤–ä¸€ä¸ª<code>å¤„ç†å™¨</code>ä¸Šçš„<code>å¯„å­˜å™¨</code>ä¸­çš„å†…å®¹ã€‚å› æ­¤ï¼Œå¦‚æœ<code>ä¸¤ä¸ªçº¿ç¨‹</code>åˆ†åˆ«è¿è¡Œåœ¨ä¸åŒçš„<code>å¤„ç†å™¨</code>ä¸Šï¼Œ ä¸”è¿™ä¸¤ä¸ªçº¿ç¨‹æ‰€å…±äº«çš„å˜é‡å´è¢«åˆ†é…åˆ°å¯„å­˜å™¨ä¸Šè¿›è¡Œå­˜å‚¨ï¼Œé‚£ä¹ˆå¯è§æ€§é—®é¢˜å°±ä¼šäº§ç”Ÿã€‚</p> <p>å¦å¤–ï¼Œå³ä¾¿æŸä¸ª<code>å…±äº«å˜é‡</code>æ˜¯è¢«åˆ†é…åˆ°<code>ä¸»å†…å­˜</code>ä¸­è¿›è¡Œå­˜å‚¨çš„ï¼Œä¹Ÿä¸èƒ½ä¿è¯è¯¥å˜é‡çš„å¯è§æ€§ã€‚è¿™æ˜¯å› ä¸ºå¤„ç†å™¨å¯¹ä¸»å†…å­˜çš„è®¿é—®<code>å¹¶ä¸æ˜¯ç›´æ¥è®¿é—®</code>ï¼Œ è€Œæ˜¯é€šè¿‡å…¶<code>é«˜é€Ÿç¼“å­˜ï¼ˆcacheï¼‰å­ç³»ç»Ÿ</code>è¿›è¡Œçš„ã€‚ä¸€ä¸ªå¤„ç†å™¨ä¸Šè¿è¡Œçš„çº¿ç¨‹å¯¹å˜é‡çš„æ›´æ–°å¯èƒ½åªæ˜¯æ›´æ–°åˆ°è¯¥å¤„ç†å™¨çš„<code>å†™ç¼“å†²å™¨</code>ä¸­ï¼Œè¿˜æ²¡æœ‰åˆ°è¾¾è¯¥å¤„ç†å™¨çš„<code>é«˜é€Ÿç¼“å­˜</code>ä¸­ï¼Œ æ›´ä¸ç”¨è¯´åˆ°<code>ä¸»å†…å­˜</code>ä¸­äº†ã€‚è€Œä¸€ä¸ªå¤„ç†å™¨çš„<code>å†™ç¼“å†²å™¨</code>ä¸­çš„å†…å®¹æ— æ³•è¢«å¦å¤–ä¸€ä¸ª<code>å¤„ç†å™¨</code>è¯»å–ï¼Œ å› æ­¤è¿è¡Œåœ¨å¦å¤–ä¸€ä¸ªå¤„ç†å™¨ä¸Šçš„çº¿ç¨‹æ— æ³•çœ‹åˆ°è¿™ä¸ªçº¿ç¨‹å¯¹æŸä¸ªå…±äº«å˜é‡çš„æ›´æ–°ã€‚åŠæ—¶é€šçŸ¥äº†ï¼Œå…¶ä»–å¤„ç†å™¨å¯èƒ½ä»…ä»…å°†è¯¥æ›´æ–°åŠ å…¥åˆ°<code>æ— æ•ˆåŒ–é˜Ÿåˆ—</code>ä¸­å»</p> <blockquote><p>å¤„ç†å™¨å¹¶ä¸æ˜¯ç›´æ¥ä¸ä¸»å†…å­˜(RAM)æ‰“äº¤é“è€Œæ‰§è¡Œå†…å­˜çš„è¯»ã€å†™æ“ä½œ,è€Œæ˜¯é€šè¿‡ å¯„å­˜å™¨( Register)ã€é«˜é€Ÿç¼“å­˜( Cache)å†™ç¼“å†²å™¨( Store Buffer,ä¹Ÿç§° Write Buffer) å’Œæ— æ•ˆåŒ–é˜Ÿåˆ—( Invalidate Queue)ç­‰éƒ¨ä»¶æ‰§è¡Œå†…å­˜çš„è¯»ã€å†™æ“ä½œçš„ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹, è¿™äº›éƒ¨ä»¶ç›¸å½“äºä¸»å†…å­˜çš„å‰¯æœ¬,å› æ­¤æœ¬ä¹¦ä¸ºäº†å™è¿°æ–¹ä¾¿å°†è¿™äº›éƒ¨ä»¶ç»Ÿç§°ä¸ºå¤„ç†å™¨å¯¹ä¸» å†…å­˜çš„ç¼“å­˜,ç®€ç§°å¤„ç†å™¨ç¼“å­˜ã€‚</p></blockquote> <p><strong>è§£å†³æ–¹æ¡ˆ</strong></p> <p><code>ç¼“å­˜ä¸€è‡´æ€§åè®®(Cache Coherence Protocol)</code></p> <p>é€šè¿‡ç¼“å­˜ä¸€è‡´æ€§åè®®å¯ä»¥è®©ä¸€ä¸ªå¤„ç†å™¨æ¥è¯»å–å…¶ä»–å¤„ç†å™¨çš„<code>é«˜é€Ÿç¼“å­˜</code>ä¸­çš„æ•°æ®ï¼Œå¹¶å°†è¯»åˆ°çš„æ•°æ®æ›´æ–°åˆ°è¯¥å¤„ç†å™¨çš„<code>é«˜é€Ÿç¼“å­˜</code>ä¸­ã€‚è¿™ç§ä¸€ä¸ªå¤„ç†å™¨ä»å…¶è‡ªèº«å¤„ç†å™¨ç¼“å­˜ä»¥å¤–çš„å…¶ä»–å­˜å‚¨éƒ¨ä»¶ä¸­è¯»å–æ•°æ®ï¼Œ å¹¶å°†å…¶æ›´æ–°åˆ°è¯¥å¤„ç†å™¨çš„é«˜é€Ÿç¼“å­˜çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<code>ç¼“å­˜åŒæ­¥</code>ã€‚ç›¸åº”åœ°ï¼Œæˆ‘ä»¬ç§°è¿™äº›å­˜å‚¨éƒ¨ä»¶çš„å†…å®¹æ˜¯å¯åŒæ­¥çš„ï¼Œ å¯åŒæ­¥çš„å­˜å‚¨éƒ¨ä»¶åŒ…æ‹¬å¤„ç†å™¨çš„é«˜é€Ÿç¼“å­˜ã€ä¸»å†…å­˜ã€‚</p> <p><code>å†²åˆ·å¤„ç†å™¨ç¼“å­˜</code>ï¼ˆæ›´æ–°åï¼‰</p> <p>ä¸ºäº†ä¿éšœå¯è§æ€§ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ä¸€ä¸ª<code>å¤„ç†å™¨</code>å¯¹<code>å…±äº«å˜é‡</code>æ‰€åšçš„æ›´æ–°æœ€ç»ˆè¢«å†™å…¥è¯¥å¤„ç†å™¨çš„é«˜é€Ÿç¼“å­˜æˆ–è€…ä¸»å†…å­˜ä¸­,è€Œä¸æ˜¯å§‹ç»ˆåœç•™åœ¨å…¶å†™ç¼“å†²å™¨ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º<code>å†²åˆ·å¤„ç†å™¨ç¼“å­˜</code>ã€‚</p> <p><code>åˆ·æ–°å¤„ç†å™¨ç¼“å­˜</code>ï¼ˆè¯»å–æ—¶ï¼‰</p> <p>åŒæ ·ï¼Œä¸ºäº†ä¿éšœå¯è§æ€§ï¼Œä¸€ä¸ª<code>å¤„ç†å™¨</code>åœ¨è¯»å–<code>å…±äº«å˜é‡</code>çš„æ—¶å€™ï¼Œå¦‚æœå…¶ä»–å¤„ç†å™¨åœ¨æ­¤ä¹‹å‰å·²ç»æ›´æ–°äº†è¯¥å˜é‡ï¼Œé‚£ä¹ˆè¯¥å¤„ç†å™¨å¿…é¡»ä»å…¶ä»–å¤„ç†å™¨çš„é«˜é€Ÿç¼“å­˜æˆ–è€…ä¸»å†…å­˜ä¸­ï¼Œå¯¹ç›¸åº”çš„å˜é‡è¿›è¡Œ<code>ç¼“å­˜åŒæ­¥</code>ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º<code>åˆ·æ–°å¤„ç†å™¨ç¼“å­˜</code>ã€‚</p> <h4 id="jitä¼˜åŒ–å¯¼è‡´çš„ä¸å¯è§"><a href="#jitä¼˜åŒ–å¯¼è‡´çš„ä¸å¯è§" class="header-anchor">#</a> JITä¼˜åŒ–å¯¼è‡´çš„ä¸å¯è§</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token comment">/**volatile**/</span> <span class="token keyword">boolean</span> isCanceled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>isCanceled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// System.out.println(&quot;hello&quot;);</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;come here&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        isCanceled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>JITä¸ºäº†ä¼˜åŒ–é¿å…é‡å¤è¯»å–<code>Canceled</code>çš„å€¼ï¼Œä¼šå°†ä»£ç ä¼˜åŒ–ä¸ºä¸å¦‚ä¸‹ä»£ç ç­‰æ•ˆæœçš„æœºå™¨ç ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isCanceled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// System.out.println(&quot;hello&quot;);</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="ä½œç”¨"><a href="#ä½œç”¨" class="header-anchor">#</a> ä½œç”¨</h4> <p><code>volatile</code>è¯¥å…³é”®å­—æ‰€èµ·åˆ°çš„ä¸€ä¸ªä½œç”¨å°±æ˜¯æç¤ºJITç¼–è¯‘å™¨è¢«ä¿®é¥°çš„å˜é‡å¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œä»¥é˜»æ­¢JTç¼–è¯‘å™¨åšå‡ºå¯èƒ½å¯¼è‡´ç¨‹åºè¿è¡Œ<code>ä¸æ­£å¸¸çš„ä¼˜åŒ–</code>ï¼›å¦å¤–ä¸€ä¸ªä½œç”¨å°±æ˜¯è¯»å–ä¸€ä¸ªvolatileå…³é”®å­—ä¿®é¥°çš„å˜é‡ä¼šä½¿ç›¸åº”çš„å¤„ç†å™¨æ‰§è¡Œåˆ·æ–°å¤„ç†å™¨ç¼“å­˜çš„åŠ¨ä½œï¼Œ å†™ä¸ª volatileå…³é”®å­—ä¿®é¥°çš„å˜é‡ä¼šä½¿ç›¸åº”çš„å¤„ç†å™¨æ‰§è¡Œå†²åˆ·å¤„ç†å™¨ç¼“å­˜çš„åŠ¨ä½œï¼Œä»è€Œä¿éšœäº†å¯è§æ€§ã€‚</p> <h4 id="jvmçš„å¯è§æ€§ä¿è¯"><a href="#jvmçš„å¯è§æ€§ä¿è¯" class="header-anchor">#</a> JVMçš„å¯è§æ€§ä¿è¯</h4> <ul><li>Javaè¯­è¨€è§„èŒƒä¿è¯ï¼Œçˆ¶çº¿ç¨‹åœ¨å¯åŠ¨å­çº¿ç¨‹ä¹‹å‰å¯¹å…±äº«å˜é‡çš„æ›´æ–°å¯¹äºå­çº¿ç¨‹æ¥è¯´æ˜¯å¯è§çš„</li> <li>Javaè¯­è¨€è§„èŒƒä¿è¯ï¼Œä¸€ä¸ªçº¿ç¨‹ç»ˆæ­¢åï¼Œè¯¥çº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ›´æ–°å¯¹äºè°ƒç”¨è¯¥çº¿ç¨‹çš„<code>join</code>æ–¹æ³•çš„çº¿ç¨‹è€Œè¨€æ˜¯å¯è§çš„</li></ul> <h4 id="å…¶ä»–é—®é¢˜"><a href="#å…¶ä»–é—®é¢˜" class="header-anchor">#</a> å…¶ä»–é—®é¢˜</h4> <ol><li><p>å¯è§æ€§å¾—ä»¥ä¿éšœï¼Œå¹¶ä¸æ„å‘³ç€ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ›´æ–°çš„æ‰€æœ‰å˜é‡çš„å€¼ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨æŸä¸ªæ—¶åˆ»æ›´æ–°äº†<code>å¤šä¸ªå…±äº«å˜é‡çš„å€¼</code>ï¼Œ é‚£ä¹ˆæ­¤åå…¶ä»–çº¿ç¨‹å†æ¥è¯»å–è¿™äº›å˜é‡æ—¶ï¼Œè¿™äº›çº¿ç¨‹æ‰€è¯»å–åˆ°çš„å˜é‡å€¼æœ‰äº›æ˜¯å…¶ä»–çº¿ç¨‹æ›´æ–°è¿‡çš„å€¼ï¼Œè€Œæœ‰äº›åˆ™å¯èƒ½ä»ç„¶æ˜¯å…¶ä»–çº¿ç¨‹æ›´æ–°ä¹‹å‰çš„å€¼ï¼ˆæ—§å€¼ï¼‰ã€‚</p></li> <li><p>å¦ä¸€æ–¹é¢ï¼Œå¯è§æ€§çš„ä¿éšœä»…ä»…æ„å‘³ç€ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè¯»å–åˆ°å…±äº«å˜é‡çš„<code>ç›¸å¯¹æ–°å€¼</code>ï¼Œè€Œä¸èƒ½ä¿éšœè¯¥çº¿ç¨‹èƒ½å¤Ÿè¯»å–åˆ°ç›¸åº”å˜é‡çš„<code>æœ€æ–°å€¼</code>ã€‚</p></li></ol> <p>ç›¸å¯¹æ–°å€¼</p> <blockquote><p>å¯¹äºä¸€ä¸ªå…±äº«å˜é‡è€Œè¨€ï¼Œä¸€ä¸ªçº¿ç¨‹æ›´æ–°äº†è¯¥å˜é‡çš„å€¼ä¹‹åï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿè¯»å–åˆ°è¿™ä¸ªæ›´æ–°åçš„å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼å°±è¢«ç§°ä¸ºè¯¥å˜é‡çš„ç›¸å¯¹æ–°å€¼ã€‚</p></blockquote> <p>æœ€æ–°å€¼</p> <blockquote><p>å¦‚æœè¯»å–å…±äº«å˜é‡çš„çº¿ç¨‹ï¼Œåœ¨è¯»å–å¹¶ä½¿ç”¨è¯¥å˜é‡çš„æ—¶å€™å…¶ä»–çº¿ç¨‹æ— æ³•æ›´æ–°è¯¥å˜é‡çš„å€¼ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹è¯»å–åˆ°çš„ç›¸å¯¹æ–°å€¼å°±è¢«ç§°ä¸ºè¯¥å˜é‡çš„æœ€æ–°å€¼ã€‚</p></blockquote> <ol start="3"><li>å¯è§æ€§é—®é¢˜æ˜¯å¤šçº¿ç¨‹è¡ç”Ÿå‡ºæ¥çš„é—®é¢˜ï¼Œå®ƒä¸ç¨‹åºçš„ç›®æ ‡è¿è¡Œç¯å¢ƒæ˜¯å•æ ¸å¤„ç†å™¨è¿˜æ˜¯å¤šæ ¸å¤„ç†å™¨æ— å…³ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå•å¤„ç†å™¨ç³»ç»Ÿä¸­å®ç°çš„å¤šçº¿ç¨‹ç¼–ç¨‹ä¹Ÿå¯èƒ½å‡ºç°å¯è§æ€§é—®é¢˜ï¼šåœ¨ç›®æ ‡è¿è¡Œç¯å¢ƒæ˜¯å•å¤„ç†å™¨çš„æƒ…å†µä¸‹ï¼Œ å¤šçº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œå®é™…ä¸Šæ˜¯é€šè¿‡æ—¶é—´ç‰‡åˆ†é…å®ç°çš„ã€‚æ­¤æ—¶ï¼Œè™½ç„¶å¤šä¸ªçº¿ç¨‹æ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªå¤„ç†å™¨ä¸Šçš„ï¼Œ ä½†æ˜¯ç”±äºåœ¨å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ›çš„æ—¶å€™ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹å¯„å­˜å™¨å˜é‡çš„ä¿®æ”¹ä¼šè¢«ä½œä¸ºè¯¥çº¿ç¨‹çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ä¿å­˜èµ·æ¥ï¼Œ è¿™å¯¼è‡´å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ— æ³•â€œçœ‹åˆ°â€è¯¥çº¿ç¨‹å¯¹è¿™ä¸ªå˜é‡çš„ä¿®æ”¿ï¼Œå› æ­¤ï¼Œå•å¤„ç†å™¨ç³»ç»Ÿä¸­å®ç°çš„å¤šçº¿ç¨‹ç¼–ç¨‹ä¹Ÿå¯èƒ½å‡ºç°å¯è§æ€§é—®é¢˜ã€‚</li></ol> <h3 id="ä¸‰å¤§ç‰¹æ€§-æœ‰åºæ€§-ordering"><a href="#ä¸‰å¤§ç‰¹æ€§-æœ‰åºæ€§-ordering" class="header-anchor">#</a> ä¸‰å¤§ç‰¹æ€§ï¼šæœ‰åºæ€§ï¼ˆOrderingï¼‰</h3> <h4 id="é‡æ’åº"><a href="#é‡æ’åº" class="header-anchor">#</a> é‡æ’åº</h4> <p>é‡æ’åº(Reordering)</p> <p>åœ¨å¤šæ ¸å¤„ç†å™¨çš„ç¯å¢ƒä¸‹ï¼Œä»£ç çš„æ‰§è¡Œé¡ºåºå¯èƒ½æ˜¯æ²¡æœ‰ä¿éšœçš„ï¼šç¼–è¯‘å™¨å¯èƒ½æ”¹å˜ä¸¤ä¸ªæ“ä½œçš„å…ˆåé¡ºåºï¼› å·¥å¤„ç†å™¨å¯èƒ½ä¸æ˜¯å®Œå…¨ä¾ç…§ç¨‹åºçš„ç›®æ ‡ä»£ç æ‰€æŒ‡å®šçš„é¡ºåºæ‰§è¡ŒæŒ‡ä»¤ï¼›</p> <p>å¦å¤–ï¼Œåœ¨ä¸€ä¸ªå¤„ç†å™¨ä¸Šæ‰§è¡Œçš„å¤šä¸ªæ“ä½œï¼Œ ä»å…¶ä»–å¤„ç†å™¨çš„è§’åº¦æ¥çœ‹å…¶é¡ºåºå¯èƒ½ä¸ç›®æ ‡ä»£ç æ‰€æŒ‡å®šçš„é¡ºåºä¸ä¸€è‡´ã€‚è¿™ç§ç°è±¡å°±å«ä½œé‡æ’åºã€‚</p> <p>é‡æ’åºæ˜¯å¯¹<code>å†…å­˜è®¿é—®æœ‰å…³</code>çš„æ“ä½œï¼ˆè¯»å’Œå†™ï¼‰æ‰€åšçš„ä¸€ç§<code>ä¼˜åŒ–</code>ï¼Œå®ƒå¯ä»¥åœ¨<code>ä¸å½±å“å•çº¿ç¨‹ç¨‹åºæ­£ç¡®æ€§</code>çš„æƒ…å†µä¸‹æå‡ç¨‹åºçš„æ€§èƒ½ã€‚ ä½†æ˜¯ï¼Œå®ƒå¯èƒ½å¯¹<code>å¤šçº¿ç¨‹ç¨‹åºçš„æ­£ç¡®æ€§</code>äº§ç”Ÿå½±å“ï¼Œå³å®ƒå¯èƒ½å¯¼è‡´<code>çº¿ç¨‹å®‰å…¨é—®é¢˜</code>ã€‚</p> <h4 id="æ’åºé¡ºåº"><a href="#æ’åºé¡ºåº" class="header-anchor">#</a> æ’åºé¡ºåº</h4> <div class="custom-block info"><p class="custom-block-title">Info</p> <ul><li><p><strong>æºä»£ç é¡ºåº</strong></p> <p>æºä»£ç ä¸­æ‰€æŒ‡å®šçš„å†…å­˜è®¿é—®æ“ä½œé¡ºåºã€‚</p></li> <li><p><strong>ç¨‹åºé¡ºåº</strong></p> <p>åœ¨ç»™å®šå¤„ç†å™¨ä¸Šè¿è¡Œçš„ç›®æ ‡ä»£ç æ‰€æŒ‡å®šçš„å†…å­˜è®¿é—®æ“ä½œé¡ºåºã€‚å°½ç®¡Javaè™šæ‹Ÿæœºæ‰§è¡Œä»£ç æœ‰ä¸¤ç§æ–¹å¼ï¼š è§£é‡Šæ‰§è¡Œï¼ˆè¢«æ‰§è¡Œçš„æ˜¯å­—èŠ‚ç ï¼‰å’Œç¼–è¯‘æ‰§è¡Œï¼ˆè¢«æ‰§è¡Œçš„æ˜¯æœºå™¨ç ï¼‰ï¼Œé‡Œçš„ç›®æ ‡ä»£ç æ˜¯æŒ‡å­—èŠ‚ç ã€‚</p></li> <li><p><strong>æ‰§è¡Œé¡ºåº</strong></p> <p>å†…å­˜è®¿é—®æ“ä½œåœ¨ç»™å®šå¤„ç†å™¨ä¸Šçš„<code>å®é™…æ‰§è¡Œé¡ºåº</code>ã€‚</p></li> <li><p><strong>æ„ŸçŸ¥é¡ºåº</strong></p> <p>ç»™å®šå¤„ç†å™¨æ‰€æ„ŸçŸ¥åˆ°ï¼ˆçœ‹åˆ°ï¼‰çš„è¯¥å¤„ç†å™¨åŠå…¶ä»–å¤„ç†å™¨çš„å†…å­˜è®¿é—®æ“ä½œå‘ç”Ÿçš„é¡ºåºã€‚</p></li></ul></div> <p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å°†é‡æ’åºå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š<code>æŒ‡ä»¤é‡æ’åº</code>å’Œ<code>å­˜å‚¨å­ç³»ç»Ÿé‡æ’åº</code>ã€‚</p> <table><thead><tr><th>é‡æ’åºç±»å‹</th> <th>é‡æ’åºè¡¨ç°</th> <th>é‡æ’åºæ¥æº</th></tr></thead> <tbody><tr><td>æŒ‡ä»¤é‡æ’åº</td> <td>ç¨‹åºé¡ºåºä¸æºä»£ç é¡ºåºä¸ä¸€è‡´</td> <td>JITç¼–è¯‘å™¨</td></tr> <tr><td></td> <td>æ‰§è¡Œé¡ºåºä¸ç¨‹åºé¡ºåºä¸ä¸€è‡´</td> <td>JITç¼–è¯‘å™¨ã€å¤„ç†å™¨</td></tr> <tr><td>å­˜å‚¨å­ç³»ç»Ÿé‡æ’åº</td> <td>æºä»£ç é¡ºåºã€ç¨‹åºé¡ºåºå’Œæ‰§è¡Œé¡ºåºè¿™ä¸‰è€…ä¿æŒä¸€è‡´,ä½†æ˜¯æ„ŸçŸ¥é¡ºåºä¸æ‰§è¡Œé¡ºåºä¸ä¸€è‡´</td> <td>é«˜é€Ÿç¼“å­˜ã€å†™ç¼“å†²å™¨</td></tr></tbody></table> <h4 id="æŒ‡ä»¤é‡æ’åº"><a href="#æŒ‡ä»¤é‡æ’åº" class="header-anchor">#</a> æŒ‡ä»¤é‡æ’åº</h4> <p>åœ¨<code>æºä»£ç é¡ºåº</code>ä¸<code>ç¨‹åºé¡ºåº</code>ä¸ä¸€è‡´ï¼Œæˆ–è€…<code>ç¨‹åºé¡ºåº</code>ä¸<code>æ‰§è¡Œé¡ºåº</code>ä¸ä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±è¯´å‘ç”Ÿäº†æŒ‡ä»¤é‡æ’åºã€‚ æŒ‡ä»¤é‡æ’åºæ˜¯ä¸€ç§åŠ¨ä½œï¼Œå®ƒ<code>ç¡®ç¡®å®å®</code>åœ°å¯¹æŒ‡ä»¤çš„é¡ºåºåšäº†è°ƒæ•´ï¼Œå…¶é‡æ’åºçš„å¯¹è±¡æ˜¯<code>æŒ‡ä»¤</code>ã€‚</p> <blockquote><p>Javaå¹³å°åŒ…å«ä¸¤ç§ç¼–è¯‘å™¨:<code>é™æ€ç¼–è¯‘å™¨(Javac)</code>å’Œ<code>åŠ¨æ€ç¼–è¯‘å™¨(JITç¼–è¯‘å™¨)</code>ï¼Œ</p> <ul><li><strong>é™æ€ç¼–è¯‘å™¨(Javac)</strong>ï¼šæ˜¯å°†Javaæºä»£ç (javaæ–‡æœ¬æ–‡ä»¶)ç¼–è¯‘ä¸ºå­—èŠ‚ç (. classäºŒè¿›åˆ¶æ–‡ä»¶),å®ƒ æ˜¯åœ¨ä»£ç ç¼–è¯‘é˜¶æ®µä»‹å…¥çš„ã€‚</li> <li><strong>åŠ¨æ€ç¼–è¯‘å™¨(JITç¼–è¯‘å™¨)</strong>ï¼šæ˜¯å°†å­—èŠ‚ç åŠ¨æ€ç¼–è¯‘ä¸ºJavaè™šæ‹Ÿæœºå®¿ä¸»æœºçš„æœ¬åœ°ä»£ç (æœºå™¨ç ,å®ƒæ˜¯åœ¨Javaç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä»‹å…¥çš„ã€‚</li></ul> <p>**é™æ€ç¼–è¯‘å™¨(Javac)<strong>åŸºæœ¬ä¸ä¼šæŒ‡ä»¤é‡æ’åºï¼Œè€Œ</strong>åŠ¨æ€ç¼–è¯‘å™¨(JITç¼–è¯‘å™¨)**åˆ™å¯èƒ½ã€‚</p></blockquote> <p><strong>ç‰¹å¾</strong></p> <ol><li><strong>é‡æ’åºå¯èƒ½å¯¼è‡´çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ï¼šåœ¨æœ¬Demoä¸­ï¼Œé‡æ’åºä½¿å¾—sumæ–¹æ³•çš„è¿”å›å€¼å¯èƒ½æ—¢ä¸æ˜¯-1(æ­¤æ—¶helperå®ä¾‹ä¸ºnull)ï¼Œä¹Ÿä¸æ˜¯4ã€‚ å½“ç„¶ï¼Œè¿™å¹¶ä¸è¡¨ç¤ºé‡æ’åºæœ¬èº«æ˜¯é”™è¯¯çš„ï¼Œè€Œæ˜¯è¯´æˆ‘ä»¬çš„ç¨‹åºæœ¬èº«æœ‰é—®é¢˜â”€â”€æˆ‘ä»¬çš„ç¨‹åºæ²¡æœ‰ä½¿ç”¨æˆ–è€…æ²¡æœ‰æ­£ç¡®åœ°ä½¿ç”¨çº¿ç¨‹åŒæ­¥æœºåˆ¶ã€‚</li> <li><strong>é‡æ’åºä¸æ˜¯å¿…ç„¶å‡ºç°çš„</strong>ï¼šæœ¬Demoè¿è¡Œæ—¶é‡å¤è°ƒç”¨createHelperå’Œsumå…±200000æ¬¡æ‰å‡ºç°7æ¬¡é‡æ’åºï¼Œæ¯”ç‡ä¸º0.035%ã€‚</li></ol> <h4 id="å¤„ç†å™¨ä¹±åºæ‰§è¡Œ"><a href="#å¤„ç†å™¨ä¹±åºæ‰§è¡Œ" class="header-anchor">#</a> å¤„ç†å™¨ä¹±åºæ‰§è¡Œ</h4> <p>å¤„ç†å™¨ä¹Ÿå¯èƒ½æ‰§è¡ŒæŒ‡ä»¤é‡æ’åºï¼Œè¿™ä½¿å¾—æ‰§è¡Œé¡ºåºä¸ç¨‹åºé¡ºåºä¸ä¸€è‡´ã€‚è¿™æ˜¯å› ä¸ºç°ä»£å¤„ç†å™¨ä¸ºäº†æé«˜æŒ‡ä»¤æ‰§è¡Œæ•ˆç‡ï¼Œ å¾€å¾€ä¸æ˜¯æŒ‰ç…§ç¨‹åºé¡ºåºé€ä¸€æ‰§è¡ŒæŒ‡ä»¤çš„ï¼Œè€Œæ˜¯åŠ¨æ€è°ƒæ•´æŒ‡ä»¤çš„é¡ºåºï¼Œåšåˆ°å“ªæ¡æŒ‡ä»¤å°±ç»ªå°±å…ˆæ‰§è¡Œå“ªæ¡æŒ‡ä»¤ï¼Œ è¿™å°±æ˜¯å¤„ç†å™¨å¤„ç†å™¨å¯¹æŒ‡ä»¤è¿›è¡Œçš„é‡æ’åºï¼Œä¹Ÿè¢«ç§°ä¸º<code>å¤„ç†å™¨çš„ä¹±åºæ‰§è¡Œ</code>ã€‚</p> <p><strong>ä¹±åºæ‰§è¡Œçš„æœºåˆ¶</strong>
åœ¨ä¹±åºæ‰§è¡Œçš„å¤„ç†å™¨ä¸­ï¼ŒæŒ‡ä»¤æ˜¯ä¸€æ¡ä¸€æ¡æŒ‰ç…§ç¨‹åºé¡ºåºè¢«å¤„ç†å™¨è¯»å–çš„ï¼ˆå³â€œé¡ºåºè¯»å–â€ï¼‰ï¼Œ ç„¶åè¿™äº›æŒ‡ä»¤ä¸­å“ªæ¡å°±ç»ªäº†å“ªæ¡å°±ä¼šå…ˆè¢«æ‰§è¡Œï¼Œè€Œä¸æ˜¯å®Œå…¨æŒ‰ç…§ç¨‹åºé¡ºåºæ‰§è¡Œï¼ˆå³â€œä¹±åºæ‰§è¡Œâ€ï¼‰ã€‚ è¿™äº›æŒ‡ä»¤æ‰§è¡Œçš„ç»“æœä¼šè¢«å…ˆå­˜å…¥é‡æ’åºç¼“å†²å™¨ï¼Œè€Œä¸æ˜¯ç›´æ¥è¢«å†™å…¥å¯„å­˜å™¨æˆ–è€…ä¸»å†…å­˜ã€‚ é‡æ’åºç¼“å†²å™¨ä¼šå°†å„ä¸ªæŒ‡ä»¤çš„æ‰§è¡Œç»“æœæŒ‰ç…§ç›¸åº”æŒ‡ä»¤è¢«å¤„ç†å™¨è¯»å–çš„é¡ºåºæäº¤åˆ°å¯„å­˜å™¨æˆ–è€…å†…å­˜ä¸­å»(å³â€œé¡ºåºæäº¤â€)ã€‚ åœ¨ä¹±åºæ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œå°½ç®¡æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºå¯èƒ½æ²¡æœ‰å®Œå…¨ä¾ç…§ç¨‹åºé¡ºåºï¼Œ ä½†æ˜¯ç”±äºæŒ‡ä»¤çš„æ‰§è¡Œç»“æœçš„æäº¤ï¼ˆå³åæ˜ åˆ°å¯„å­˜å™¨å’Œå†…å­˜ä¸­ï¼‰ä»ç„¶æ˜¯æŒ‰ç…§ç¨‹åºé¡ºåºæ¥çš„ï¼Œ å› æ­¤å¤„ç†å™¨çš„æŒ‡ä»¤é‡æ’åºå¹¶ä¸ä¼šå¯¹å•çº¿ç¨‹ç¨‹åºçš„æ­£ç¡®æ€§äº§ç”Ÿå½±å“ã€‚</p> <p><strong>çŒœæµ‹æ‰§è¡Œ(Speculation)</strong>
çŒœæµ‹æ‰§è¡ŒæŠ€æœ¯å°±å¥½æ¯”æ²¡æœ‰å«æ˜Ÿå¯¼èˆªæ—¶ä»£åœ¨é™Œç”Ÿåœ°æ–¹å¼€è½¦é‡åˆ°å²”è·¯å£çš„æƒ…å½¢ï¼š è™½ç„¶æˆ‘ä»¬ä¸ç¡®å®šå…¶ä¸­å“ªæ¡è·¯èƒ½å¤Ÿé€šå¾€ç›®çš„åœ°ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‡­çŒœæµ‹èµ°å…¶ä¸­ä¸€æ¡è·¯ï¼Œ ä¸‡ä¸€çŒœé”™äº†ï¼ˆå‰è·¯ä¸é€šï¼‰å¯ä»¥æ‰å¤´é‡æ–°èµ°å¦å¤–ä¸€æ¡è·¯ã€‚</p> <p>çŒœæµ‹æ‰§è¡Œèƒ½å¤Ÿé€ ifè¯­å¥çš„è¯­å¥ä½“å…ˆäºå…¶æ¡ä»¶è¯­å¥è¢«æ‰§è¡Œçš„æ•ˆæœï¼Œå³å…ˆæ‰§è¡Œifè¯­å¥å—ä¸­ç»“æœå†å»åˆ¤æ–­ifæ¡ä»¶ï¼Œå¦‚æœifæ¡ä»¶ä¸é€šè¿‡ç›´æ¥ä¸¢å¼ƒç»“æœï¼Œå¦åˆ™å†™å…¥å†…å­˜ä¸­ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æŒ‡ä»¤é‡æ’åºç°è±¡ã€‚</p> <h4 id="å­˜å‚¨å­ç³»ç»Ÿé‡æ’åº"><a href="#å­˜å‚¨å­ç³»ç»Ÿé‡æ’åº" class="header-anchor">#</a> å­˜å‚¨å­ç³»ç»Ÿé‡æ’åº</h4> <ol><li><p>å­˜å‚¨å­ç³»ç»Ÿ
ä¸»å†…å­˜(RAM)ç›¸å¯¹äºå¤„ç†å™¨æ˜¯ä¸€ä¸ªæ…¢é€Ÿè®¾å¤‡ï¼Œä¸ºäº†é¿å…å…¶æ‹–åè…¿ï¼Œå¤„ç†å™¨å¹¶ä¸æ˜¯ç›´æ¥è®¿é—®ä¸»å†…å­˜ï¼Œ è€Œæ˜¯é€šè¿‡<code>é«˜é€Ÿç¼“å­˜</code>è®¿é—®ä¸»å†…å­˜çš„ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œç°ä»£å¤„ç†å™¨è¿˜å¼•äººäº†<code>å†™ç¼“å†²å™¨(Store Bufferï¼Œä¹Ÿç§°Write Buffer)</code>ï¼Œ ä»¥æé«˜å†™é«˜é€Ÿç¼“å­˜æ“ä½œçš„æ•ˆç‡ã€‚æœ‰çš„å¤„ç†å™¨(å¦‚Intelçš„x86å¤„ç†å™¨)å¯¹æ‰€æœ‰çš„å†™ä¸»å†…å­˜çš„æ“ä½œéƒ½æ˜¯é€šè¿‡å†™ç¼“å†²å™¨è¿›è¡Œçš„ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å°†<code>å†™ç¼“å†²å™¨</code>å’Œ<code>é«˜é€Ÿç¼“å­˜</code>ç»Ÿç§°ä¸º<code>å­˜å‚¨å­ç³»ç»Ÿ</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­˜å‚¨å­ç³»ç»Ÿå¹¶ä¸æ˜¯å†…å­˜çš„å­ç³»ç»Ÿï¼Œè€Œæ˜¯å¤„ç†å™¨çš„å­ç³»ç»Ÿã€‚</p></li> <li><p>å†…å­˜é‡æ’åº(Memory Ordering)
å³ä½¿åœ¨å¤„ç†å™¨ä¸¥æ ¼ä¾ç…§ç¨‹åºé¡ºåºæ‰§è¡Œä¸¤ä¸ªå†…å­˜è®¿é—®æ“ä½œçš„æƒ…å†µä¸‹ï¼Œ åœ¨<code>å­˜å‚¨å­ç³»ç»Ÿ</code>çš„ä½œç”¨ä¸‹ï¼Œå…¶ä»–å¤„ç†å™¨å¯¹è¿™ä¸¤ä¸ªæ“ä½œçš„æ„ŸçŸ¥é¡ºåºä»ç„¶å¯èƒ½ä¸ç¨‹åºé¡ºåºä¸ä¸€è‡´ï¼Œ å³è¿™ä¸¤ä¸ªæ“ä½œçš„æ‰§è¡Œé¡ºåºçœ‹èµ·æ¥åƒæ˜¯å‘ç”Ÿäº†å˜åŒ–ã€‚è¿™ç§ç°è±¡å°±æ˜¯å­˜å‚¨å­ç³»ç»Ÿé‡æ’åºï¼Œä¹Ÿè¢«ç§°ä¸ºå†…å­˜é‡æ’åºã€‚</p></li> <li><p>ä¸æŒ‡ä»¤é‡æ’åºçš„åŒºåˆ«
æŒ‡ä»¤é‡æ’åºçš„é‡æ’åºå¯¹è±¡æ˜¯<code>æŒ‡ä»¤</code>ï¼Œå®ƒå®å®åœ¨åœ¨åœ°å¯¹æŒ‡ä»¤çš„é¡ºåºè¿›è¡Œè°ƒæ•´ï¼Œ è€Œå­˜å‚¨å­ç³»ç»Ÿé‡æ’åºæ˜¯ä¸€ç§<code>ç°è±¡</code>è€Œä¸æ˜¯ä¸€ç§åŠ¨ä½œï¼Œ<strong>å®ƒå¹¶æ²¡æœ‰çœŸæ­£å¯¹æŒ‡ä»¤æ‰§è¡Œé¡ºåºè¿›è¡Œè°ƒæ•´</strong>ï¼Œ è€Œåªæ˜¯é€ æˆäº†ä¸€ç§æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºåƒæ˜¯è¢«è°ƒæ•´è¿‡ä¸€æ ·çš„ç°è±¡ï¼Œå…¶é‡æ’åºçš„å¯¹è±¡æ˜¯<code>å†…å­˜æ“ä½œçš„ç»“æœ</code>ã€‚</p></li> <li><p>æŒ‡ä»¤é‡æ’åºçš„ç±»å‹
ä»å¤„ç†å™¨çš„è§’åº¦æ¥è¯´ï¼Œè¯»å†…å­˜æ“ä½œçš„å®è´¨ï¼Œæ˜¯ä»æŒ‡å®šçš„RAMåœ°å€(é€šè¿‡é«˜é€Ÿç¼“å­˜)åŠ è½½æ•°æ®åˆ°å¯„å­˜å™¨ï¼Œ å› æ­¤è¯»å†…å­˜æ“ä½œé€šå¸¸è¢«ç§°ä¸ºLoadæ“ä½œï¼›å†™å†…å­˜æ“ä½œçš„å®è´¨ï¼Œ æ˜¯å°†æ•°æ®(æŒ‡ä»¤ä¸­çš„æ“ä½œæ•°æˆ–å¯„å­˜å™¨ä¸­çš„å€¼)å­˜å‚¨åˆ°æŒ‡å®šåœ°å€è¡¨ç¤ºçš„RAMå­˜å‚¨å•å…ƒä¸­ï¼Œå› æ­¤å†™å†…å­˜æ“ä½œé€šå¸¸è¢«ç§°ä¸ºStoreã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå†…å­˜é‡æ’åºåˆ†ä¸ºä»¥ä¸‹4ç§ã€‚</p></li></ol> <h4 id="è²Œä¼¼ä¸²è¡Œè¯­ä¹‰-as-if-serial-semantics"><a href="#è²Œä¼¼ä¸²è¡Œè¯­ä¹‰-as-if-serial-semantics" class="header-anchor">#</a> è²Œä¼¼ä¸²è¡Œè¯­ä¹‰(As-if-serial Semantics)</h4> <p>å®šä¹‰
é‡æ’åºå¹¶ééšæ„åœ°å¯¹æŒ‡ä»¤ã€å†…å­˜æ“ä½œçš„ç»“æœè¿›è¡Œæ‚ä¹±æ— ç« çš„æ’åºæˆ–è€…é¡ºåºè°ƒæ•´ï¼Œè€Œæ˜¯éµå¾ªä¸€å®šçš„è§„åˆ™ã€‚ ç¼–è¯‘å™¨ï¼ˆä¸»è¦æ˜¯JITç¼–è¯‘å™¨ï¼‰ã€å¤„ç†å™¨ï¼ˆåŒ…æ‹¬å…¶å­˜å‚¨å­ç³»ç»Ÿï¼‰éƒ½ä¼šéµå®ˆè¿™äº›è§„åˆ™ï¼Œ ä»è€Œç»™å•çº¿ç¨‹ç¨‹åºåˆ›é€ ä¸€ç§å‡è±¡â”€â”€æŒ‡ä»¤æ˜¯æŒ‰ç…§æºä»£ç é¡ºåºæ‰§è¡Œçš„ã€‚è¿™ç§å‡è±¡å°±è¢«ç§°ä¸º<code>è²Œä¼¼ä¸²è¡Œè¯­ä¹‰</code>ã€‚ è²Œä¼¼ä¸²è¡Œè¯­ä¹‰åªæ˜¯ä»<strong>å•çº¿ç¨‹ç¨‹åºçš„è§’åº¦</strong>ä¿è¯é‡æ’åºåçš„è¿è¡Œç»“æœä¸å½±å“ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œå®ƒå¹¶ä¸ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ç¨‹åºçš„æ­£ç¡®æ€§ã€‚</p> <p><strong>æ•°æ®ä¾èµ–å…³ç³»(Data Dependency)</strong></p> <div class="custom-block info"><p class="custom-block-title">Info</p> <p>ä¸ºäº†ä¿è¯è²Œä¼¼ä¸²è¡Œè¯­ä¹‰ï¼Œ<strong>å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„è¯­å¥ä¸ä¼šè¢«é‡æ’åºï¼Œåªæœ‰ä¸å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„è¯­å¥æ‰ä¼šè¢«é‡æ’åº</strong>ã€‚ å¦‚æœä¸¤ä¸ªæ“ä½œ(æŒ‡ä»¤)è®¿é—®åŒä¸€ä¸ªå˜é‡(åœ°å€)ï¼Œä¸”å…¶ä¸­ä¸€ä¸ªæ“ä½œ(æŒ‡ä»¤)ä¸ºå†™æ“ä½œï¼Œ é‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å°±å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ï¼Œè¿™äº›æ“ä½œåŒ…æ‹¬ï¼šå†™åè¯»(WAR)ã€è¯»åå†™(RAW)ã€å†™åå†™(WAW)ä¸‰ç§æ“ä½œã€‚</p></div> <p><strong>æ§åˆ¶ä¾èµ–å…³ç³»(Control Dependency)</strong></p> <div class="custom-block info"><p class="custom-block-title">Info</p> <p>å¦‚æœä¸€æ¡è¯­å¥ï¼ˆæŒ‡ä»¤ï¼‰çš„æ‰§è¡Œç»“æœä¼šå†³å®šå¦å¤–ä¸€æ¡è¯­å¥ï¼ˆæŒ‡ä»¤ï¼‰èƒ½å¦è¢«æ‰§è¡Œï¼Œ é‚£ä¹ˆè¿™ä¸¤æ¡è¯­å¥ï¼ˆæŒ‡ä»¤ï¼‰ä¹‹é—´å°±å­˜åœ¨æ§åˆ¶ä¾èµ–å…³ç³»ã€‚å­˜åœ¨æ§åˆ¶ä¾èµ–å…³ç³»çš„è¯­å¥æ˜¯å¯ä»¥å…è®¸è¢«é‡æ’åºçš„ï¼Œ å­˜åœ¨æ§åˆ¶ä¾èµ–å…³ç³»çš„è¯­å¥æœ€å…¸å‹çš„å°±æ˜¯ifè¯­å¥ä¸­çš„æ¡ä»¶è¡¨è¾¾å¼å’Œç›¸åº”çš„è¯­å¥ä½“ã€‚ å…è®¸è¿™ç§é‡æ’åºæ„å‘³ç€å¤„ç†å™¨å¯èƒ½å…ˆæ‰§è¡Œfè¯­å¥ä½“æ‰€æ¶‰åŠçš„å†…å­˜è®¿é—®æ“ä½œï¼Œç„¶åå†æ‰§è¡Œç›¸åº”çš„æ¡ä»¶åˆ¤æ–­ã€‚ å…è®¸å¯¹å­˜åœ¨æ§åˆ¶ä¾èµ–å…³ç³»çš„è¯­å¥è¿›è¡Œé‡æ’åºåŒæ ·ä¹Ÿæ˜¯å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œ è¿™æ˜¯å› ä¸ºå­˜åœ¨æ§åˆ¶ä¾èµ–å…³ç³»çš„è¯­å¥(å¦‚ifè¯­å¥)ä¼šå½±å“å¤„ç†å™¨å¯¹æŒ‡ä»¤åºåˆ—æ‰§è¡Œçš„å¹¶è¡Œç¨‹åº¦ã€‚</p></div> <h4 id="ä¿éšœå†…å­˜è®¿é—®çš„é¡ºåº"><a href="#ä¿éšœå†…å­˜è®¿é—®çš„é¡ºåº" class="header-anchor">#</a> ä¿éšœå†…å­˜è®¿é—®çš„é¡ºåº</h4> <p>è²Œä¼¼ä¸²è¡Œè¯­ä¹‰<strong>åªæ˜¯ä¿éšœé‡æ’åºä¸å½±å“å•çº¿ç¨‹ç¨‹åºçš„æ­£ç¡®æ€§</strong>ï¼Œä»è¿™ä¸ªè§’åº¦å‡ºå‘ï¼Œ å¤šçº¿ç¨‹ç¨‹åºçš„æœ‰åºæ€§çš„ä¿éšœå¯ä»¥ç†è§£ä¸ºé€šè¿‡æŸäº›æªæ–½ä½¿å¾—è²Œä¼¼ä¸²è¡Œè¯­ä¹‰æ‰©å±•åˆ°å¤šçº¿ç¨‹ç¨‹åºã€‚<strong>å³é‡æ’åºè¦ä¹ˆä¸å‘ç”Ÿï¼Œ è¦ä¹ˆå³ä½¿å‘ç”Ÿäº†ä¹Ÿä¸ä¼šå½±å“å¤šçº¿ç¨‹ç¨‹åºçš„æ­£ç¡®æ€§</strong>ï¼Œè¿™æ ·æœ‰åºæ€§çš„ä¿éšœä¹Ÿå¯ä»¥ç†è§£ä¸ºä»é€»è¾‘ä¸Šéƒ¨åˆ†ç¦æ­¢é‡æ’åºã€‚</p> <p>ä»åº•å±‚çš„è§’åº¦æ¥è¯´ï¼Œç¦æ­¢é‡æ’åºæ˜¯é€šè¿‡è°ƒç”¨å¤„ç†å™¨æä¾›ç›¸åº”çš„æŒ‡ä»¤ï¼ˆ<code>å†…å­˜å±éšœ</code>ï¼‰æ¥å®ç°çš„ã€‚ å½“ç„¶ï¼ŒJavaä½œä¸ºä¸€ä¸ªè·¨å¹³å°çš„è¯­è¨€ï¼Œå®ƒä¼šæ›¿æˆ‘ä»¬ä¸è¿™ç±»æŒ‡ä»¤æ‰“äº¤é“ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨è¯­è¨€æœ¬èº«æä¾›çš„æœºåˆ¶å³å¯ã€‚</p> <h4 id="å¯è§æ€§ä¸æœ‰åºæ€§"><a href="#å¯è§æ€§ä¸æœ‰åºæ€§" class="header-anchor">#</a> å¯è§æ€§ä¸æœ‰åºæ€§</h4> <p>å¯è§æ€§æ˜¯æœ‰åºæ€§çš„åŸºç¡€
å¯è§æ€§æè¿°çš„æ˜¯ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ›´æ–°å¯¹äºå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦å¯è§ï¼Œ æˆ–è€…è¯´ä»€ä¹ˆæƒ…å†µä¸‹å¯è§çš„é—®é¢˜ã€‚æœ‰åºæ€§æè¿°çš„æ˜¯ï¼Œä¸€ä¸ªå¤„ç†å™¨ä¸Šè¿è¡Œçš„çº¿ç¨‹å¯¹å…±äº«å˜é‡æ‰€åšçš„æ›´æ–°ï¼Œ åœ¨å…¶ä»–å¤„ç†å™¨ä¸Šè¿è¡Œçš„å…¶ä»–çº¿ç¨‹çœ‹æ¥ï¼Œè¿™äº›çº¿ç¨‹æ˜¯ä»¥ä»€ä¹ˆæ ·çš„é¡ºåºè§‚å¯Ÿåˆ°è¿™äº›æ›´æ–°çš„é—®é¢˜ã€‚ å› æ­¤ï¼Œå¯è§æ€§æ˜¯æœ‰åºæ€§çš„åŸºç¡€ã€‚å¦ä¸€æ–¹é¢ï¼ŒäºŒè€…åˆæ˜¯ç›¸äº’åŒºåˆ†çš„ã€‚</p> <h3 id="ä¸Šä¸‹æ–‡åˆ‡æ¢"><a href="#ä¸Šä¸‹æ–‡åˆ‡æ¢" class="header-anchor">#</a> ä¸Šä¸‹æ–‡åˆ‡æ¢</h3> <p>ä¸Šä¸‹æ–‡åˆ‡æ¢(Context Switch)åœ¨æŸç§ç¨‹åº¦ä¸Šå¯ä»¥è¢«çœ‹ä½œå¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªå¤„ç†å™¨çš„äº§ç‰©,å®ƒæ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µã€‚</p> <h4 id="æè¿°"><a href="#æè¿°" class="header-anchor">#</a> æè¿°</h4> <p>å½“ä¸€ä¸ªè¿›ç¨‹ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ç”±äºå…¶<code>æ—¶é—´ç‰‡</code>ç”¨å®Œï¼Œæˆ–è€…å› å…¶è‡ªèº«åŸå› ï¼ˆæ¯”å¦‚ç¨åå†ç»§ç»­è¿è¡Œï¼‰è¢«è¿«æˆ–è€…ä¸»åŠ¨æš‚åœå…¶è¿è¡Œæ—¶ï¼Œ å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼ˆå¯èƒ½æ˜¯åŒä¸€ä¸ªè¿›ç¨‹æˆ–è€…å…¶ä»–è¿›ç¨‹ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼‰å¯ä»¥è¢«æ“ä½œç³»ç»Ÿï¼ˆ<code>çº¿ç¨‹è°ƒåº¦å™¨</code>ï¼‰é€‰ä¸­ï¼Œ <code>å ç”¨å¤„ç†å™¨</code>å¼€å§‹æˆ–è€…ç»§ç»­å…¶è¿è¡Œã€‚è¿™ç§ä¸€ä¸ªçº¿ç¨‹è¢«æš‚åœï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹è¢«é€‰ä¸­å¼€å§‹æˆ–è€…ç»§ç»­è¿è¡Œçš„è¿‡ç¨‹å°±å«ä½œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ ä¹Ÿå¯ç®€å•åœ°ç§°ä¸ºä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p> <p>ä»Javaåº”ç”¨çš„è§’åº¦æ¥çœ‹,ä¸€ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€åœ¨ <code>RUNNABLE</code>çŠ¶æ€ä¸<code>é RUNNABLEçŠ¶æ€</code>(åŒ…æ‹¬ BLOCKEDã€ WAITINGå’Œ TIMED WAITINGä¸­çš„ä»»æ„ä¸€ä¸ªå­çŠ¶æ€)ä¹‹é—´åˆ‡æ¢çš„è¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡åˆ‡æ¢çš„è¿‡ç¨‹ã€‚</p> <h4 id="ä¸Šä¸‹æ–‡"><a href="#ä¸Šä¸‹æ–‡" class="header-anchor">#</a> ä¸Šä¸‹æ–‡</h4> <p>åˆ‡å‡ºå’Œåˆ‡å…¥çš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦ä¿å­˜å’Œæ¢å¤ç›¸åº”çº¿ç¨‹çš„è¿›åº¦ä¿¡æ¯ï¼Œ å³åˆ‡å…¥å’Œåˆ‡å‡ºé‚£ä¸€åˆ»ç›¸åº”çº¿ç¨‹æ‰€æ‰§è¡Œçš„ä»»åŠ¡çŠ¶æ€ä¿¡æ¯ï¼ˆå¦‚è®¡ç®—çš„ä¸­é—´ç»“æœä»¥åŠæ‰§è¡Œåˆ°äº†å“ªæ¡æŒ‡ä»¤ï¼‰ã€‚ <strong>è¿™ä¸ªè¿›åº¦ä¿¡æ¯å°±è¢«ç§°ä¸ºä¸Šä¸‹æ–‡</strong>ã€‚ å®ƒä¸€èˆ¬åŒ…æ‹¬<code>é€šç”¨å¯„å­˜å™¨(General Purpose Register</code>)å’Œ<code>ç¨‹åºè®¡æ•°å™¨(Program Counter)</code>ä¸­çš„å†…å®¹ã€‚</p> <h4 id="åˆ‡å‡ºå’Œåˆ‡å…¥"><a href="#åˆ‡å‡ºå’Œåˆ‡å…¥" class="header-anchor">#</a> åˆ‡å‡ºå’Œåˆ‡å…¥</h4> <ul><li>ä¸€ä¸ªçº¿ç¨‹è¢«å‰¥å¤ºå¤„ç†å™¨çš„ä½¿ç”¨æƒè€Œè¢«æš‚åœè¿è¡Œå°±è¢«ç§°ä¸ºåˆ‡å‡º</li> <li>ä¸€ä¸ªçº¿ç¨‹è¢«æ“ä½œç³»ç»Ÿé€‰ä¸­å ç”¨å¤„ç†å™¨å¼€å§‹æˆ–è€…ç»§ç»­å…¶è¿è¡Œå°±è¢«ç§°ä¸ºåˆ‡å…¥ã€‚</li></ul> <h4 id="ä¸Šä¸‹æ–‡åˆ‡æ¢åˆ†ç±»"><a href="#ä¸Šä¸‹æ–‡åˆ‡æ¢åˆ†ç±»" class="header-anchor">#</a> ä¸Šä¸‹æ–‡åˆ‡æ¢åˆ†ç±»</h4> <p>æŒ‰ç…§å¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å› ç´ åˆ’åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šä¸‹æ–‡åˆ‡æ¢åˆ†ä¸º</p> <ul><li><strong>è‡ªå‘æ€§ä¸Šä¸‹æ–‡åˆ‡æ¢</strong></li> <li><strong>éè‡ªå‘æ€§ä¸Šä¸‹æ–‡åˆ‡æ¢</strong></li></ul> <p><strong>è‡ªå‘æ€§ä¸Šä¸‹æ–‡åˆ‡æ¢(Voluntary Context Switch)</strong></p> <p>è‡ªå‘æ€§ä¸Šä¸‹æ–‡åˆ‡æ¢æŒ‡çº¿ç¨‹ç”±äºå…¶è‡ªèº«å› ç´ å¯¼è‡´çš„åˆ‡å‡ºã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Thread</span><span class="token punctuation">.</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token keyword">long</span> millis<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token keyword">int</span> nanos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">LockSupport</span><span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>å¦å¤–,çº¿ç¨‹å‘èµ·äº†IOæ“ä½œ(å¦‚è¯»å–æ–‡ä»¶)æˆ–è€…ç­‰å¾…å…¶ä»–çº¿ç¨‹æŒæœ‰çš„é”(é”çš„æ¦‚å¿µåœ¨ ç¬¬3ç« ä¼šä»‹ç»)ä¹Ÿä¼šå¯¼è‡´è‡ªå‘æ€§ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p></blockquote> <p><strong>éè‡ªå‘æ€§ä¸Šä¸‹æ–‡åˆ‡æ¢(Involuntary Context Switch)</strong></p> <p>çº¿ç¨‹ç”±äº<code>çº¿ç¨‹è°ƒåº¦å™¨</code>çš„åŸå› è¢«è¿«åˆ‡å‡ºã€‚ å¯¼è‡´éè‡ªå‘æ€§ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¸¸è§å› ç´ åŒ…æ‹¬ï¼š</p> <ul><li>è¢«åˆ‡å‡ºçº¿ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œ</li> <li>æœ‰ä¸€ä¸ªæ¯”è¢«åˆ‡å‡ºçº¿ç¨‹ä¼˜å…ˆçº§æ›´é«˜çš„çº¿ç¨‹éœ€è¦è¢«è¿è¡Œã€‚</li></ul> <p>ä»Javaå¹³å°çš„è§’åº¦æ¥çœ‹ï¼ŒJavaè™šæ‹Ÿæœºçš„åƒåœ¾å›æ”¶(Garbage Collect)åŠ¨ä½œä¹Ÿå¯èƒ½å¯¼è‡´éè‡ªå‘æ€§ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ è¿™æ˜¯å› ä¸ºåƒåœ¾å›æ”¶å™¨åœ¨æ‰§è¡Œåƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½éœ€è¦æš‚åœæ‰€æœ‰åº”ç”¨çº¿ç¨‹æ‰èƒ½å®Œæˆå…¶å·¥ä½œï¼Œ æ¯”å¦‚åœ¨ä¸»è¦å›æ”¶(Major Collection)è¿‡ç¨‹ä¸­ï¼Œåƒåœ¾å›æ”¶å™¨åœ¨å¯¹Javaè™šæ‹Ÿæœºå †å†…å­˜åŒºåŸŸè¿›è¡Œæ•´ç†çš„æ—¶å€™éœ€è¦å…ˆåœæ­¢æ‰€æœ‰åº”ç”¨çº¿ç¨‹ã€‚</p> <h4 id="ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€"><a href="#ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€" class="header-anchor">#</a> ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€</h4> <p>ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€åŒ…æ‹¬<code>ç›´æ¥å¼€é”€</code>å’Œ<code>é—´æ¥å¼€é”€</code>ã€‚</p> <p><strong>ç›´æ¥å¼€é”€</strong></p> <ul><li>æ“ä½œç³»ç»Ÿä¿å­˜å’Œæ¢å¤ä¸Šä¸‹æ–‡æ‰€éœ€çš„å¼€é”€ï¼Œè¿™ä¸»è¦æ˜¯å¤„ç†å™¨æ—¶é—´å¼€é”€ã€‚</li> <li>çº¿ç¨‹è°ƒåº¦å™¨è¿›è¡Œçº¿ç¨‹è°ƒåº¦çš„å¼€é”€ï¼šæ¯”å¦‚ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™å†³å®šå“ªä¸ªçº¿ç¨‹ä¼šå ç”¨å¤„ç†å™¨è¿è¡Œã€‚</li></ul> <p><strong>é—´æ¥å¼€é”€</strong></p> <ul><li>å¤„ç†é«˜é€Ÿç¼“å­˜é‡æ–°åŠ è½½çš„å¼€é”€ï¼šä¸€ä¸ªè¢«åˆ‡å‡ºçš„çº¿ç¨‹å¯èƒ½ç¨ååœ¨<strong>å¦å¤–ä¸€ä¸ªå¤„ç†å™¨</strong>ä¸Šè¢«åˆ‡å…¥ç»§ç»­è¿è¡Œã€‚ ç”±äºè¿™ä¸ªå¤„ç†å™¨ä¹‹å‰å¯èƒ½æœªè¿è¡Œè¿‡è¯¥çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹åœ¨å…¶ç»§ç»­è¿è¡Œè¿‡ç¨‹ä¸­éœ€è®¿é—®çš„å˜é‡ï¼Œ ä»ç„¶éœ€è¦è¢«è¯¥å¤„ç†å™¨é‡æ–°ä»ä¸»å†…å­˜æˆ–è€…é€šè¿‡ç¼“å­˜è‡´æ€§åè®®ä»å…¶ä»–å¤„ç†å™¨åŠ è½½åˆ°é«˜é€Ÿç¼“å­˜ä¹‹ä¸­ï¼Œè¿™æ˜¯æœ‰ä¸€å®šæ—¶é—´æ¶ˆè€—çš„ã€‚</li> <li>é«˜é€Ÿç¼“å­˜å†…å®¹å†²åˆ·(Flush)çš„å¼€é”€ï¼šï¸ä¸Šä¸‹æ–‡åˆ‡æ¢ä¹Ÿå¯èƒ½å¯¼è‡´æ•´ä¸ªä¸€çº§é«˜é€Ÿç¼“å­˜ä¸­çš„å†…å®¹è¢«å†²åˆ·ï¼Œ å³ä¸€çº§é«˜é€Ÿç¼“å­˜ä¸­çš„å†…å®¹ä¼šè¢«å†™å…¥ä¸‹ä¸€çº§é«˜é€Ÿç¼“å­˜ï¼ˆå¦‚äºŒçº§é«˜é€Ÿç¼“å­˜ï¼‰ï¼Œæˆ–è€…ä¸»å†…å­˜(RAM)ä¸­</li></ul> <p>çº¿ç¨‹çš„æ•°é‡è¶Šå¤šï¼Œå¯èƒ½å¯¼è‡´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ä¹Ÿå°±å¯èƒ½è¶Šå¤§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ä½¿ç”¨çš„çº¿ç¨‹æ•°é‡è¶Šå¤šï¼Œ ç¨‹åºçš„è®¡ç®—æ•ˆç‡å¯èƒ½åè€Œè¶Šä½ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡å¤šçº¿ç¨‹ç¨‹åºçš„æ—¶å€™ï¼Œå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦çš„è€ƒé‡å› ç´ ã€‚</p> <h3 id="çº¿ç¨‹çš„æ´»æ€§æ•…éšœ"><a href="#çº¿ç¨‹çš„æ´»æ€§æ•…éšœ" class="header-anchor">#</a> çº¿ç¨‹çš„æ´»æ€§æ•…éšœ</h3> <p>äº‹å®ä¸Šï¼Œçº¿ç¨‹å¹¶ä¸æ˜¯ä¸€ç›´å¤„äº<code>RUNNABLE</code>çŠ¶æ€ï¼Œå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹å¯èƒ½å¤„äºéRUNNABLEçŠ¶æ€çš„å› ç´ ï¼Œ é™¤äº†èµ„æºï¼ˆä¸»è¦æ˜¯å¤„ç†å™¨èµ„æºæœ‰é™è€Œå¯¼è‡´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰é™åˆ¶ä¹‹å¤–ï¼Œè¿˜æœ‰<code>ç¨‹åºè‡ªèº«çš„é”™è¯¯å’Œç¼ºé™·</code>ã€‚ ç”±èµ„æºç¨€ç¼ºæ€§æˆ–è€…ç¨‹åºè‡ªèº«çš„é—®é¢˜å’Œç¼ºé™·å¯¼è‡´çº¿ç¨‹ä¸€ç›´å¤„äº<code>éRUNNABLE</code>çŠ¶æ€ï¼Œ æˆ–çº¿ç¨‹è™½ç„¶å¤„äºRUNNABLEçŠ¶æ€ï¼Œä½†æ˜¯å…¶è¦æ‰§è¡Œçš„ä»»åŠ¡å´ä¸€ç›´æ— æ³•è¿›å±•ï¼Œè¿™ç§ç°è±¡è¢«ç§°ä¸ºçº¿ç¨‹æ´»æ€§æ•…éšœã€‚</p> <p>å¸¸è§çš„çº¿ç¨‹æ´»æ€§æ•…éšœåŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š</p> <ul><li>æ­»é”(Deadlock)</li> <li>é”æ­»(Lockout)</li> <li>æ´»é”(Livelock)</li> <li>é¥¥é¥¿(Starvation)</li></ul> <h4 id="æ­»é”-deadlock"><a href="#æ­»é”-deadlock" class="header-anchor">#</a> æ­»é”(Deadlock)</h4> <p>æ­»é”åªä¼šå‡ºç°åœ¨ä¸€ç»„çº¿ç¨‹é›†åˆä¸­ï¼Œå¦‚æœé›†åˆä¸­çš„æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æŒæœ‰å…¶ä»–çº¿ç¨‹éœ€è¦çš„èµ„æºï¼Œ å¯¼è‡´æ‰€æœ‰çº¿ç¨‹å› ç­‰å¾…èµ„æºè€Œè¢«æ°¸æš‚åœï¼Œè¿™ç§ç°è±¡å°±ç§°ä¹‹ä¸ºæ­»é”ã€‚ æ­»é”äº§ç”Ÿçš„å…¸å‹åœºæ™¯æ˜¯çº¿ç¨‹XæŒæœ‰èµ„æºAçš„æ—¶å€™ç­‰å¾…çº¿ç¨‹Yé‡Šæ”¾èµ„æºBï¼Œ åŒæ—¶çº¿ç¨‹Yåœ¨æŒæœ‰èµ„æºBçš„æ—¶å€™å´ç­‰å¾…çº¿ç¨‹Xé‡Šæ”¾èµ„æºAï¼Œè¿™å°±å¥½æ¯”é¹¬èšŒç›¸äº‰æ•…äº‹ä¸­çš„æƒ…å½¢ã€‚</p> <h4 id="é”æ­»-lockout"><a href="#é”æ­»-lockout" class="header-anchor">#</a> é”æ­»(Lockout)</h4> <p>é”æ­»ä¸æ­»é”ç±»ä¼¼ï¼Œ<strong>é”æ­»æ˜¯æŒ‡çº¿ç¨‹åœ¨ç­‰å¾…ä¸€ä¸ªæ°¸è¿œä¸ä¼šå‘ç”Ÿçš„äº‹ä»¶</strong>ï¼›ä¸æ­»é”ä¸åŒçš„æ˜¯ï¼Œ é”æ­»çš„çº¿ç¨‹å¯èƒ½ä¸æŒæœ‰ä»»ä½•èµ„æºã€‚ä¸€ä¸ªè¾ƒå…¸å‹çš„ä¾‹å­å°±æ˜¯ä¿¡å·ä¸¢å¤±å¯¼è‡´çš„é”æ­»ï¼Œ æ¯”å¦‚å¯¹ 	<code>CountDownLatch.countDown()</code> æ–¹æ³•çš„è°ƒç”¨æ²¡æœ‰æ”¾åœ¨ <code>finally</code> å—ä¸­æ—¶ï¼Œ å¯èƒ½å› ä¸ºå¼‚å¸¸æŠ›å‡ºå¯¼è‡´æ‰§è¡Œ <code>CountDownLatch.await()</code> çš„çº¿ç¨‹æ°¸è¿œå¤„äºç­‰å¾…çŠ¶æ€ã€‚</p> <h4 id="æ´»é”-livelock"><a href="#æ´»é”-livelock" class="header-anchor">#</a> æ´»é”(Livelock)</h4> <p>æŒ‡çº¿ç¨‹ä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€,ä½†æ˜¯å…¶ä»»åŠ¡å´ä¸€ç›´æ— æ³•è¿›å±•çš„ä¸€ç§æ´»æ€§æ•…éšœã€‚ æ´»é”çš„ä¸€ä¸ªé‡è¦ç‰¹å¾å°±æ˜¯çº¿ç¨‹ä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€ï¼ŒåŒºåˆ«äºæ­»é”ã€é”æ­»çš„çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ã€‚ åŒæ ·ä»¥é¹¬èšŒç›¸äº‰æ•…äº‹ä¸ºä¾‹ï¼Œä¸åŒçš„æ˜¯ä¸¤è€…å•†é‡å¥½å¦‚æœåŒæ—¶å’¬ä½å¯¹æ–¹ï¼Œåˆ™ä¸¤è€…éƒ½æ¾å¼€å£ï¼Œ ä½†æ¾å£åä¸¤è€…åˆåŒæ—¶å’¬ä½äº†å¯¹æ–¹ï¼Œäºæ˜¯ä¸¤è€…åœ¨ä¸åœçš„å’¬ä½ä¸æ¾å£ï¼Œç›´è‡³ç´¯æ­»ã€‚</p> <h4 id="é¥¥é¥¿-starvation"><a href="#é¥¥é¥¿-starvation" class="header-anchor">#</a> é¥¥é¥¿(Starvation)</h4> <p>çº¿ç¨‹ä¸€ç›´æ— æ³•è·å¾—å…¶æ‰€éœ€çš„èµ„æºè€Œå¯¼è‡´å…¶ä»»åŠ¡ç›´æ— æ³•è¿›å±•çš„ä¸€ç§æ´»æ€§æ•…éšœã€‚ æ¯”å¦‚ç”±äºå½“å‰çº¿ç¨‹çš„ä¼˜å…ˆçº§æä½ï¼Œå¯¼è‡´èµ„æºä¸€ç›´è¢«å…¶ä»–çº¿ç¨‹æŠ¢å ã€‚</p> <h3 id="èµ„æºäº‰ç”¨"><a href="#èµ„æºäº‰ç”¨" class="header-anchor">#</a> èµ„æºäº‰ç”¨</h3> <ul><li><p>çº¿ç¨‹é—´çš„èµ„æºå…±äº«</p> <p>ç”±äºèµ„æºçš„ç¨€ç¼ºæ€§ï¼ˆä¾‹å¦‚æœ‰é™çš„å¤„ç†å™¨èµ„æºï¼‰åŠèµ„æºæœ¬èº«çš„ç‰¹æ€§ ï¼ˆä¾‹å¦‚æ‰“å°æœºä¸€æ¬¡ åªèƒ½æ‰“å°ä¸€ä¸ªæ–‡ä»¶ï¼‰ï¼Œå¾€å¾€éœ€è¦åœ¨å¤šä¸ªçº¿ç¨‹é—´å…±äº«åŒä¸€ä¸ªèµ„æºã€‚</p></li> <li><p>æ’ä»–æ€§èµ„æº</p> <p>ä¸€æ¬¡åªèƒ½å¤Ÿè¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨çš„èµ„æºè¢«ç§°ä¸ºæ’ä»–æ€§èµ„æºï¼Œ å¸¸è§çš„æ’ä»–æ€§èµ„æºåŒ…æ‹¬å¤„ç†å™¨ã€æ•°æ®åº“è¿æ¥ã€æ–‡ä»¶ç­‰ã€‚</p></li> <li><p>èµ„æºäº‰ç”¨(Resource Contention)</p> <p>åœ¨ä¸€ä¸ªçº¿ç¨‹å ç”¨ä¸€ä¸ªæ’ä»–æ€§èµ„æºè¿›è¡Œè®¿é—®ï¼ˆè¯»ã€å†™æ“ä½œï¼‰ï¼Œ è€Œæœªé‡Šæ”¾å…¶å¯¹èµ„æºæ‰€æœ‰æƒçš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹è¯•å›¾è®¿é—®è¯¥èµ„æºçš„ç°è±¡å°±è¢«ç§°ä¸ºèµ„æºäº‰ç”¨ï¼Œ ç®€ç§°äº‰ç”¨ã€‚æ˜¾ç„¶ï¼Œäº‰ç”¨æ˜¯åœ¨å¹¶å‘ç¯å¢ƒä¸‹äº§ç”Ÿçš„ä¸€ç§ç°è±¡ã€‚</p></li> <li><p>äº‰ç”¨ç¨‹åº¦</p> <p>åŒæ—¶è¯•å›¾è®¿é—®åŒä¸ªå·²ç»è¢«å…¶ä»–çº¿ç¨‹å ç”¨çš„èµ„æºçš„çº¿ç¨‹æ•°é‡è¶Šå¤šï¼Œäº‰ç”¨çš„ç¨‹åº¦å°±è¶Šé«˜ï¼Œ åä¹‹äº‰ç”¨çš„ç¨‹åº¦å°±è¶Šä½ã€‚ç›¸åº”çš„äº‰ç”¨å°±è¢«åˆ†åˆ«ç§°ä¸ºé«˜äº‰ç”¨å’Œä½äº‰ç”¨ã€‚</p></li> <li><p>èµ„æºè°ƒåº¦</p> <p>åœ¨å¤šä¸ªçº¿ç¨‹ç”³è¯·åŒä¸€ä¸ªæ’ä»–æ€§èµ„æºçš„æƒ…å†µä¸‹ï¼Œå†³å®šå“ªä¸ªçº¿ç¨‹ä¼šè¢«æˆäºˆè¯¥èµ„æºçš„ç‹¬å æƒï¼Œ å³é€‰æ‹©å“ªä¸ªç”³è¯·è€…å ç”¨è¯¥èµ„æºçš„è¿‡ç¨‹å°±æ˜¯èµ„æºçš„è°ƒåº¦ã€‚ è·å¾—èµ„æºçš„ç‹¬å æƒè€Œåˆæœªé‡Šæ”¾å…¶ç‹¬å æƒçš„çº¿ç¨‹å°±è¢«ç§°ä¸ºè¯¥èµ„æºçš„æŒæœ‰çº¿ç¨‹ã€‚</p></li></ul> <h3 id="èµ„æºè°ƒåº¦ç­–ç•¥"><a href="#èµ„æºè°ƒåº¦ç­–ç•¥" class="header-anchor">#</a> èµ„æºè°ƒåº¦ç­–ç•¥</h3> <p>èµ„æºè°ƒåº¦çš„ä¸€ç§å¸¸è§ç­–ç•¥å°±æ˜¯<code>æ’é˜Ÿ</code>ã€‚<code>èµ„æºè°ƒåº¦å™¨</code>å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª<code>ç­‰å¾…é˜Ÿåˆ—</code>ï¼Œåœ¨å­˜åœ¨èµ„æºäº‰ç”¨çš„æƒ…å†µä¸‹ï¼Œ <code>ç”³è¯·å¤±è´¥çš„çº¿ç¨‹</code>ä¼šè¢«å­˜å…¥è¯¥é˜Ÿåˆ—ã€‚é€šå¸¸ï¼Œè¢«å­˜å…¥ç­‰å¾…é˜Ÿåˆ—çš„çº¿ç¨‹ä¼šè¢«æš‚åœã€‚å½“ç›¸åº”çš„èµ„æºè¢«å…¶æŒæœ‰çº¿ç¨‹é‡Šæ”¾æ—¶ï¼Œ ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ä¼šè¢«é€‰ä¸­å¹¶è¢«å”¤é†’è€Œè·å¾—å†æ¬¡ç”³è¯·èµ„æºçš„æœºä¼šã€‚ è¢«å”¤é†’çš„çº¿ç¨‹å¦‚æœç”³è¯·åˆ°èµ„æºçš„ç‹¬å æƒï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹ä¼šä»ç­‰å¾…é˜Ÿåˆ—ä¸­ç§»é™¤ï¼› å¦åˆ™ï¼Œè¯¥çº¿ç¨‹ä»ç„¶ä¼šåœç•™åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…å†æ¬¡ç”³è¯·çš„æœºä¼šï¼Œå³è¯¥çº¿ç¨‹ä¼šå†æ¬¡è¢«æš‚åœã€‚ å› æ­¤ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç­‰å¾…çº¿ç¨‹å¯èƒ½ç»å†è‹¥å¹²æ¬¡æš‚åœä¸å”¤é†’æ‰è·å¾—ç›¸åº”èµ„æºçš„ç‹¬å æƒã€‚å¯è§ï¼Œèµ„æºçš„è°ƒåº¦å¯èƒ½å¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p> <h4 id="èµ„æºè°ƒåº¦çš„å…¬å¹³æ€§"><a href="#èµ„æºè°ƒåº¦çš„å…¬å¹³æ€§" class="header-anchor">#</a> èµ„æºè°ƒåº¦çš„å…¬å¹³æ€§</h4> <p>èµ„æºè°ƒåº¦ç­–ç•¥çš„ä¸€ä¸ªå¸¸è§ç‰¹æ€§å°±æ˜¯å®ƒèƒ½å¦ä¿è¯å…¬å¹³æ€§ã€‚</p> <p>æ‰€è°“å…¬å¹³æ€§ï¼Œæ˜¯æŒ‡èµ„æºçš„ç”³è¯·è€…ï¼ˆçº¿ç¨‹ï¼‰ï¼Œæ˜¯å¦æŒ‰ç…§å…¶<code>ç”³è¯·ï¼ˆè¯·æ±‚ï¼‰èµ„æºçš„é¡ºåº</code>è€Œè¢«æˆäºˆèµ„æºçš„ç‹¬å æƒã€‚ å¦‚æœèµ„æºçš„ä»»ä½•ä¸€ä¸ªå…ˆç”³è¯·è€…ï¼Œæ€»æ˜¯èƒ½å¤Ÿæ¯”ä»»ä½•ä¸€ä¸ªåç”³è¯·è€…å…ˆè·å¾—è¯¥èµ„æºçš„ç‹¬å æƒï¼Œ é‚£ä¹ˆç›¸åº”çš„èµ„æºè°ƒåº¦ç­–ç•¥å°±è¢«ç§°ä¸ºæ˜¯å…¬å¹³çš„ï¼› å¦‚æœèµ„æºçš„åç”³è¯·è€…å¯èƒ½æ¯”å…ˆç”³è¯·è€…å…ˆè·å¾—è¯¥èµ„æºçš„ç‹¬å æƒï¼Œé‚£ä¹ˆç›¸åº”çš„èµ„æºè°ƒåº¦ç­–ç•¥å°±è¢«ç§°ä¸ºæ˜¯éå…¬å¹³çš„ã€‚</p> <p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéå…¬å¹³çš„èµ„æºè°ƒåº¦ç­–ç•¥å¾€å¾€åªæ˜¯è¯´æ˜å®ƒå¹¶ä¸ä¿è¯èµ„æºè°ƒåº¦çš„å…¬å¹³æ€§ï¼Œ <strong>å³å®ƒå…è®¸ä¸å…¬å¹³çš„èµ„æºè°ƒåº¦çš„å‡ºç°</strong>ï¼Œè€Œä¸æ˜¯è¡¨ç¤ºå®ƒåˆ»æ„é€ å°±ä¸å…¬å¹³çš„èµ„æºè°ƒåº¦ã€‚</p> <h4 id="å…¬å¹³çš„è°ƒåº¦ç­–ç•¥"><a href="#å…¬å¹³çš„è°ƒåº¦ç­–ç•¥" class="header-anchor">#</a> å…¬å¹³çš„è°ƒåº¦ç­–ç•¥</h4> <p>å…¬å¹³çš„è°ƒåº¦ç­–ç•¥ä¸å…è®¸æ’é˜Ÿç°è±¡çš„å‡ºç°ï¼Œå³åªæœ‰åœ¨èµ„æºæœªè¢«å…¶ä»–ä»»ä½•çº¿ç¨‹å ç”¨ï¼Œ å¹¶ä¸”æ²¡æœ‰å…¶ä»–æ´»è·ƒçº¿ç¨‹ç”³è¯·è¯¥èµ„æºæƒ…å†µä¸‹ï¼Œé˜Ÿåˆ—ä¸­çš„çº¿ç¨‹æ‰è¢«å…è®¸è¢«å”¤é†’ï¼ŒæŠ¢å ç›¸åº”èµ„æºçš„ç‹¬å æƒã€‚ å…¶ä¸­ï¼ŒæŠ¢å æˆåŠŸçš„ç”³è¯·è€…è·å¾—ç›¸åº”èµ„æºçš„ç‹¬å æƒï¼Œè€ŒæŠ¢å å¤±è´¥çš„ç”³è¯·è€…ä¼šè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚ å› æ­¤ï¼Œå…¬å¹³è°ƒåº¦ç­–ç•¥ä¸­çš„èµ„æºç”³è¯·è€…æ€»æ˜¯æŒ‰ç…§<code>å…ˆæ¥ååˆ°</code>çš„é¡ºåºæ¥è·å¾—èµ„æºçš„ç‹¬å æƒã€‚</p> <h4 id="éå…¬å¹³çš„è°ƒåº¦ç­–ç•¥"><a href="#éå…¬å¹³çš„è°ƒåº¦ç­–ç•¥" class="header-anchor">#</a> éå…¬å¹³çš„è°ƒåº¦ç­–ç•¥</h4> <p>è€Œéå…¬å¹³çš„è°ƒåº¦ç­–ç•¥åˆ™<code>å…è®¸æ’é˜Ÿç°è±¡</code>ï¼Œå³ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾å…¶èµ„æºç‹¬å æƒçš„æ—¶å€™ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ä¼šè¢«å”¤é†’ç”³è¯·ç›¸åº”çš„èµ„æºã€‚è€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å­˜åœ¨å¦ä¸€ä¸ªæ´»è·ƒçº¿ç¨‹ä¸è¿™ä¸ªè¢«å”¤é†’çš„çº¿ç¨‹å…±åŒå‚ä¸ç›¸åº”èµ„æºçš„æŠ¢å ã€‚ å› æ­¤ï¼Œéå…¬å¹³è°ƒåº¦ç­–ç•¥ä¸­è¢«å”¤é†’çš„çº¿ç¨‹ä¸ä¸€å®šå°±èƒ½å¤ŸæˆåŠŸç”³è¯·åˆ°èµ„æºã€‚å› æ­¤ï¼Œåœ¨æç«¯çš„æƒ…å†µä¸‹ï¼Œ éå…¬å¹³è°ƒåº¦ç­–ç•¥å¯èƒ½å¯¼è‡´ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹æ°¸è¿œæ— æ³•è·å¾—å…¶æ‰€éœ€çš„èµ„æºï¼Œå³å‡ºç°<code>é¥¥é¥¿ç°è±¡</code>ã€‚</p> <h4 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="header-anchor">#</a> å¯¹æ¯”</h4> <ul><li>ä»ç”³è¯·è€…ä¸ªä½“çš„è§’åº¦æ¥çœ‹ï¼šä½¿ç”¨å…¬å¹³è°ƒåº¦ç­–ç•¥æ—¶ï¼Œç”³è¯·è€…è·å¾—ç›¸åº”èµ„æºçš„ç‹¬å æƒæ‰€éœ€æ—¶é—´çš„åå·®å¯èƒ½æ¯”è¾ƒå°ï¼Œ å³æ¯ä¸ªç”³è¯·è€…æˆåŠŸç”³è¯·åˆ°èµ„æºæ‰€éœ€çš„æ—¶é—´åŸºæœ¬ç›¸åŒï¼›è€Œä½¿ç”¨éå…¬å¹³çš„è°ƒåº¦ç­–ç•¥æ—¶ï¼Œç”³è¯·è€…è·å¾—ç›¸åº”èµ„æºçš„ç‹¬å æƒæ‰€éœ€æ—¶é—´çš„åå·®å¯èƒ½æ¯”è¾ƒå¤§ï¼Œæœ‰çš„çº¿ç¨‹å¾ˆå¿«å°±ç”³è¯·åˆ°èµ„æºï¼Œ è€Œæœ‰çš„çº¿ç¨‹åˆ™è¦ç»å†è‹¥å¹²æ¬¡æš‚åœä¸å”¤é†’æ‰æˆåŠŸç”³è¯·åˆ°èµ„æºã€‚</li> <li>ä»æ•ˆç‡ä¸Šçœ‹ï¼šåœ¨éå…¬å¹³è°ƒåº¦ç­–ç•¥ä¸­ï¼Œèµ„æºçš„æŒæœ‰çº¿ç¨‹é‡Šæ”¾è¯¥èµ„æºçš„æ—¶å€™ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ä¼šè¢«å”¤é†’ï¼Œ è€Œè¯¥çº¿ç¨‹ä»è¢«å”¤é†’åˆ°å…¶ç»§ç»­è¿è¡Œå¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ã€‚<strong>åœ¨è¯¥æ—¶é—´å†…ï¼Œå¦‚æœä½¿ç”¨éå…¬å¹³çš„è°ƒåº¦ç­–ç•¥ï¼Œ æ–°æ¥çš„çº¿ç¨‹ï¼ˆæ´»è·ƒçº¿ç¨‹ï¼‰å¯ä»¥å…ˆè¢«æˆäºˆè¯¥èµ„æºçš„ç‹¬å æƒ</strong>ï¼Œå¦‚æœè¿™ä¸ªæ–°æ¥çš„çº¿ç¨‹å ç”¨è¯¥èµ„æºçš„æ—¶é—´ä¸é•¿ï¼Œé‚£ä¹ˆå®ƒå®Œå…¨æœ‰å¯èƒ½åœ¨è¢«å”¤é†’çš„çº¿ç¨‹ç»§ç»­å…¶è¿è¡Œå‰é‡Šæ”¾ç›¸åº”çš„èµ„æºï¼Œä»è€Œä¸å½±å“è¯¥è¢«å”¤é†’çš„çº¿ç¨‹ç”³è¯·èµ„æºã€‚ è¿™ç§æƒ…å½¢ä¸‹ï¼Œéå…¬å¹³è°ƒåº¦ç­–ç•¥å¯ä»¥å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ¬¡æ•°ã€‚ ä½†æ˜¯ï¼Œå¦‚æœå¤šæ•°ï¼ˆç”šè‡³æ¯ä¸ªï¼‰çº¿ç¨‹å ç”¨èµ„æºçš„æ—¶é—´ç›¸å½“é•¿ï¼Œé‚£ä¹ˆå…è®¸æ–°æ¥çš„çº¿ç¨‹æŠ¢å èµ„æºä¸ä¼šå¸¦æ¥ä»»ä½•å¥½å¤„ï¼Œ åè€Œä¼šå¯¼è‡´è¢«å”¤é†’çš„çº¿ç¨‹éœ€è¦å†æ¬¡ç»å†æš‚åœå’Œå”¤é†’ï¼Œä»è€Œå¢åŠ äº†ä¸Šä¸‹æ–‡åˆ‡æ›ã€‚ å› æ­¤ï¼Œå¤šæ•°çº¿ç¨‹å ç”¨èµ„æºçš„æ—¶é—´ç›¸å½“é•¿çš„æƒ…å†µä¸‹ä¸é€‚åˆä½¿ç”¨éå…¬å¹³è°ƒåº¦ç­–ç•¥ã€‚</li></ul> <p>ç»¼ä¸Šï¼Œåœ¨æ²¡æœ‰ç‰¹åˆ«éœ€è¦çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é»˜è®¤é€‰æ‹©éå…¬å¹³è°ƒåº¦ç­–ç•¥å³å¯ã€‚ åœ¨èµ„æºçš„æŒæœ‰çº¿ç¨‹å ç”¨èµ„æºçš„æ—¶é—´ç›¸å¯¹é•¿ï¼Œæˆ–çº¿ç¨‹ç”³è¯·èµ„æºçš„å¹³å‡é—´éš”æ—¶é—´ç›¸å¯¹é•¿ï¼Œ æˆ–å¯¹èµ„æºç”³è¯·æ‰€éœ€çš„æ—¶é—´åå·®æœ‰æ‰€è¦æ±‚ï¼ˆå³æ—¶é—´åå·®è¾ƒå°ï¼‰çš„æƒ…å†µä¸‹å¯ä»¥è€ƒè™‘ä½¿ç”¨å…¬å¹³è°ƒåº¦ç­–ç•¥ã€‚</p></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://github.com/LifeAlsoIsGG/edit/main/java/java-MultiThread/Java-MultiThread-1.md" target="_blank" rel="noopener noreferrer">Edit this page</a></div> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">April 18, 2022 00:39</span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/java/java-MultiThread/" class="prev router-link-active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        æ¦‚è¿°/å‚è€ƒ
      </a></span> <span class="next"><a href="/java/java-MultiThread/Java-MultiThread-2/">
        Javaå¤šçº¿ç¨‹-2
        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon next-icon"><path d="M906.772 512c0 4.772-2.211 9.267-5.99 12.175L524.257 813.66a15.37 15.37 0 0 1-18.616.092 15.368 15.368 0 0 1-5.038-17.91l75.714-191.672h-443.73c-8.488 0-15.36-6.881-15.36-15.36v-153.6c0-8.489 6.872-15.36 15.36-15.36h443.73l-75.714-191.682a15.358 15.358 0 0 1 5.048-17.91c5.51-4.158 13.128-4.137 18.606.092l376.525 289.485a15.323 15.323 0 0 1 5.99 12.165z" fill="currentColor"></path></svg></a></span></p></div> <div class="comments-wrapper"><div class="waline-wrapper"><div id="waline-comment"></div></div></div> <!----> <div class="content__page-bottom"></div></main> <footer class="footer-wrapper"><div class="media-links-wrapper"><a href="https://github.com/LifeAlsoIsGG" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a><a href="https://twitter.com/LifeAlsoIsGG" rel="noopener noreferrer" target="_blank" aria-label="Twitter" data-balloon-pos="up" class="media-link"><span class="sr-only">Twitter</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-twitter"><circle cx="512" cy="512" r="512" fill="#5EAADE"></circle> <path d="M749.737 364.631c-17.594 7.805-36.513 13.088-56.371 15.459 20.269-12.148 35.836-31.387 43.156-54.312A196.233 196.233 0 0 1 674.2 349.6c-17.894-19.083-43.406-30.997-71.636-30.997-54.2 0-98.137 43.944-98.137 98.157 0 7.695.861 15.19 2.544 22.373-81.57-4.092-153.876-43.174-202.284-102.558-8.443 14.498-13.285 31.356-13.285 49.348 0 34.05 17.326 64.096 43.656 81.697a97.69 97.69 0 0 1-44.447-12.277c-.01.41-.01.82-.01 1.24 0 47.558 33.822 87.23 78.72 96.249a98.285 98.285 0 0 1-25.852 3.448 97.491 97.491 0 0 1-18.465-1.768c12.483 39.002 48.725 67.38 91.672 68.17-33.582 26.334-75.897 42.024-121.884 42.024-7.924 0-15.736-.46-23.408-1.37 43.434 27.844 95.014 44.104 150.443 44.104 180.505 0 279.221-149.576 279.221-279.294 0-4.263-.09-8.494-.278-12.708 19.178-13.835 35.813-31.115 48.967-50.807z" fill="#FFF"></path></svg></a><a href="http://localhost:8083/blog-vuepress/tencent:/AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1138312802.html" rel="noopener noreferrer" target="_blank" aria-label="QQ" data-balloon-pos="up" class="media-link"><span class="sr-only">QQ</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-qq"><circle cx="512" cy="512" r="512" fill="#5EAADE"></circle> <path d="M729.46 627.3c-3.157-39.628-24.045-83.747-32.624-105.91l-22.084-57.047c-.702-23.73 6.312-78.322-30.511-146.61s-110.82-74.446-124.497-75.147c-13.677-.701-99.248-1.403-141.331 72.945-42.084 74.347-30.745 148.812-30.745 148.812l-23.523 57.478c-.001.002-10.962 26.223-20.43 58.135-9.469 31.914-18.938 82.064-9.469 92.234 9.47 10.17 43.837-46.643 46.993-51.903 0 0 2.456 27.18 8.943 41.383l.81 1.776.33.723.38.826.3.652.444.96.203.436a281.465 281.465 0 0 0 1.917 4.025l.189.386c.231.473.468.953.711 1.442l.146.292c6.886 13.807 18.61 33.823 37.443 50.42l.018.016-1.184.387c-10.667 3.516-31.694 11.21-40.625 19.82-1.717 1.655-2.987 3.344-3.65 5.045-5.376 13.794 4.208 15.43 20.575 16.366 16.366.934 94.923 3.04 132.564-2.221.407-.056.787-.114 1.17-.171 2.711.094 5.324.142 7.83.16l.151.002c.836.005 1.663.008 2.475.008.496 0 1.015-.002 1.542-.006l.21-.001a222.593 222.593 0 0 0 5.462-.107c.26.038.508.076.778.114 37.642 5.26 116.198 3.156 132.564 2.22 16.366-.934 25.951-2.571 20.574-16.365-4.302-11.037-34.175-21.62-45.956-25.413a141.388 141.388 0 0 0 7.958-7.645l.237-.245a142.494 142.494 0 0 0 2.53-2.702c42.435-46.643 38.928-76.101 40.682-92.935 0 0 35.775 51.553 43.488 53.306 7.713 1.754 10.169-6.31 7.012-45.94z" fill="#FFF"></path></svg></a></div> <div class="footer">ç²¤ICPå¤‡19126168å·</div> <div class="copyright">Copyright Â© 2022 Draco</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button class="pswp__button pswp__button--close"></button> <button class="pswp__button pswp__button--share"></button> <button class="pswp__button pswp__button--fs"></button> <button class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button class="pswp__button pswp__button--arrow--left"></button> <button class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/assets/js/app.b2189200.js" defer></script><script src="/assets/js/vendors~layout-Layout.3a19796f.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.17f5562a.js" defer></script><script src="/assets/js/page-Javaå¤šçº¿ç¨‹-1.cbdb3d2e.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.30f611ca.js" defer></script>
  </body>
</html>
